(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    418123,      10529]
NotebookOptionsPosition[    379382,      10076]
NotebookOutlinePosition[    379750,      10092]
CellTagsIndexPosition[    379707,      10089]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<GroupTheory`\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.785268326473967*^9, 3.785268338931836*^9}, 
   3.785269081490608*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"b6889cbf-092d-4631-b0b0-83a81301ce86"],

Cell[CellGroupData[{

Cell[TextData[{
 "Crystal field expansion for cubic group ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["O", 
    RowBox[{"h", "\[NonBreakingSpace]"}]], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "fbe749cb-2602-44ac-81da-cef2c1beca5b"]
}], "Section",
 CellChangeTimes->{{3.7866271144117737`*^9, 
  3.786627142962842*^9}},ExpressionUUID->"a9bf1534-f8b6-4fd8-961f-\
1ae775dca244"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Ohgroup", "=", 
   RowBox[{"GTInstallGroup", "[", 
    RowBox[{"Oh", ",", 
     RowBox[{"GOVerbose", "\[Rule]", "\"\<False\>\""}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.785269160622649*^9, {3.785269281480538*^9, 3.785269336414172*^9}, 
   3.786627168376821*^9},
 CellLabel->"In[2]:=",ExpressionUUID->"2470a8b0-ea07-49ea-8b21-5dd21cc2a654"],

Cell[BoxData[
 RowBox[{"vcr", "=", 
  RowBox[{"GTCrystalField", "[", 
   RowBox[{"Ohgroup", ",", "6"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.785269341649662*^9, 3.7852693624398003`*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"396db1b6-ec94-486b-a29f-b3144caca921"],

Cell[CellGroupData[{

Cell["Test some things and get familiar with the GT operators", "Subsection",
 CellChangeTimes->{{3.7866500970420427`*^9, 
  3.786650126803135*^9}},ExpressionUUID->"78f1aeb3-4212-42f4-9f21-\
c29dbe185c99"],

Cell[TextData[{
 "Test that the BST operators (Buckmaster-Smith-Thornley) correspond to the \
",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    RowBox[{"(", 
     SuperscriptBox["C", 
      RowBox[{"(", "l", ")"}]], ")"}], "m"], TraditionalForm]],ExpressionUUID->
  "54173f3f-fad3-41d5-ab88-c7fe53a5439b"],
 " operators of the more recent review of Kuzmin and Tishin (2008). \
\[LineSeparator]We compare matrix elements of the BST operators to Equations \
() in the review. "
}], "Text",
 CellChangeTimes->{{3.786627172007189*^9, 3.7866272705571413`*^9}, {
  3.7885393290198107`*^9, 
  3.7885393566524763`*^9}},ExpressionUUID->"eca34ae6-895b-4e8e-ae54-\
e257409d1a43"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"jVal", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mVal", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mValp", "=", "3"}], ";"}]}], "Input",
 CellChangeTimes->{{3.786618120685358*^9, 3.786618191197185*^9}, {
   3.786618282438496*^9, 3.786618361535932*^9}, 3.786627170997086*^9, {
   3.7866274218339643`*^9, 3.786627421999659*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"2f78e5f5-c5a5-4096-b88d-9f5604609452"],

Cell[BoxData[
 RowBox[{"GTBSTOperatorElement", "[", 
  RowBox[{"2", ",", "1", ",", "jVal", ",", "mValp", ",", "mVal"}], 
  "]"}]], "Input",
 CellChangeTimes->{
  3.786617614458799*^9, {3.7866177549344*^9, 3.786617764425037*^9}, {
   3.786618001729369*^9, 3.786618074809917*^9}, {3.786618131007825*^9, 
   3.7866181370058737`*^9}, {3.7866181674920883`*^9, 3.786618192993208*^9}, {
   3.786618235637969*^9, 3.786618239563653*^9}, {3.786618296557832*^9, 
   3.786618296619371*^9}, {3.7866183562920094`*^9, 3.786618357685767*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"12083657-6ffa-4efc-a749-b212db2ef916"],

Cell[BoxData[
 RowBox[{
  RowBox[{"1", "/", "2"}], "*", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"3", "*", 
     RowBox[{"mVal", "^", "2"}]}], "-", 
    RowBox[{"jVal", "*", 
     RowBox[{"(", 
      RowBox[{"jVal", "+", "1"}], ")"}]}]}], ")"}], "*", 
  RowBox[{"KroneckerDelta", "[", 
   RowBox[{"mVal", ",", "mValp"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.786618080303924*^9, 3.7866181162352953`*^9}, {
  3.786618207609448*^9, 3.7866182219444113`*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"18a60e99-f3ee-40fb-b8e3-34047c0c6a99"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"(", 
    RowBox[{"mVal", "+", "mValp"}], ")"}]}], "*", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"3", "/", "8"}], "*", 
     RowBox[{"(", 
      RowBox[{"jVal", "+", "mValp"}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{"jVal", "-", "mVal"}], ")"}]}], ")"}], "^", 
   RowBox[{"(", 
    RowBox[{"1", "/", "2"}], ")"}]}], "*", 
  RowBox[{"KroneckerDelta", "[", 
   RowBox[{"mValp", ",", 
    RowBox[{"mVal", "+", "1"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7866181723397512`*^9, 3.786618182180396*^9}, {
  3.786618242226227*^9, 3.786618278850041*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"383d0bba-95b6-4743-8145-f4376bc054b4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"GTBSTOperator", "[", 
   RowBox[{"0", ",", "0", ",", "4"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "MatrixForm"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GTBSTOperator", "[", 
   RowBox[{"4", ",", 
    RowBox[{"-", "4"}], ",", "4"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.786627374307395*^9, 3.786627395946248*^9}, {
  3.7866274355905867`*^9, 3.78662746836504*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"faa33a26-6d45-4bca-9019-bbba1ac77858"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"GTBSTOperator", "[", 
   RowBox[{"2", ",", "2", ",", "2"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.7885393205478897`*^9, 3.788539322555574*^9}, {
  3.788539474640334*^9, 3.788539477656055*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"abf59614-5503-48b4-9a3a-00726c900e47"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Crystal field expansion in terms of BST or Stevens operators, starting from \
the expression in terms of the Y[l,m]\
\>", "Subsection",
 CellChangeTimes->{{3.7901043634663353`*^9, 
  3.790104395340146*^9}},ExpressionUUID->"e39a8fd0-b244-4e32-b758-\
b7c5bd66e8b9"],

Cell["\<\
Let\[CloseCurlyQuote]s go from BST to Stevens operators using equations on \
page 25 of Danielsen and Lindgard paper. 
Choose J=4, m=2 for concreteness. \
\>", "Text",
 CellChangeTimes->{{3.789926188699148*^9, 3.789926241666974*^9}},
 Background->GrayLevel[
  0.85],ExpressionUUID->"1db26ad8-394b-445e-b180-af76e4a63258"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"JVal", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lVal", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mVal", "=", "2"}], ";"}]}], "Input",
 CellChangeTimes->{{3.790078810972621*^9, 3.7900788193879747`*^9}, {
  3.790078984029347*^9, 3.790078984332408*^9}, {3.790079404966804*^9, 
  3.790079405053184*^9}, {3.7968048816115217`*^9, 3.796804882234777*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"4851e210-e511-40e2-85bf-6c93821ac2b4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"KCoeff", "[", 
    RowBox[{"2", ",", "2"}], "]"}], "=", 
   RowBox[{
    RowBox[{"1", "/", "4"}], "*", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"15", "/", "Pi"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KCoeff", "[", 
    RowBox[{"2", ",", "0"}], "]"}], "=", 
   RowBox[{
    RowBox[{"1", "/", "4"}], "*", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"5", "/", "Pi"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KCoeff", "[", 
    RowBox[{"4", ",", "4"}], "]"}], "=", 
   RowBox[{
    RowBox[{"3", "/", "16"}], "*", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"35", "/", "Pi"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KCoeff", "[", 
    RowBox[{"4", ",", "0"}], "]"}], "=", 
   RowBox[{
    RowBox[{"1", "/", "16"}], "*", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"9", "/", "Pi"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KCoeff", "[", 
    RowBox[{"6", ",", "4"}], "]"}], "=", 
   RowBox[{
    RowBox[{"3", "/", "32"}], "*", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"91", "/", "Pi"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KCoeff", "[", 
    RowBox[{"6", ",", "0"}], "]"}], "=", 
   RowBox[{
    RowBox[{"1", "/", "32"}], "*", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"13", "/", "Pi"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.790078693400251*^9, 3.79007871265171*^9}, {
   3.790078823411934*^9, 3.790078869189183*^9}, {3.7900789755327673`*^9, 
   3.790078993228772*^9}, {3.7901035930834208`*^9, 3.790103615874633*^9}, {
   3.7901036945311403`*^9, 3.790103733147262*^9}, 3.796837773291008*^9},
 CellLabel->"In[19]:=",ExpressionUUID->"c721a359-c6e6-4c3d-95fc-086410efe36d"],

Cell["\<\
The DL transformation (5.1) on page 25 (with K[l,m] = normalizing \
coefficients in the tesseral harmonic from page DL 52) relates \
GTBSTOperator[l,m,J] to GTStevensOperator[l,m,J]:\
\>", "Text",
 CellChangeTimes->{{3.796468879212973*^9, 3.796468946838995*^9}, {
  3.7964689881296062`*^9, 
  3.796469020162962*^9}},ExpressionUUID->"85ec11e7-a484-4688-81fe-\
0810ec4d12e3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"temp1", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"mVal", "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{"1", "/", 
       RowBox[{"KCoeff", "[", 
        RowBox[{"lVal", ",", "mVal"}], "]"}]}], "*", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "*", "lVal"}], "+", "1"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"4", "*", "Pi"}], ")"}]}], "]"}], "*", 
      RowBox[{"GTBSTOperator", "[", 
       RowBox[{"lVal", ",", "0", ",", "JVal"}], "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"1", "/", 
       RowBox[{"KCoeff", "[", 
        RowBox[{"lVal", ",", "mVal"}], "]"}]}], "*", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "*", "lVal"}], "+", "1"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"4", "*", "Pi"}], ")"}]}], "/", "2"}], "]"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"GTBSTOperator", "[", 
         RowBox[{"lVal", ",", 
          RowBox[{"-", "mVal"}], ",", "JVal"}], "]"}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], "^", "mVal"}], "*", 
         RowBox[{"GTBSTOperator", "[", 
          RowBox[{"lVal", ",", "mVal", ",", "JVal"}], "]"}]}]}], ")"}]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "MatrixForm"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.790078676635631*^9, 3.790078806916066*^9}, {
  3.790078874805773*^9, 3.790078879396216*^9}, {3.790078923349698*^9, 
  3.790078944996416*^9}, {3.790079008317325*^9, 3.790079066468602*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"df6a1337-8777-4083-af04-a43c1c3f9621"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GTStevensOperator", "[", 
   RowBox[{"lVal", ",", "mVal", ",", "JVal"}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.790078883190517*^9, 3.7900789037882032`*^9}, {
  3.7900790689257307`*^9, 3.790079103644629*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"fd74fb8c-a046-4640-8808-c34dbf028d2f"],

Cell["\<\
Stevens operators defined via BST operators in Eq.5.1 on page 25 in Danielsen \
and Lindgard and  GTStevensOperator[l,m,J] are identical. \
\>", "Text",
 CellChangeTimes->{{3.790079146562079*^9, 3.790079318221053*^9}, {
  3.796469039161775*^9, 
  3.7964690467825327`*^9}},ExpressionUUID->"45e7827b-9760-4f7f-8a0d-\
e47b74838b75"],

Cell[BoxData[{
 RowBox[{"temp1", "-", 
  RowBox[{"GTStevensOperator", "[", 
   RowBox[{"lVal", ",", "mVal", ",", "JVal"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", 
  RowBox[{
   RowBox[{"Total", "[", 
    RowBox[{
     RowBox[{"Abs", "[", "#", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "&"}]}]}], "Input",
 CellChangeTimes->{{3.790079074401162*^9, 3.790079141108595*^9}, {
  3.7900792389505253`*^9, 3.790079252140975*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"55c58caf-8e15-4b78-9d5b-e957ada6a72b"],

Cell["\<\
What about the difference operators O[l,m](s) in Danielsen and Lindgard. It \
contains I and is antisymmetric. \[LineSeparator]I am not sure I need these \
for the expansion of the crystal field Hamiltonian. Let\[CloseCurlyQuote]s \
assume for now that this is done only in terms of the c combination above (as \
it agrees with GTStevensOperator that may be correct). \
\>", "Text",
 CellChangeTimes->{{3.7900790557935534`*^9, 3.79007907356444*^9}, {
  3.790079322308949*^9, 3.790079343781026*^9}, {3.79010239583383*^9, 
  3.790102407544022*^9}, {3.790102646376623*^9, 3.7901027152807693`*^9}, {
  3.7964690560275393`*^9, 
  3.796469070218313*^9}},ExpressionUUID->"cfd8cee3-1c14-4ca9-840f-\
6067ddb0b019"],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"1", "/", 
      RowBox[{"KCoeff", "[", 
       RowBox[{"lVal", ",", "mVal"}], "]"}]}], "*", "I", "*", 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "*", "lVal"}], "+", "1"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"4", "*", "Pi"}], ")"}]}], "/", "2"}], "]"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"GTBSTOperator", "[", 
        RowBox[{"lVal", ",", 
         RowBox[{"-", "mVal"}], ",", "JVal"}], "]"}], "-", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], "^", "mVal"}], "*", 
        RowBox[{"GTBSTOperator", "[", 
         RowBox[{"lVal", ",", "mVal", ",", "JVal"}], "]"}]}]}], ")"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"%", "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.790079350381518*^9, 3.790079364717042*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"837c2359-fd69-4b0e-a80b-a5fc29e1799d"],

Cell["\<\
Compare to Stevens operators defined in Lea, Leask and Wolf paper, focusing \
on J=4 for concreteness. 
From the comparison of the spectrum, we know that O[l,m] in their paper are \
identical to GTStevensOperator[l,m,J=4]. \
\[LineSeparator]Let\[CloseCurlyQuote]s see whether we obtain the same \
expansion of the crystal field Hamiltonian with factors F[4] = 60 and F[6] = \
1260 as well as the relative factors in O[4]=O[4,0] + 5.0*O[4,4] and O[6] = \
O[6,0] - 21.0*O[6,4].\
\>", "Text",
 CellChangeTimes->{{3.790102719153681*^9, 3.79010274829648*^9}, {
   3.790102888376937*^9, 3.7901030048974543`*^9}, {3.790104436652525*^9, 
   3.7901044442204657`*^9}, {3.796461677147457*^9, 3.796461677693122*^9}, {
   3.796461844067828*^9, 3.796461849303443*^9}, 
   3.796469314245987*^9},ExpressionUUID->"590f09c2-238d-4b7e-875b-\
5eb04d45ed0f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"JVal", "=", "4"}], ";"}]], "Input",
 CellChangeTimes->{{3.790103106374609*^9, 3.790103108585248*^9}, 
   3.790104431917801*^9},
 CellLabel->"",ExpressionUUID->"c61dff08-a760-41c2-b529-f7002dec7a3c"],

Cell[TextData[{
 "Expand the crystal field for ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["O", "h"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "f632f90c-8f99-4126-89f2-3ddfbfb0ad39"],
 " in ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["Y", "lm"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "e4ff6f41-49b6-4857-b159-f5776c8a9d9c"],
 ". Then replace ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["Y", "lm"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "9bb7fca0-d5ba-46e7-b860-3e2884417c2f"],
 "by Wybourne operators ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["C", "lm"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "ebe35707-20b9-45f5-bc2f-341ef5f728f2"],
 " using that ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["Y", "lm"], "\[Rule]", 
    RowBox[{
     SqrtBox[
      FractionBox[
       RowBox[{
        RowBox[{"2", "l"}], "+", "1"}], 
       RowBox[{"4", "\[Pi]"}]]], 
     SubscriptBox["C", "lm"]}]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "ff7025b6-07d9-4071-933e-a7656b95ad9d"],
 ". Then replace the ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["C", "lm"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "37d12fda-634e-44b7-a76f-c4b89d153c7e"],
 " by the combination of Stevens\[CloseCurlyQuote] operators given in \
Danielsen and Lindgard (DL), which includes the ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["K", "lm"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "5f8b488e-3574-435f-abc3-a84492c288f5"],
 " coefficients given on p.56 in DL. The resulting Hamiltonian is identical \
to Lea et al. To show this, one can factor out the greatest common divisor of \
all the matrix elements as shown below. "
}], "Text",
 CellChangeTimes->{{3.796461917965706*^9, 
  3.7964623403476562`*^9}},ExpressionUUID->"3073a13e-b68b-49ea-8733-\
dc7cb6706652"],

Cell[BoxData[{
 RowBox[{"vcr", "=", 
  RowBox[{
   RowBox[{"GTCrystalField", "[", 
    RowBox[{"Ohgroup", ",", "6"}], "]"}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{"vcr", "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Y", "[", 
       RowBox[{"ll_", ",", "mm_"}], "]"}], "\[Rule]", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "*", "ll"}], "+", "1"}], ")"}], "/", "4"}], "/", 
         "Pi"}], "]"}], "*", 
       RowBox[{"YY", "[", 
        RowBox[{"ll", ",", "mm"}], "]"}]}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{"temp", "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"YY", "[", 
       RowBox[{"ll_", ",", "mm_"}], "]"}], "\[Rule]", 
      RowBox[{"Y", "[", 
       RowBox[{"ll", ",", "mm"}], "]"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"vcrSt", "=", 
  RowBox[{
   RowBox[{"temp", "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"r", "\[Rule]", "1"}], ",", 
      RowBox[{
       RowBox[{"Y", "[", 
        RowBox[{"4", ",", 
         RowBox[{"-", "4"}]}], "]"}], "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"KCoeff", "[", 
          RowBox[{"4", ",", "4"}], "]"}], "*", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"8", "*", 
           RowBox[{"Pi", "/", "9"}]}], "]"}], "*", 
         RowBox[{"OSt", "[", 
          RowBox[{"4", ",", "4"}], "]"}]}], "-", 
        RowBox[{"Y", "[", 
         RowBox[{"4", ",", "4"}], "]"}]}]}], ",", 
      RowBox[{
       RowBox[{"Y", "[", 
        RowBox[{"4", ",", "0"}], "]"}], "\[Rule]", 
       RowBox[{
        RowBox[{"KCoeff", "[", 
         RowBox[{"4", ",", "0"}], "]"}], "*", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"4", "*", 
          RowBox[{"Pi", "/", "9"}]}], "]"}], "*", 
        RowBox[{"OSt", "[", 
         RowBox[{"4", ",", "0"}], "]"}]}]}], ",", 
      RowBox[{
       RowBox[{"Y", "[", 
        RowBox[{"6", ",", 
         RowBox[{"-", "4"}]}], "]"}], "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"KCoeff", "[", 
          RowBox[{"6", ",", "4"}], "]"}], "*", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"8", "*", 
           RowBox[{"Pi", "/", "13"}]}], "]"}], "*", 
         RowBox[{"OSt", "[", 
          RowBox[{"6", ",", "4"}], "]"}]}], "-", 
        RowBox[{"Y", "[", 
         RowBox[{"6", ",", "4"}], "]"}]}]}], ",", 
      RowBox[{
       RowBox[{"Y", "[", 
        RowBox[{"6", ",", "0"}], "]"}], "\[Rule]", 
       RowBox[{
        RowBox[{"KCoeff", "[", 
         RowBox[{"6", ",", "0"}], "]"}], "*", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"4", "*", 
          RowBox[{"Pi", "/", "13"}]}], "]"}], "*", 
        RowBox[{"OSt", "[", 
         RowBox[{"6", ",", "0"}], "]"}]}]}]}], "}"}]}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.790103006136746*^9, 3.7901030398095503`*^9}, {
  3.790103093065908*^9, 3.7901031727777987`*^9}, {3.790103240215016*^9, 
  3.790103245235113*^9}, {3.79010329720328*^9, 3.790103299290131*^9}, {
  3.790103336371759*^9, 3.7901035878671227`*^9}, {3.790110687219729*^9, 
  3.79011080028188*^9}, {3.7968048709901237`*^9, 3.7968048726470222`*^9}},
 CellLabel->
  "In[747]:=",ExpressionUUID->"a40fcd0c-cadc-476c-bb48-84905773cac6"],

Cell[BoxData[
 RowBox[{"42", "*", 
  RowBox[{"Sqrt", "[", "70", "]"}], "*", 
  RowBox[{
   RowBox[{
    RowBox[{"60", "/", "5"}], "/", 
    RowBox[{"Sqrt", "[", "182", "]"}]}], "/", "1260"}]}]], "Input",
 CellChangeTimes->{{3.7968360774504633`*^9, 3.796836143180084*^9}, 
   3.796836328000437*^9},
 CellLabel->"In[37]:=",ExpressionUUID->"a8110a6b-b666-429f-b2b5-f31f73e9ce9b"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"GTStevensTheta", "[", 
    RowBox[{"\"\<Pr\>\"", ",", "4"}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"GTStevensTheta", "[", 
    RowBox[{"\"\<Pr\>\"", ",", "6"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.79683639344508*^9, 3.796836442144084*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"a100a6a7-a295-427f-a971-7069b3cf8260"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"GTStevensTheta", "[", 
      RowBox[{"\"\<Pr\>\"", ",", "4"}], "]"}], "*", 
     RowBox[{"Sqrt", "[", 
      RowBox[{"4", "*", 
       RowBox[{"Pi", "/", "9"}]}], "]"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"KCoeff", "[", 
         RowBox[{"4", ",", "0"}], "]"}], "*", 
        RowBox[{"A", "[", 
         RowBox[{"4", ",", "4"}], "]"}], "*", 
        RowBox[{"GTStevensOperator", "[", 
         RowBox[{"4", ",", "0", ",", "JVal"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"KCoeff", "[", 
         RowBox[{"4", ",", "4"}], "]"}], "*", 
        RowBox[{"A", "[", 
         RowBox[{"4", ",", "4"}], "]"}], "*", 
        RowBox[{"GTStevensOperator", "[", 
         RowBox[{"4", ",", "4", ",", "JVal"}], "]"}]}]}], ")"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"%", "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.796836451864003*^9, 3.7968365074733353`*^9}, {
  3.796836620703352*^9, 3.796836698293068*^9}, {3.796836989544627*^9, 
  3.796836989678858*^9}, {3.796837043082181*^9, 3.796837084875671*^9}, {
  3.79683746419944*^9, 3.796837480719427*^9}, {3.7968375126629868`*^9, 
  3.796837532513829*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"55e8b138-4db9-4593-8e6d-0b979711a784"],

Cell["\<\
The relative numbers between OSt[4,0] and OSt[4,4] as well as between \
OSt[6,0] and OSt[6,4] are correct. The common factors F[4] and F[6] follow \
immediately from just looking at the matrices of O[4] and O[6] and dividing \
by the largest common factor of all (diagonal ) entries in the matrix. \
\>", "Text",
 CellChangeTimes->{{3.790103831018794*^9, 3.7901038785790854`*^9}, {
  3.790104093291892*^9, 3.790104138595586*^9}, {3.7901081664520617`*^9, 
  3.790108170116023*^9}, {3.796461687966905*^9, 
  3.796461688864135*^9}},ExpressionUUID->"7fde4379-68e9-460d-a95a-\
266c400787eb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{
    RowBox[{"GTStevensOperator", "[", 
     RowBox[{"4", ",", "0", ",", "JVal"}], "]"}], "+", 
    RowBox[{"5", "*", 
     RowBox[{"GTStevensOperator", "[", 
      RowBox[{"4", ",", "4", ",", "JVal"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%%", "/", "60"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.790103996480076*^9, 3.7901040744765244`*^9}, 
   3.7901041899889708`*^9, {3.790105237135083*^9, 3.790105250646049*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"42ed261e-dcc6-4563-8bb0-529dadeff9db"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"GTStevensOperator", "[", 
      RowBox[{"6", ",", "0", ",", "JVal"}], "]"}], "-", 
     RowBox[{"21", "*", 
      RowBox[{"GTStevensOperator", "[", 
       RowBox[{"6", ",", "4", ",", "JVal"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"%", "//", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%%", "/", "1260"}], "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{
  3.7901040550120907`*^9, {3.790104148636875*^9, 3.790104188101099*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"76f27a93-c841-4aa2-af7e-ef4540034b08"],

Cell["\<\
One can find F[4] and F[6] (at least in this case) by looking at the greatest \
common divisor (GCD) of the diagonal entries of O[4] and O[6], respectively. \
\
\>", "Text",
 CellChangeTimes->{{3.790108087497567*^9, 
  3.79010812630786*^9}},ExpressionUUID->"ea2561a0-f991-427e-b849-\
efe728360e78"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{
    RowBox[{"GTStevensOperator", "[", 
     RowBox[{"4", ",", "0", ",", "JVal"}], "]"}], "+", 
    RowBox[{"5", "*", 
     RowBox[{"GTStevensOperator", "[", 
      RowBox[{"4", ",", "4", ",", "JVal"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"temp", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "temp", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"GCD", "[", 
  RowBox[{
   RowBox[{"Abs", "[", 
    RowBox[{"temp", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
   RowBox[{"Abs", "[", 
    RowBox[{"temp", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
   RowBox[{"Abs", "[", 
    RowBox[{"temp", "[", 
     RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
   RowBox[{"Abs", "[", 
    RowBox[{"temp", "[", 
     RowBox[{"[", "4", "]"}], "]"}], "]"}], ",", 
   RowBox[{"Abs", "[", 
    RowBox[{"temp", "[", 
     RowBox[{"[", "5", "]"}], "]"}], "]"}], ",", 
   RowBox[{"Abs", "[", 
    RowBox[{"temp", "[", 
     RowBox[{"[", "6", "]"}], "]"}], "]"}], ",", 
   RowBox[{"Abs", "[", 
    RowBox[{"temp", "[", 
     RowBox[{"[", "7", "]"}], "]"}], "]"}], ",", 
   RowBox[{"Abs", "[", 
    RowBox[{"temp", "[", 
     RowBox[{"[", "8", "]"}], "]"}], "]"}], ",", 
   RowBox[{"Abs", "[", 
    RowBox[{"temp", "[", 
     RowBox[{"[", "9", "]"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{
    RowBox[{"GTStevensOperator", "[", 
     RowBox[{"6", ",", "0", ",", "JVal"}], "]"}], "-", 
    RowBox[{"21", "*", 
     RowBox[{"GTStevensOperator", "[", 
      RowBox[{"6", ",", "4", ",", "JVal"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"temp", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "temp", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"GCD", "[", 
  RowBox[{
   RowBox[{"Abs", "[", 
    RowBox[{"temp", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
   RowBox[{"Abs", "[", 
    RowBox[{"temp", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
   RowBox[{"Abs", "[", 
    RowBox[{"temp", "[", 
     RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
   RowBox[{"Abs", "[", 
    RowBox[{"temp", "[", 
     RowBox[{"[", "4", "]"}], "]"}], "]"}], ",", 
   RowBox[{"Abs", "[", 
    RowBox[{"temp", "[", 
     RowBox[{"[", "5", "]"}], "]"}], "]"}], ",", 
   RowBox[{"Abs", "[", 
    RowBox[{"temp", "[", 
     RowBox[{"[", "6", "]"}], "]"}], "]"}], ",", 
   RowBox[{"Abs", "[", 
    RowBox[{"temp", "[", 
     RowBox[{"[", "7", "]"}], "]"}], "]"}], ",", 
   RowBox[{"Abs", "[", 
    RowBox[{"temp", "[", 
     RowBox[{"[", "8", "]"}], "]"}], "]"}], ",", 
   RowBox[{"Abs", "[", 
    RowBox[{"temp", "[", 
     RowBox[{"[", "9", "]"}], "]"}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7901052520595903`*^9, 3.790105297614235*^9}, {
  3.7901054024716463`*^9, 3.7901054167872143`*^9}, {3.790107932293104*^9, 
  3.790107981875945*^9}, {3.790108023029406*^9, 3.79010807970979*^9}, {
  3.790108134133342*^9, 3.7901081370526133`*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"83dd25c2-9136-4679-9b76-e9e8a41bd96d"],

Cell["\<\
Conclusion: we can get the crystal field Hamiltonian from first expanding the \
crystal field expression in terms of Y[l,m] using GTCrystalField[Ohgroup,6]. \
Then, we replace the Y[l,m] by the GTBSTOperators[l,m,J]. If we want to work \
with Stevens\[CloseCurlyQuote] operators instead, we can use the formula in \
Danielsen and Lindgard to relate the BST operators to the Stevens\
\[CloseCurlyQuote] operators and replace the Y[l,m] combinations by the \
Stevens\[CloseCurlyQuote] operators, i.e, as done by hand above. This \
requires the use of the KCoeff[l,m] from the table on p.56 of Danielsen and \
Lindgard. \
\>", "Text",
 CellChangeTimes->{{3.790104195532783*^9, 3.790104330212212*^9}, 
   3.7901044917823*^9, {3.7964617534394703`*^9, 
   3.796461781763026*^9}},ExpressionUUID->"2fc83329-0f64-4e71-ae90-\
91a59644c6c2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"temp", "=", "vcrSt"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{"temp", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"0", ",", "0"}], "]"}], "\[Rule]", "0"}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vcrStMatrix", "=", 
   RowBox[{"temp", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"OSt", "[", 
        RowBox[{"4", ",", "0"}], "]"}], "\[Rule]", 
       RowBox[{
        RowBox[{"GTStevensOperator", "[", 
         RowBox[{"4", ",", "0", ",", "JVal"}], "]"}], "/", "60"}]}], ",", 
      RowBox[{
       RowBox[{"OSt", "[", 
        RowBox[{"4", ",", "4"}], "]"}], "->", 
       RowBox[{"5", "*", 
        RowBox[{
         RowBox[{"GTStevensOperator", "[", 
          RowBox[{"4", ",", "4", ",", "JVal"}], "]"}], "/", "60"}]}]}], ",", 
      RowBox[{
       RowBox[{"OSt", "[", 
        RowBox[{"6", ",", "0"}], "]"}], "->", 
       RowBox[{
        RowBox[{"GTStevensOperator", "[", 
         RowBox[{"6", ",", "0", ",", "JVal"}], "]"}], "/", "1260"}]}], ",", 
      RowBox[{
       RowBox[{"OSt", "[", 
        RowBox[{"6", ",", "4"}], "]"}], "->", 
       RowBox[{
        RowBox[{"GTStevensOperator", "[", 
         RowBox[{"6", ",", "4", ",", "JVal"}], "]"}], "/", "1260"}]}]}], 
     "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.796805202496027*^9, 3.796805211220599*^9}, {
  3.79683502149802*^9, 3.796835114235059*^9}, {3.796835144323694*^9, 
  3.796835173090616*^9}, {3.796835215475539*^9, 3.796835216648789*^9}, {
  3.796835250485244*^9, 3.7968352608082943`*^9}, {3.796835995489966*^9, 
  3.796836011011417*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"dbf2346c-eb06-4307-afd7-3e13b05b7417"]
}, Closed]],

Cell[CellGroupData[{

Cell["The case of J = 4", "Subsection",
 CellChangeTimes->{{3.7866500169480457`*^9, 3.786650025241604*^9}, {
  3.786650074758523*^9, 3.786650075429597*^9}, {3.796657762506205*^9, 
  3.796657771523488*^9}},ExpressionUUID->"3bcc91e8-5c47-4d37-a073-\
123fd4eedd5c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"JVal", "=", "4"}], ";"}]], "Input",
 CellChangeTimes->{{3.786640148438908*^9, 3.7866401487685127`*^9}, {
   3.7881950585497932`*^9, 3.788195058644024*^9}, {3.788195412637435*^9, 
   3.788195413708387*^9}, {3.788195886755945*^9, 3.78819588762637*^9}, {
   3.788196025865087*^9, 3.788196026015921*^9}, {3.796901445279166*^9, 
   3.7969014466723547`*^9}, 3.796901956860958*^9},
 CellLabel->"In[58]:=",ExpressionUUID->"3c71171a-6771-4655-a1f1-69b4df9d23ba"],

Cell[CellGroupData[{

Cell["\<\
First, let\[CloseCurlyQuote]s use Stevens operators and compare to Lea et al. \
\>", "Subsubsection",
 CellChangeTimes->{{3.786640459298354*^9, 3.786640471350705*^9}, {
  3.786649635465784*^9, 
  3.786649643956299*^9}},ExpressionUUID->"c61ff541-c6d2-4279-9687-\
2b592c633c46"],

Cell["Explicit formula from Lea et al.", "Text",
 CellChangeTimes->{{3.78677298410373*^9, 
  3.7867729953696404`*^9}},ExpressionUUID->"483999b9-f0fa-42cb-84c8-\
b1d66236d60b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"matcrStevens", "=", 
    RowBox[{
     RowBox[{"W", "*", "x", "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"GTStevensOperator", "[", 
          RowBox[{"4", ",", "0", ",", "JVal"}], "]"}], "+", 
         RowBox[{"5", "*", 
          RowBox[{"GTStevensOperator", "[", 
           RowBox[{"4", ",", "4", ",", "JVal"}], "]"}]}]}], ")"}], "/", 
       "60"}]}], "+", 
     RowBox[{"W", "*", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"Abs", "[", "x", "]"}]}], ")"}], "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"GTStevensOperator", "[", 
          RowBox[{"6", ",", "0", ",", "JVal"}], "]"}], "-", 
         RowBox[{"21", "*", 
          RowBox[{"GTStevensOperator", "[", 
           RowBox[{"6", ",", "4", ",", "JVal"}], "]"}]}]}], ")"}], "/", 
       "1260"}]}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"For", " ", "J"}], " ", "=", " ", 
    RowBox[{"15", "/", "2"}]}], " ", "*)"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"matcrStevens", "=", 
     RowBox[{
      RowBox[{"W", "*", "x", "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"GTStevensOperator", "[", 
           RowBox[{"4", ",", "0", ",", "JVal"}], "]"}], "+", 
          RowBox[{"5", "*", 
           RowBox[{"GTStevensOperator", "[", 
            RowBox[{"4", ",", "4", ",", "JVal"}], "]"}]}]}], ")"}], "/", 
        "60"}]}], "+", 
      RowBox[{"W", "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Abs", "[", "x", "]"}]}], ")"}], "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"GTStevensOperator", "[", 
           RowBox[{"6", ",", "0", ",", "JVal"}], "]"}], "-", 
          RowBox[{"21", "*", 
           RowBox[{"GTStevensOperator", "[", 
            RowBox[{"6", ",", "4", ",", "JVal"}], "]"}]}]}], ")"}], "/", 
        "13860"}]}]}]}], ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.7866404720455723`*^9, 3.786640522418222*^9}, {
  3.786640622767041*^9, 3.786640735086546*^9}, {3.786648825419053*^9, 
  3.7866488542708473`*^9}, {3.796901658597774*^9, 3.796901673043357*^9}, {
  3.7969019619486017`*^9, 3.7969019775476627`*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"e6f4001b-631e-455f-835e-da77c27e06d3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"esysStevens", "[", 
    RowBox[{"W_", ",", "x_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Eigensystem", "[", "matcrStevens", "]"}], "//", "Simplify"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.786647194544362*^9, 3.78664719542691*^9}, {
   3.7866488585873938`*^9, 3.786648862780579*^9}, 3.796901563085807*^9},
 CellLabel->"In[61]:=",ExpressionUUID->"5ec537de-fa30-414a-8d24-52a99acc3e8e"],

Cell["This agrees with the plot in the paper (as expected). ", "Text",
 CellChangeTimes->{{3.786649649839725*^9, 3.7866496577204447`*^9}, {
  3.788283111972159*^9, 
  3.788283121032646*^9}},ExpressionUUID->"0965468b-f227-4876-bc28-\
aabe7b4d12ca"],

Cell[BoxData[
 RowBox[{"plotLea", "=", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"esysStevens", "[", 
      RowBox[{"1", ",", "x"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<E\>\"", ",", "\"\<\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<x\>\"", ",", "\"\<Stevens Operators\>\""}], "}"}]}], 
      "}"}]}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Red", ",", "Dashed"}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.786640755408321*^9, 3.786640756230352*^9}, {
  3.786640862546723*^9, 3.7866409022112837`*^9}, {3.7866472092426643`*^9, 
  3.786647210366919*^9}, {3.786647423901922*^9, 3.786647445562648*^9}, {
  3.7866474929162273`*^9, 3.786647494676989*^9}, {3.786649299101058*^9, 
  3.7866493108282003`*^9}, {3.786649483347983*^9, 3.786649483952326*^9}, {
  3.796660422014801*^9, 3.796660422595109*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"28c76200-b54d-4dd3-aa3c-fcc0ef7db570"],

Cell[BoxData[{
 RowBox[{"Max", "[", 
  RowBox[{"N", "[", 
   RowBox[{"esysStevens", "[", 
    RowBox[{"1", ",", "0"}], "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Min", "[", 
  RowBox[{"N", "[", 
   RowBox[{"esysStevens", "[", 
    RowBox[{"1", ",", "0"}], "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"widthLea", "=", 
  RowBox[{"%%", "-", "%"}]}]}], "Input",
 CellChangeTimes->{{3.796660443096046*^9, 3.796660463987938*^9}, {
  3.7966605130051003`*^9, 3.7966605155072517`*^9}, {3.7969018457917767`*^9, 
  3.796901854859009*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"f44afcea-a7a9-41c4-bf2e-812848adcbd4"],

Cell["\<\
Look at eigenvectors at a given value of W and x. The eigenvectors are \
independent of W and x for J=4.  \
\>", "Text",
 CellChangeTimes->{{3.7882831259560947`*^9, 3.788283146307609*^9}, {
  3.788283259210984*^9, 
  3.788283269353887*^9}},ExpressionUUID->"a517d524-78b4-4d22-934a-\
06a871ec2b72"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"WVal", "=", "1."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xVal", "=", "0.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{"Normalize", "[", 
     RowBox[{
      RowBox[{"esysStevens", "[", 
       RowBox[{"WVal", ",", "xVal"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "idx"}], "]"}], "]"}], "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"idx", ",", "1", ",", 
     RowBox[{"Length", "[", 
      RowBox[{
       RowBox[{"esysStevens", "[", 
        RowBox[{"WVal", ",", "xVal"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.788195423082165*^9, 3.78819546429239*^9}, {
  3.7881955579896173`*^9, 3.7881955984205313`*^9}, {3.78819600552975*^9, 
  3.78819601868962*^9}, {3.788283154820372*^9, 3.788283257074589*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"e9180422-2dd7-4e31-b120-c849635d2c3f"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.788283199453341*^9, 3.7882832033951178`*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"09fdfc84-b9fa-4bce-8cb4-56add991d900"],

Cell["\<\
Derive the formula using group theory. As shown below: simply replacing the \
real spherical harmonics S[l,m] with the Stevens operators O[l,m] is not \
correct. Different normalization used. Needs to be investigates further if I \
want to derive the crystal field expression in terms of Stevens operators for \
general J and point group symmetry. Since I solved this problem already using \
the BST operators below (which is physically equivalent), maybe we don\
\[CloseCurlyQuote]t need that and we just use BST operators. \
\[LineSeparator]Actually, the tutorial on the Hergert website follows exactly \
the same approach. So maybe it is correct, but I still will use the BST \
approach for now. \
\>", "Text",
 CellChangeTimes->{{3.786772998484136*^9, 3.786773008911807*^9}, {
  3.788283304282577*^9, 3.7882833715437326`*^9}, {3.7882835450117693`*^9, 
  3.7882836218563757`*^9}, {3.797112175510292*^9, 
  3.797112209532413*^9}},ExpressionUUID->"acfe5f00-43c9-401f-af7d-\
b012f7c866da"],

Cell[BoxData[
 RowBox[{"vcrReal", "=", 
  RowBox[{"GTCrystalField", "[", 
   RowBox[{"Ohgroup", ",", "6", ",", " ", 
    RowBox[{"GOHarmonics", "\[Rule]", "\"\<Real\>\""}]}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.7867730110266857`*^9, {3.7867733113048067`*^9, 3.7867733165684233`*^9}, {
   3.7867734592356052`*^9, 3.786773482391965*^9}, 3.788283274314453*^9},
 CellLabel->"In[70]:=",ExpressionUUID->"2af1a664-9088-4a3a-91f7-442263963528"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{"vcrReal", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"ll_", ",", "mm_"}], "]"}], "\[RuleDelayed]", 
      RowBox[{"GTStevensOperator", "[", 
       RowBox[{"ll", ",", "mm", ",", "JVal"}], "]"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{"temp", "/.", 
    RowBox[{
     RowBox[{"A", "[", 
      RowBox[{"0", ",", "0"}], "]"}], "\[Rule]", "0"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matcrA4A6", "=", 
   RowBox[{"temp", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"r", "\[Rule]", "1"}], ",", 
      RowBox[{
       RowBox[{"A", "[", 
        RowBox[{"4", ",", "4"}], "]"}], "\[Rule]", "a4"}], ",", 
      RowBox[{
       RowBox[{"A", "[", 
        RowBox[{"6", ",", "4"}], "]"}], "\[Rule]", "a6"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Coefficient", "[", 
   RowBox[{"matcrA4A6", ",", "a4"}], "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}], "/", 
  RowBox[{"%", "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "5"}], "]"}], "]"}]}], "\[IndentingNewLine]"}], "Input",\

 CellChangeTimes->{{3.786773500487219*^9, 3.7867735897763453`*^9}, {
  3.786774366032731*^9, 3.7867744263152*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"da0b62aa-79b3-48c5-b8b6-bc29b0de1b53"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"GTStevensOperator", "[", 
      RowBox[{"4", ",", "0", ",", "JVal"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}], "/", "5"}], "/", 
   RowBox[{
    RowBox[{"GTStevensOperator", "[", 
     RowBox[{"4", ",", "4", ",", "JVal"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "5"}], "]"}], "]"}]}], "//", "FullSimplify"}]], "Input",\

 CellChangeTimes->{{3.7867744421429033`*^9, 3.786774483878867*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"cba7878b-ba1e-4e70-9452-5e56f6c87994"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GTStevensOperator", "[", 
    RowBox[{"4", ",", "0", ",", "JVal"}], "]"}], "+", 
   RowBox[{"GTStevensOperator", "[", 
    RowBox[{"4", ",", "4", ",", "JVal"}], "]"}]}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.78677431140208*^9, 3.786774355613225*^9}, {
  3.786774520598693*^9, 3.7867745260045424`*^9}, {3.786774557557366*^9, 
  3.786774557709092*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"f90de261-ec60-4e83-abe9-fab3c95790dd"],

Cell[BoxData[
 RowBox[{"Integrate", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Sin", "[", "\[Theta]", "]"}], "*", 
    RowBox[{"GTTesseralHarmonicY", "[", 
     RowBox[{"4", ",", "4", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], "*", 
    RowBox[{"Conjugate", "[", 
     RowBox[{"GTTesseralHarmonicY", "[", 
      RowBox[{"4", ",", "4", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], "]"}]}],
    ",", 
   RowBox[{"{", 
    RowBox[{"\[Theta]", ",", "0", ",", "Pi"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Phi]", ",", "0", ",", 
     RowBox[{"2", "*", "Pi"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.788547261029958*^9, 3.788547347573496*^9}, {
  3.788547386815002*^9, 3.788547428343728*^9}, {3.7885483409886417`*^9, 
  3.7885484052208843`*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"39092391-3ec3-45e3-9e23-dca1961ba91b"],

Cell[BoxData[
 RowBox[{"GTTesseralHarmonicY", "[", 
  RowBox[{"4", ",", "0", ",", "\[Theta]", ",", "\[Phi]"}], "]"}]], "Input",
 CellChangeTimes->{{3.788548462864356*^9, 3.7885484631588182`*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"ee0d5c09-e3dc-49a6-90f0-512d3412b65d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Let\[CloseCurlyQuote]s follow the tutorial on the Hergert website", \
"Subsubsection",
 CellChangeTimes->{{3.797111531295628*^9, 
  3.797111549951507*^9}},ExpressionUUID->"fb181d3d-1003-4a7d-b1bd-\
e4a844e0bedf"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "m", "]"}], "\[IndentingNewLine]", 
 RowBox[{"vcrReal", "=", 
  RowBox[{
   RowBox[{"GTCrystalField", "[", 
    RowBox[{"Ohgroup", ",", "6", ",", 
     RowBox[{"GOHarmonics", "\[Rule]", "\"\<Real\>\""}]}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"A", "[", 
      RowBox[{"l_", ",", "m_"}], "]"}], "\[Rule]", 
     RowBox[{
      RowBox[{"B", "[", 
       RowBox[{"l", ",", "m"}], "]"}], "/", 
      RowBox[{"r", "^", "l"}]}]}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%", "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"l_", ",", "m_"}], "]"}], ":>", 
      RowBox[{"GTStevensOperator", "[", 
       RowBox[{"l", ",", "m", ",", "JVal"}], "]"}]}], "}"}]}], "//", 
   "Normal"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{
    RowBox[{"B", "[", 
     RowBox[{"0", ",", "0"}], "]"}], "\[Rule]", "0"}]}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.797111228531823*^9, 3.7971112368932953`*^9}, {
  3.797111284544944*^9, 3.7971114537376013`*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"709c17e3-fe44-4ba6-bb73-aeed8dfedfb8"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{3.797111523288164*^9},
 CellLabel->"In[86]:=",ExpressionUUID->"f67574d1-7b9b-4d10-9fc9-abeace37b21e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Now let\[CloseCurlyQuote]s use BST operators based on the ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["Y", "lm"], TraditionalForm]],ExpressionUUID->
  "0936fc1a-4314-4b60-b21d-a8fcf5dc567c"],
 " expansion. "
}], "Subsubsection",
 CellChangeTimes->{{3.786627477093186*^9, 3.7866275070194397`*^9}, {
   3.786649661432042*^9, 3.7866496836520576`*^9}, 3.786650013239037*^9, {
   3.7866500442382917`*^9, 
   3.786650044977528*^9}},ExpressionUUID->"a32fda8e-ab15-48b0-80b4-\
d37b91b2f0b8"],

Cell[TextData[{
 "Let\[CloseCurlyQuote]s build the crystal field matrix for J=4 in a ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["O", "h"], TraditionalForm]],ExpressionUUID->
  "2c7f285a-167e-473f-8659-bbbc48e6429c"],
 " crystal field.\nThe coefficient A[0,0] is just a constant (on the \
diagonal) and can thus be set to zero as it corresponds to an overall shift \
of spectrum.  "
}], "Text",
 CellChangeTimes->{{3.786650046352827*^9, 3.786650052139447*^9}, {
  3.796657942634418*^9, 
  3.796657942861779*^9}},ExpressionUUID->"fdf51dde-b84b-426c-85a8-\
e1d6b5278bd7"],

Cell[BoxData["vcr"], "Input",
 CellLabel->"In[87]:=",ExpressionUUID->"3a7a1e1e-e1b5-43b8-8b08-0ce6e74065c5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{
    RowBox[{"vcr", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Y", "[", 
        RowBox[{"ll_", ",", "mm_"}], "]"}], "\[RuleDelayed]", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "*", "ll"}], "+", "1"}], ")"}], "/", "4"}], "/", 
          "Pi"}], "]"}], "*", 
        RowBox[{"GTBSTOperator", "[", 
         RowBox[{"ll", ",", "mm", ",", "JVal"}], "]"}]}]}], "}"}]}], "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{"temp", "/.", 
    RowBox[{
     RowBox[{"A", "[", 
      RowBox[{"0", ",", "0"}], "]"}], "\[Rule]", "0"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matcrBST", "=", 
   RowBox[{"temp", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"r", "\[Rule]", "1"}], ",", 
      RowBox[{
       RowBox[{"A", "[", 
        RowBox[{"4", ",", "4"}], "]"}], "\[Rule]", "a4"}], ",", 
      RowBox[{
       RowBox[{"A", "[", 
        RowBox[{"6", ",", "4"}], "]"}], "\[Rule]", "a6"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.786627507720357*^9, 3.78662757792964*^9}, {
   3.7866277202481613`*^9, 3.786627735412421*^9}, {3.786627788623618*^9, 
   3.786627795672579*^9}, {3.786627923395748*^9, 3.786627953386715*^9}, {
   3.786628019298029*^9, 3.786628041536735*^9}, {3.786628426059493*^9, 
   3.786628461686534*^9}, {3.786628743577692*^9, 3.786628760372045*^9}, {
   3.7866400864895163`*^9, 3.78664015233587*^9}, {3.786640825633441*^9, 
   3.786640832701601*^9}, {3.786646996634104*^9, 3.786646999540801*^9}, {
   3.7866488342181587`*^9, 3.786648840252643*^9}, {3.7866491497723207`*^9, 
   3.786649155594781*^9}, {3.786649253814671*^9, 3.7866492654485893`*^9}, {
   3.7866494124688387`*^9, 3.786649414051375*^9}, {3.786649585012562*^9, 
   3.786649586039554*^9}, {3.78664990702824*^9, 3.786649915694008*^9}, {
   3.788195070645948*^9, 3.78819508183741*^9}, {3.7901104347783127`*^9, 
   3.7901104682891407`*^9}, {3.796657789537939*^9, 3.7966578185610228`*^9}, 
   3.7966578637771597`*^9, {3.796657927196455*^9, 3.796657936733631*^9}, {
   3.796658160029942*^9, 3.7966581781722927`*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"bef15d7b-dc02-4239-b32a-cb9093cc7403"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{
    RowBox[{"vcr", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Y", "[", 
        RowBox[{"ll_", ",", "mm_"}], "]"}], "\[RuleDelayed]", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "*", "ll"}], "+", "1"}], ")"}], "/", "4"}], "/", 
          "Pi"}], "]"}], "*", 
        RowBox[{"GTBSTOperator", "[", 
         RowBox[{"ll", ",", "mm", ",", "JVal"}], "]"}]}]}], "}"}]}], "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{"temp", "/.", 
    RowBox[{
     RowBox[{"A", "[", 
      RowBox[{"0", ",", "0"}], "]"}], "\[Rule]", "0"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.796838611435557*^9, 3.796838630456826*^9}, {
  3.796838684287139*^9, 3.796838690557645*^9}, {3.796838754801195*^9, 
  3.7968387700946283`*^9}, {3.796838854279707*^9, 3.796838857562723*^9}, {
  3.79689508499065*^9, 3.796895093610024*^9}, {3.7968952893579817`*^9, 
  3.7968952973118887`*^9}, {3.796899679231073*^9, 3.79689969577453*^9}},
 CellLabel->"In[93]:=",ExpressionUUID->"f4f8bb26-429e-4542-ad5b-3e9b5b8083e9"],

Cell[BoxData[{"$BaseDirectory", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<datasets\>\""}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GTCFDatabaseInfo", "[", "\"\<CF_Database\>\"", "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.796839084569809*^9, 3.796839085807219*^9}, {
  3.796899691334785*^9, 3.7968996916488037`*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"442690f6-2454-4601-9495-97a7aeef30b0"],

Cell["\<\
Let\[CloseCurlyQuote]s find the eigenspectrum and eigenvectors as a function \
of a4 and a6. Obviously, only their ratio should matter. For this, we find \
the common factor of the matrices multiplying a4 and a6 and pulling that out. \
Unfortunately, there is no common factor in the matrices multiplying the a4 \
and a6 coefficients respectively unfortunately. \
\>", "Text",
 CellChangeTimes->{{3.7966580581170273`*^9, 3.796658116973431*^9}, {
  3.796659666188403*^9, 
  3.7966596956039553`*^9}},ExpressionUUID->"55867764-e697-4a4d-9465-\
08dd15478763"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"matA4", "=", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"matcrBST", ",", "a4"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matA6", "=", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"matcrBST", ",", "a6"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"a4", "*", "matA4"}], "+", 
    RowBox[{"a6", "*", "matA6"}], "-", "matcrBST"}], "//", "FullSimplify"}], 
  ";"}]}], "Input",
 CellChangeTimes->{
  3.796658119511499*^9, {3.79665817602528*^9, 3.796658216521126*^9}, {
   3.796658250575593*^9, 3.7966583079603167`*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"8784ba65-d682-46d8-b4f1-85a9534332e4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"temp", "=", "matA4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{"Abs", "[", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"Flatten", "[", "temp", "]"}], ",", 
      RowBox[{
       RowBox[{"#", "\[NotEqual]", "0"}], "&"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Length", "[", "temp", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GCD", "[", 
    RowBox[{
     RowBox[{"temp", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "4", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "5", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "6", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "7", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "8", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "9", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "10", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "11", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "12", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "13", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "14", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "15", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "16", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "17", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "18", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "19", "]"}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
  
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"temp", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"temp", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "temp", "]"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"GCD", "[", 
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"temp", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
      RowBox[{"Abs", "[", 
       RowBox[{"temp", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
      RowBox[{"Abs", "[", 
       RowBox[{"temp", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
      RowBox[{"Abs", "[", 
       RowBox[{"temp", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "]"}], ",", 
      RowBox[{"Abs", "[", 
       RowBox[{"temp", "[", 
        RowBox[{"[", "5", "]"}], "]"}], "]"}], ",", 
      RowBox[{"Abs", "[", 
       RowBox[{"temp", "[", 
        RowBox[{"[", "6", "]"}], "]"}], "]"}], ",", 
      RowBox[{"Abs", "[", 
       RowBox[{"temp", "[", 
        RowBox[{"[", "7", "]"}], "]"}], "]"}], ",", 
      RowBox[{"Abs", "[", 
       RowBox[{"temp", "[", 
        RowBox[{"[", "8", "]"}], "]"}], "]"}], ",", 
      RowBox[{"Abs", "[", 
       RowBox[{"temp", "[", 
        RowBox[{"[", "9", "]"}], "]"}], "]"}]}], "]"}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Min", "[", "temp", "]"}], "//", "N"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Max", "[", "temp", "]"}], "//", "N"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matA4Av", "=", 
   RowBox[{
    RowBox[{"Norm", "[", 
     RowBox[{"Eigenvalues", "[", "matA4", "]"}], "]"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", "*", "JVal"}], "+", "1"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"temp", "=", 
     RowBox[{"Flatten", "[", "matA4", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"matA4Av", "=", 
     RowBox[{
      RowBox[{"Norm", "[", "temp", "]"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", "*", "JVal"}], "+", "1"}], ")"}]}]}], ";"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.7966583111783867`*^9, 3.7966583147590723`*^9}, 
   3.796658356374555*^9, {3.796658433420876*^9, 3.7966584633918657`*^9}, {
   3.796658496436825*^9, 3.796658532089654*^9}, {3.796659172254266*^9, 
   3.796659339374614*^9}, {3.796659474082996*^9, 3.7966595613539248`*^9}, {
   3.796659600789694*^9, 3.796659662278084*^9}, {3.796659906477929*^9, 
   3.796659961441085*^9}, {3.7966600937494097`*^9, 3.796660134489295*^9}, {
   3.796660720624673*^9, 3.7966607296844482`*^9}, {3.796896789760777*^9, 
   3.7968968102344*^9}, {3.7968969371331*^9, 3.796896954700213*^9}, {
   3.79689925287754*^9, 3.79689927695789*^9}},
 CellLabel->
  "In[102]:=",ExpressionUUID->"5e780ecb-51a7-4f56-87bd-96b0cefe1520"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"temp", "=", "matA6"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{"Abs", "[", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"Flatten", "[", "temp", "]"}], ",", 
      RowBox[{
       RowBox[{"#", "\[NotEqual]", "0"}], "&"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Length", "[", "temp", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GCD", "[", 
    RowBox[{
     RowBox[{"temp", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "4", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "5", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "6", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "7", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "8", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "9", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "10", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "11", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "12", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "13", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "14", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "15", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "16", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "17", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "18", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "19", "]"}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
  
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"temp", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"temp", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "temp", "]"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"GCD", "[", 
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"temp", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
      RowBox[{"Abs", "[", 
       RowBox[{"temp", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
      RowBox[{"Abs", "[", 
       RowBox[{"temp", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
      RowBox[{"Abs", "[", 
       RowBox[{"temp", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "]"}], ",", 
      RowBox[{"Abs", "[", 
       RowBox[{"temp", "[", 
        RowBox[{"[", "5", "]"}], "]"}], "]"}], ",", 
      RowBox[{"Abs", "[", 
       RowBox[{"temp", "[", 
        RowBox[{"[", "6", "]"}], "]"}], "]"}], ",", 
      RowBox[{"Abs", "[", 
       RowBox[{"temp", "[", 
        RowBox[{"[", "7", "]"}], "]"}], "]"}], ",", 
      RowBox[{"Abs", "[", 
       RowBox[{"temp", "[", 
        RowBox[{"[", "8", "]"}], "]"}], "]"}], ",", 
      RowBox[{"Abs", "[", 
       RowBox[{"temp", "[", 
        RowBox[{"[", "9", "]"}], "]"}], "]"}]}], "]"}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"temp", "//", "N"}], "//", "MatrixForm"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Min", "[", "temp", "]"}], "//", "N"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Max", "[", "temp", "]"}], "//", "N"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matA6Av", "=", 
   RowBox[{
    RowBox[{"Norm", "[", 
     RowBox[{"Eigenvalues", "[", "matA6", "]"}], "]"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", "*", "JVal"}], "+", "1"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"temp", "=", 
     RowBox[{"Flatten", "[", "matA6", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Norm", "[", "temp", "]"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", "*", "JVal"}], "+", "1"}], ")"}]}]}], "*)"}]}]}], "Input",\

 CellChangeTimes->{
  3.7966593897001457`*^9, 3.796659894072124*^9, {3.7966599682100487`*^9, 
   3.7966599752322206`*^9}, {3.796660070554433*^9, 3.796660117710869*^9}, {
   3.796660191094643*^9, 3.796660192674307*^9}, {3.796896963107583*^9, 
   3.796896982739888*^9}, {3.796899212353177*^9, 3.7968992441861963`*^9}, 
   3.796899725089169*^9},
 CellLabel->
  "In[109]:=",ExpressionUUID->"35513c7d-c419-414e-a241-f6949af47912"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ham", "[", "x_", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"x", "*", 
      RowBox[{"matA4", "/", "matA4Av"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Abs", "[", "x", "]"}], "-", "1"}], ")"}], "*", 
      RowBox[{"matA6", "/", "matA6Av"}]}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"energies", "[", "x_", "]"}], ":=", 
   RowBox[{"Sort", "[", 
    RowBox[{"Eigenvalues", "[", 
     RowBox[{"ham", "[", "x", "]"}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.7966583263578873`*^9, {3.796660148329115*^9, 3.796660226315435*^9}, {
   3.79666074479909*^9, 3.796660745715601*^9}, {3.796661377716734*^9, 
   3.796661382701233*^9}, {3.79666142451544*^9, 3.796661432398801*^9}, {
   3.796662295430895*^9, 3.796662300213688*^9}, {3.796751985414648*^9, 
   3.796752008164106*^9}, 3.796901486293532*^9, {3.796924391561306*^9, 
   3.7969243940726213`*^9}},
 CellLabel->
  "In[117]:=",ExpressionUUID->"86f66e92-9726-4a72-99c3-a402a13ed8a5"],

Cell[BoxData[
 RowBox[{"plot1", "=", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"energies", "[", "x", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<E/W\>\"", ",", "\"\<\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<x\>\"", ",", "\"\<\>\""}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"Directive", "[", "Blue", "]"}]}], ",", " ", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"Thickness", "[", "0.0025", "]"}], ",", 
       RowBox[{"FontSize", "\[Rule]", "14"}], ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.796660288131609*^9, 3.796660308531536*^9}, {
  3.796660375760756*^9, 3.796660383352623*^9}, {3.7967502105470667`*^9, 
  3.7967502377208014`*^9}, {3.796750381125403*^9, 3.796750426440358*^9}, {
  3.7967504619482527`*^9, 3.7967505605332336`*^9}, {3.7967506415632267`*^9, 
  3.796750642344624*^9}, {3.796901500735393*^9, 3.796901502349043*^9}, {
  3.796923661767095*^9, 3.7969236636434717`*^9}},
 CellLabel->
  "In[119]:=",ExpressionUUID->"d91792ff-d688-44c2-b21c-ea2fb13d9511"],

Cell[BoxData[{
 RowBox[{"SetDirectory", "[", 
  RowBox[{
   RowBox[{"NotebookDirectory", "[", "]"}], "~~", 
   "\"\<../Notes_Peter/Graphics\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{"\"\<Energies-J_15_2-B_0-BST.pdf\>\"", ",", "plot1"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.7967506433982887`*^9, 3.796750678166649*^9}, {
  3.796750936904496*^9, 3.7967509436905603`*^9}, {3.796897118260778*^9, 
  3.7968971231063147`*^9}, {3.79690187254598*^9, 3.796901886571361*^9}},
 CellLabel->
  "In[120]:=",ExpressionUUID->"5216f837-c289-4f89-a021-23ed05120aa1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"widthBST", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Max", "[", 
      RowBox[{"energies", "[", "0", "]"}], "]"}], "-", 
     RowBox[{"Min", "[", 
      RowBox[{"energies", "[", "0", "]"}], "]"}]}], "//", "N"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp1", "=", 
   RowBox[{
    RowBox[{"Sort", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"energies", "[", 
         RowBox[{"-", "1"}], "]"}]}], "/", "widthBST"}], "*", "widthLea"}], 
     "]"}], "//", "N"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp2", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{
     RowBox[{"N", "[", 
      RowBox[{"esysStevens", "[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"evalRatioAt1", "=", 
    RowBox[{
     RowBox[{"temp1", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "/", 
     RowBox[{"temp2", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ham2", "[", "x_", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"x", "*", 
      RowBox[{
       RowBox[{"matA4", "/", "matA4Av"}], "/", "evalRatioAt1"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"Abs", "[", "x", "]"}]}], ")"}], "*", 
      RowBox[{"matA6", "/", "matA6Av"}]}]}], "//", "FullSimplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"energies2", "[", "x_", "]"}], ":=", 
   RowBox[{"Sort", "[", 
    RowBox[{"Eigenvalues", "[", 
     RowBox[{"-", 
      RowBox[{"ham2", "[", 
       RowBox[{"-", "x"}], "]"}]}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.796660471962714*^9, 3.796660506864067*^9}, {
   3.7966606671327887`*^9, 3.7966606934542933`*^9}, {3.796660829154085*^9, 
   3.7966608315233994`*^9}, {3.796660938333695*^9, 3.796660946605171*^9}, {
   3.796660985651045*^9, 3.796661029512504*^9}, {3.796661078491111*^9, 
   3.796661102642625*^9}, {3.7966612907778997`*^9, 3.796661334239572*^9}, {
   3.796661393581348*^9, 3.79666143612462*^9}, {3.796662140142885*^9, 
   3.7966621737764072`*^9}, 3.796897010251647*^9, {3.79689718446889*^9, 
   3.796897186162202*^9}, {3.796899304529277*^9, 3.796899307152666*^9}, {
   3.7969019010087214`*^9, 3.796901905916005*^9}, {3.796923722614828*^9, 
   3.796923726956203*^9}},
 CellLabel->
  "In[122]:=",ExpressionUUID->"02b5ccab-d826-4c25-9715-799b4950e905"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"temp1", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "/", 
   RowBox[{"temp1", "[", 
    RowBox[{"[", "4", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"temp2", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "/", 
    RowBox[{"temp2", "[", 
     RowBox[{"[", "4", "]"}], "]"}]}], "//", "N"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"temp1", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "/", 
   RowBox[{"temp1", "[", 
    RowBox[{"[", "6", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"temp2", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "/", 
    RowBox[{"temp2", "[", 
     RowBox[{"[", "6", "]"}], "]"}]}], "//", "N"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"temp1", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "/", 
   RowBox[{"temp1", "[", 
    RowBox[{"[", "9", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"temp2", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "/", 
    RowBox[{"temp2", "[", 
     RowBox[{"[", "9", "]"}], "]"}]}], "//", "N"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"temp1", "[", 
    RowBox[{"[", "4", "]"}], "]"}], "/", 
   RowBox[{"temp1", "[", 
    RowBox[{"[", "6", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"temp2", "[", 
     RowBox[{"[", "4", "]"}], "]"}], "/", 
    RowBox[{"temp2", "[", 
     RowBox[{"[", "6", "]"}], "]"}]}], "//", "N"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"temp1", "[", 
    RowBox[{"[", "4", "]"}], "]"}], "/", 
   RowBox[{"temp1", "[", 
    RowBox[{"[", "9", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"temp2", "[", 
     RowBox[{"[", "4", "]"}], "]"}], "/", 
    RowBox[{"temp2", "[", 
     RowBox[{"[", "9", "]"}], "]"}]}], "//", "N"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"temp1", "[", 
    RowBox[{"[", "6", "]"}], "]"}], "/", 
   RowBox[{"temp1", "[", 
    RowBox[{"[", "9", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"temp2", "[", 
     RowBox[{"[", "6", "]"}], "]"}], "/", 
    RowBox[{"temp2", "[", 
     RowBox[{"[", "9", "]"}], "]"}]}], "//", "N"}], ";"}]}], "Input",
 CellChangeTimes->{{3.796661033882621*^9, 3.796661066723879*^9}, {
  3.796661115095394*^9, 3.796661205649329*^9}, {3.796897213520438*^9, 
  3.7968972423628902`*^9}},
 CellLabel->
  "In[128]:=",ExpressionUUID->"ddb1dedc-3ddc-4f84-b582-165c1049b110"],

Cell["\<\
We find that BST and Lea et al. spectra are identical, if we choose the same \
rescaling of A4 and A6 terms. This can be done by looking at the eigenvalues \
at x=0, where only A4 contributes, and x=1, where only A6 contributes. \
\>", "Text",
 CellChangeTimes->{{3.7966625674241447`*^9, 3.79666268137527*^9}, 
   3.796663741487897*^9, {3.796923676172271*^9, 
   3.796923676766264*^9}},ExpressionUUID->"09ca0625-0482-49ae-9f85-\
e9b4b1a99bcc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"energies1", "[", "x_", "]"}], ":=", 
   RowBox[{"Sort", "[", 
    RowBox[{"Eigenvalues", "[", 
     RowBox[{"-", 
      RowBox[{"ham", "[", 
       RowBox[{"-", "x"}], "]"}]}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{3.796752016467967*^9},
 CellLabel->
  "In[140]:=",ExpressionUUID->"0ab12f6b-1528-4eb2-84a3-2594faae88c4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"plotBSTScaled", "=", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"energies1", "[", "x", "]"}], ")"}], "/", "widthBST"}], "*", 
      "widthLea"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<E\>\"", ",", "\"\<\>\""}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<x\>\"", ",", "\"\<BST (scaled) and Lea energies\>\""}], 
         "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"Directive", "[", "Blue", "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotBSTScaled2", "=", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"energies2", "[", "x", "]"}], ")"}], "/", "widthBST"}], "*", 
      "widthLea"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<E\>\"", ",", "\"\<\>\""}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<x\>\"", ",", "\"\<BST scaled\>\""}], "}"}]}], "}"}]}], 
     ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Green", ",", "DotDashed"}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"plot", "=", 
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"plotBSTScaled", ",", "plotBSTScaled2", ",", "plotLea"}], "}"}], 
    ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<E/W\>\"", ",", "\"\<\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<x\>\"", ",", "\"\<\>\""}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"Directive", "[", "Blue", "]"}]}], ",", " ", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"Thickness", "[", "0.0025", "]"}], ",", 
       RowBox[{"FontSize", "\[Rule]", "14"}], ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}]}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.7966605267764387`*^9, 3.796660600858708*^9}, {
  3.7966621779726543`*^9, 3.79666221686056*^9}, {3.796663693731529*^9, 
  3.796663726197976*^9}, {3.79675192320008*^9, 3.796751944022232*^9}, {
  3.796751990702016*^9, 3.796752048099668*^9}, {3.796752275032593*^9, 
  3.79675227526963*^9}, {3.79689719132966*^9, 3.7968971934830837`*^9}},
 CellLabel->
  "In[141]:=",ExpressionUUID->"242a30e4-11a6-4cf0-b301-75b21155017f"],

Cell[BoxData[{
 RowBox[{"SetDirectory", "[", 
  RowBox[{
   RowBox[{"NotebookDirectory", "[", "]"}], "~~", 
   "\"\<../Notes_Peter/Graphics\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
  "\"\<Energies-J_15_2-B_0-BST_Stevens_Rescaled.pdf\>\"", ",", "plot"}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.7966635919521217`*^9, {3.796752043079856*^9, 3.796752056993846*^9}, 
   3.7968972051598*^9, {3.796901945918487*^9, 3.796901948066246*^9}},
 CellLabel->
  "In[144]:=",ExpressionUUID->"a7ef5b45-b265-46b8-9b5f-0fd58b55199a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Show that BST and Stevens matrices are identical", "Subsubsection",
 CellChangeTimes->{{3.796657973115952*^9, 
  3.796657989551713*^9}},ExpressionUUID->"32864a20-a379-4b59-aaa3-\
613288c98379"],

Cell["\<\
Show that the Stevens and BST matrices are identical. Take two elements (1,1) \
and (5,1) of the two Hamiltonians H[W,x] and H[a4,a6] and solve for a4[W,x] \
and a6[W,x].\
\>", "Text",
 CellChangeTimes->{{3.7866496976255198`*^9, 3.786649715736692*^9}, {
  3.788283473503435*^9, 
  3.7882835082481833`*^9}},ExpressionUUID->"ae086a8b-b81f-40f0-a613-\
69ae6de3af84"],

Cell[BoxData[{
 RowBox[{"eqs", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"matcrA4A6", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], "==", 
     RowBox[{"matcrStevens", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
    RowBox[{
     RowBox[{"matcrA4A6", "[", 
      RowBox[{"[", 
       RowBox[{"5", ",", "1"}], "]"}], "]"}], "\[Equal]", 
     RowBox[{"matcrStevens", "[", 
      RowBox[{"[", 
       RowBox[{"5", ",", "1"}], "]"}], "]"}]}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"sol", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{"eqs", ",", 
     RowBox[{"{", 
      RowBox[{"a4", ",", "a6"}], "}"}]}], "]"}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matcr", "=", 
   RowBox[{
    RowBox[{"matcrA4A6", "/.", 
     RowBox[{"sol", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "//", "FullSimplify"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.786649718546517*^9, 3.78664977048533*^9}, {
  3.786649891775519*^9, 3.786649926315939*^9}},
 CellLabel->
  "In[146]:=",ExpressionUUID->"f903e549-e6d5-4adb-b603-16d8f5b327e5"],

Cell["\<\
Indeed, the two matrices \[OpenCurlyDoubleQuote]matcr\[CloseCurlyDoubleQuote] \
(using BST operators) and \[OpenCurlyDoubleQuote]matcrStevens\
\[CloseCurlyDoubleQuote] (using Stevens operators) are identical if we use \
the correct parametrization of W and x. \
\>", "Text",
 CellChangeTimes->{{3.786649812345018*^9, 
  3.7866498564943323`*^9}},ExpressionUUID->"f2ded8f6-52cf-4733-b25a-\
2c93f56ae18f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"matcr", "-", "matcrStevens"}], "//", "FullSimplify"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.786649866709489*^9, 3.7866498719381657`*^9}},
 CellLabel->
  "In[149]:=",ExpressionUUID->"84a6fea8-79e4-479c-a690-843c6422308c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"esys", "[", 
    RowBox[{"W_", ",", "x_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Eigensystem", "[", "matcr", "]"}], "//", "FullSimplify"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.786628099446479*^9, 3.7866281556497097`*^9}, {
  3.786628481648408*^9, 3.78662848317231*^9}, {3.786628531127221*^9, 
  3.786628531536119*^9}, {3.7866287807739077`*^9, 3.786628781174721*^9}, {
  3.78664884513208*^9, 3.786648846317134*^9}},
 CellLabel->
  "In[150]:=",ExpressionUUID->"ec512b74-b1de-4423-97e0-a8a7b8b3795f"],

Cell[BoxData[
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"esys", "[", 
     RowBox[{"W", ",", "x"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"W", ",", 
     RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.786628157120571*^9, 3.786628198427907*^9}, {
  3.786628286343534*^9, 3.786628299525857*^9}, {3.786628626235262*^9, 
  3.786628634436903*^9}, {3.786628711268499*^9, 3.786628711357843*^9}, {
  3.786628775930031*^9, 3.7866287907765493`*^9}},
 CellLabel->
  "In[260]:=",ExpressionUUID->"06db0f84-c1da-4013-849f-54ba42c0f41a"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.7964885306422567`*^9},ExpressionUUID->"eb1c0d09-4942-4a44-b04c-\
543fe8161f3e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"plot1", "=", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"esys", "[", 
       RowBox[{"1", ",", "x"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.786628347477253*^9, 3.786628390784327*^9}, {
   3.786628487232131*^9, 3.78662848850653*^9}, {3.786628585147829*^9, 
   3.7866285878555593`*^9}, {3.78662886341044*^9, 3.786628881306322*^9}, {
   3.7866289118636303`*^9, 3.786628912269525*^9}, {3.7866290571903353`*^9, 
   3.786629093980764*^9}, {3.78662914516424*^9, 3.786629159182889*^9}, {
   3.786629205334876*^9, 3.7866292200363092`*^9}, 3.786640187655031*^9, {
   3.7866402190156307`*^9, 3.786640221311346*^9}, {3.7866403128427877`*^9, 
   3.786640321276907*^9}, {3.786647141891985*^9, 3.786647163596879*^9}, {
   3.786647322448441*^9, 3.786647324902676*^9}, {3.7866473618363*^9, 
   3.78664736431413*^9}, {3.786647510766984*^9, 3.7866475125374947`*^9}, {
   3.7866492877685213`*^9, 3.786649289021378*^9}, 3.786649935632615*^9},
 CellLabel->
  "In[261]:=",ExpressionUUID->"ee882c64-9da0-4ca2-a7af-6ada4bc7eae2"],

Cell["\<\
The energy spectrum of the Hamiltonians (obviously) derived using BST and \
Stevens operators agree after proper rescaling of a4 and a6 coefficients, as \
they are identical. 
\
\>", "Text",
 CellChangeTimes->{{3.790110550094643*^9, 
  3.790110597585189*^9}},ExpressionUUID->"44223311-3a23-4bdf-bec0-\
45b787cb3ad4"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"{", 
   RowBox[{"plot1", ",", "plot2"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.786649316443194*^9, 3.786649321885936*^9}, 
   3.7866494889767923`*^9, {3.7901105156099777`*^9, 3.7901105444970713`*^9}},
 CellLabel->
  "In[265]:=",ExpressionUUID->"3d724e9d-5d01-467c-9b47-4558963b8f05"],

Cell["For J=4, the eigenvectors are independent of W and x.", "Text",
 CellChangeTimes->{{3.786649939910677*^9, 
  3.7866499732943707`*^9}},ExpressionUUID->"46ad4d26-d9cd-497b-b08c-\
13229acf8029"],

Cell[BoxData[
 RowBox[{
  RowBox[{"esys", "[", 
   RowBox[{"1", ",", "0.5"}], "]"}], "[", 
  RowBox[{"[", "2", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.786649508737336*^9, 3.786649552139881*^9}},
 CellLabel->
  "In[387]:=",ExpressionUUID->"6c78a36d-489d-433a-82f3-1e4d92faf908"],

Cell["\<\
It is not so easy to take out common factors that are multiplied by a4 and a6 \
to make them both have the same range. However, one can easily find the \
minimum and the maximum entries and divide by a number in between the two (or \
by the min or max to scale the spectrum). \
\>", "Text",
 CellChangeTimes->{{3.7901046417725277`*^9, 3.7901046774448633`*^9}, {
  3.790108469310094*^9, 
  3.790108519804667*^9}},ExpressionUUID->"8d847b42-d0a4-4881-a4fe-\
46d3aa345b27"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"Coefficient", "[", 
       RowBox[{"matcrA4A6", ",", "a4"}], "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"#", "\[NotEqual]", "0"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Min", "[", 
  RowBox[{"Abs", "[", "temp", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Max", "[", 
  RowBox[{"Abs", "[", "temp", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"Coefficient", "[", 
       RowBox[{"matcrA4A6", ",", "a6"}], "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"#", "\[NotEqual]", "0"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Min", "[", 
  RowBox[{"Abs", "[", "temp", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Max", "[", 
  RowBox[{"Abs", "[", "temp", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.790104683216284*^9, 3.7901048144051943`*^9}, {
   3.790104864829569*^9, 3.790105019805702*^9}, {3.790105107007256*^9, 
   3.7901051393099213`*^9}, {3.7901051895912933`*^9, 3.790105197269681*^9}, {
   3.79010830087741*^9, 3.790108302180215*^9}, {3.790108343669958*^9, 
   3.790108416780604*^9}, 
   3.7901086622384157`*^9},ExpressionUUID->"241418ca-1882-4cf6-a702-\
683e3d005bc3"]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Training data: ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["O", "h"], "=", 
    RowBox[{
     RowBox[{"m", "\\", "bar"}], 
     RowBox[{"{", "3", "}"}], "m"}]}], TraditionalForm]],ExpressionUUID->
  "1a7bd422-f04c-463d-b473-e1e35c916a1a"],
 " symmetry"
}], "Section",
 CellChangeTimes->{{3.7969237703461857`*^9, 3.796923781980577*^9}, {
  3.7969259622094307`*^9, 3.796925976376203*^9}, {3.798607651331588*^9, 
  3.7986078120744677`*^9}},ExpressionUUID->"86f40345-9a84-4b0c-b55a-\
eed63958a67a"],

Cell["\<\
There are two crystal field parameters {A[4,4], A[6,4]} = {W, x}, where -1 <= \
x <= 1. Here, W sets the band width of the crystal field spectrum (band width \
= approx. W/10) and x depends on the ratio of A[4,4] and A[6,4]. We thus draw \
two random numbers to set W and x. We express energies in Kelvin and thus \
draw W in the range 10 K - 300 K. This is a rough range of crystal field \
energies. \
\>", "Text",
 CellChangeTimes->{{3.796925985532331*^9, 3.796926119622555*^9}, {
  3.796926197131414*^9, 3.796926197190735*^9}, {3.796926606571512*^9, 
  3.79692660936616*^9}, {3.796932542201441*^9, 
  3.796932561977922*^9}},ExpressionUUID->"30f55759-10c3-4a8b-8e65-\
30e4b02f008c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"WMinVal", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WMaxVal", "=", "30"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"WVal", "=", 
  RowBox[{"RandomReal", "[", 
   RowBox[{"{", 
    RowBox[{"WMinVal", ",", "WMaxVal"}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"xVal", "=", 
  RowBox[{"RandomReal", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.7969265851578493`*^9, 3.796926651622409*^9}, {
  3.7969324850696917`*^9, 3.7969324856586533`*^9}, {3.796932566024177*^9, 
  3.796932574198258*^9}, {3.797410905134459*^9, 3.797410905933223*^9}},
 CellLabel->
  "In[105]:=",ExpressionUUID->"b67349fc-ade4-4baf-8b8f-762bd88f85ac"],

Cell[CellGroupData[{

Cell["Crystal field Hamiltonian ", "Subsection",
 CellChangeTimes->{{3.796923783849966*^9, 3.796923797869154*^9}, {
  3.7969239115297403`*^9, 3.7969239219126368`*^9}, {3.7969259726549997`*^9, 
  3.7969259796325693`*^9}},ExpressionUUID->"24eb721b-e39b-41e3-aab5-\
a754030f7e28"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Ohgroup", "=", 
   RowBox[{"GTInstallGroup", "[", 
    RowBox[{"Oh", ",", 
     RowBox[{"GOVerbose", "\[Rule]", "\"\<False\>\""}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.785269160622649*^9, {3.785269281480538*^9, 3.785269336414172*^9}, 
   3.786627168376821*^9, {3.796923821876587*^9, 3.796923822481081*^9}},
 CellLabel->
  "In[756]:=",ExpressionUUID->"2e57baf6-f970-4ad0-8f71-d868068ab8a3"],

Cell[BoxData[
 RowBox[{"vcr", "=", 
  RowBox[{"GTCrystalField", "[", 
   RowBox[{"Ohgroup", ",", "6"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.785269341649662*^9, 3.7852693624398003`*^9}, 
   3.796923935630218*^9, 3.797943202737104*^9},
 CellLabel->
  "In[757]:=",ExpressionUUID->"04b14a7b-1876-442a-8a30-c3ed730bcadb"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["Pr", 
      RowBox[{"3", "+"}]], " ", "has", " ", "ground", " ", "state", " ", 
     "term", " ", 
     SuperscriptBox[
      RowBox[{"symbol", " "}], "3"], 
     SubscriptBox["H", 
      RowBox[{"4", " "}]]}], 
    SuperscriptBox["=", 
     RowBox[{" ", 
      RowBox[{
       RowBox[{"2", "S"}], "+", "1"}]}]], 
    SubscriptBox["L", "J"]}], TraditionalForm]],ExpressionUUID->
  "0e9c9984-3936-4a74-8d7c-3d8c3e9b252c"],
 " corresponding to S=1, L=5, J=4. Pr 1-2-20 compounds have ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["T", 
    RowBox[{"d", " "}]], TraditionalForm]],ExpressionUUID->
  "2cd31fd1-c757-41f2-bf1a-fdc1319c9f71"],
 "symmetry, which has the same CEF expansion as ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["O", "h"], TraditionalForm]],ExpressionUUID->
  "1a450d1d-7322-4491-96a9-db04223def9f"],
 "."
}], "Text",
 CellChangeTimes->{{3.797091712406839*^9, 3.797091763734208*^9}, {
  3.797943739438446*^9, 
  3.797943774768508*^9}},ExpressionUUID->"850b6140-30c9-4406-b9bd-\
124362fdc1b1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"JVal", "=", 
   RowBox[{"9", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LVal", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SVal", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gJLS", "[", 
    RowBox[{"J_", ",", "L_", ",", "S_"}], "]"}], "=", 
   RowBox[{"1", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"J", "*", 
        RowBox[{"(", 
         RowBox[{"J", "+", "1"}], ")"}]}], "+", 
       RowBox[{"S", "*", 
        RowBox[{"(", 
         RowBox[{"S", "+", "1"}], ")"}]}], "-", 
       RowBox[{"L", "*", 
        RowBox[{"(", 
         RowBox[{"L", "+", "1"}], ")"}]}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"2", "*", "J", "*", 
       RowBox[{"(", 
        RowBox[{"J", "+", "1"}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gVal", "=", 
   RowBox[{"gJLS", "[", 
    RowBox[{"JVal", ",", "LVal", ",", "SVal"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.786640148438908*^9, 3.7866401487685127`*^9}, {
   3.7881950585497932`*^9, 3.788195058644024*^9}, {3.788195412637435*^9, 
   3.788195413708387*^9}, {3.788195886755945*^9, 3.78819588762637*^9}, {
   3.788196025865087*^9, 3.788196026015921*^9}, {3.796901445279166*^9, 
   3.7969014466723547`*^9}, 3.796901956860958*^9, {3.797091658869198*^9, 
   3.797091662472419*^9}, {3.7970917077388477`*^9, 3.797091710309637*^9}, {
   3.797096565075316*^9, 3.79709657248085*^9}, {3.799477890332165*^9, 
   3.799477892657547*^9}, {3.799477927729604*^9, 3.799477932929051*^9}, 
   3.799478447748801*^9, {3.799478493882468*^9, 3.799478533177297*^9}, {
   3.79948678280871*^9, 3.799486783860138*^9}, {3.799486952756455*^9, 
   3.799486953284433*^9}},
 CellLabel->
  "In[831]:=",ExpressionUUID->"47f0162e-7eac-4b39-97b7-3515ad0a5914"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{
    RowBox[{"vcr", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Y", "[", 
        RowBox[{"ll_", ",", "mm_"}], "]"}], "\[RuleDelayed]", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "*", "ll"}], "+", "1"}], ")"}], "/", "4"}], "/", 
          "Pi"}], "]"}], "*", 
        RowBox[{"GTBSTOperator", "[", 
         RowBox[{"ll", ",", "mm", ",", "JVal"}], "]"}]}]}], "}"}]}], "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{"temp", "/.", 
    RowBox[{
     RowBox[{"A", "[", 
      RowBox[{"0", ",", "0"}], "]"}], "\[Rule]", "0"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matcrBST", "=", 
   RowBox[{"temp", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"r", "\[Rule]", "1"}], ",", 
      RowBox[{
       RowBox[{"A", "[", 
        RowBox[{"4", ",", "4"}], "]"}], "\[Rule]", "a4"}], ",", 
      RowBox[{
       RowBox[{"A", "[", 
        RowBox[{"6", ",", "4"}], "]"}], "\[Rule]", "a6"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "MatrixForm"}], ";"}]}], "Input",
 CellChangeTimes->{{3.786627507720357*^9, 3.78662757792964*^9}, {
   3.7866277202481613`*^9, 3.786627735412421*^9}, {3.786627788623618*^9, 
   3.786627795672579*^9}, {3.786627923395748*^9, 3.786627953386715*^9}, {
   3.786628019298029*^9, 3.786628041536735*^9}, {3.786628426059493*^9, 
   3.786628461686534*^9}, {3.786628743577692*^9, 3.786628760372045*^9}, {
   3.7866400864895163`*^9, 3.78664015233587*^9}, {3.786640825633441*^9, 
   3.786640832701601*^9}, {3.786646996634104*^9, 3.786646999540801*^9}, {
   3.7866488342181587`*^9, 3.786648840252643*^9}, {3.7866491497723207`*^9, 
   3.786649155594781*^9}, {3.786649253814671*^9, 3.7866492654485893`*^9}, {
   3.7866494124688387`*^9, 3.786649414051375*^9}, {3.786649585012562*^9, 
   3.786649586039554*^9}, {3.78664990702824*^9, 3.786649915694008*^9}, {
   3.788195070645948*^9, 3.78819508183741*^9}, {3.7901104347783127`*^9, 
   3.7901104682891407`*^9}, {3.796657789537939*^9, 3.7966578185610228`*^9}, 
   3.7966578637771597`*^9, {3.796657927196455*^9, 3.796657936733631*^9}, {
   3.796658160029942*^9, 3.7966581781722927`*^9}, 3.796923929138701*^9, {
   3.799486828602312*^9, 3.799486872567977*^9}},
 CellLabel->
  "In[836]:=",ExpressionUUID->"2eb8093b-d183-47e7-b0c3-ec0923aebcd0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"matA4", "=", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"matcrBST", ",", "a4"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matA6", "=", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"matcrBST", ",", "a6"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"a4", "*", "matA4"}], "+", 
    RowBox[{"a6", "*", "matA6"}], "-", "matcrBST"}], "//", "FullSimplify"}], 
  ";"}]}], "Input",
 CellChangeTimes->{
  3.796658119511499*^9, {3.79665817602528*^9, 3.796658216521126*^9}, {
   3.796658250575593*^9, 3.7966583079603167`*^9}, {3.799486839968335*^9, 
   3.799486857400367*^9}},
 CellLabel->
  "In[841]:=",ExpressionUUID->"6d6eb012-3e61-4378-aecd-1d8475aa514e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"matA4Av", "=", 
   RowBox[{
    RowBox[{"Norm", "[", 
     RowBox[{"Eigenvalues", "[", "matA4", "]"}], "]"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", "*", "JVal"}], "+", "1"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matA6Av", "=", 
   RowBox[{
    RowBox[{"Norm", "[", 
     RowBox[{"Eigenvalues", "[", "matA6", "]"}], "]"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", "*", "JVal"}], "+", "1"}], ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7966583111783867`*^9, 3.7966583147590723`*^9}, 
   3.796658356374555*^9, {3.796658433420876*^9, 3.7966584633918657`*^9}, {
   3.796658496436825*^9, 3.796658532089654*^9}, {3.796659172254266*^9, 
   3.796659339374614*^9}, {3.796659474082996*^9, 3.7966595613539248`*^9}, {
   3.796659600789694*^9, 3.796659662278084*^9}, {3.796659906477929*^9, 
   3.796659961441085*^9}, {3.7966600937494097`*^9, 3.796660134489295*^9}, {
   3.796660720624673*^9, 3.7966607296844482`*^9}, {3.796896789760777*^9, 
   3.7968968102344*^9}, {3.7968969371331*^9, 3.796896954700213*^9}, {
   3.79689925287754*^9, 3.79689927695789*^9}, {3.796923959503933*^9, 
   3.796923978059507*^9}, {3.799486844578702*^9, 3.799486851429468*^9}},
 CellLabel->
  "In[844]:=",ExpressionUUID->"71cc245c-35c2-43bb-87a0-16ebfe0ab91d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ham", "[", "x_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"x", "*", 
      RowBox[{"matA4", "/", "matA4Av"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"Abs", "[", "x", "]"}]}], ")"}], "*", 
      RowBox[{"matA6", "/", "matA6Av"}]}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"esys", "[", "x_", "]"}], ":=", 
   RowBox[{"Eigensystem", "[", 
    RowBox[{"ham", "[", "x", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.7966583263578873`*^9, {3.796660148329115*^9, 3.796660226315435*^9}, {
   3.79666074479909*^9, 3.796660745715601*^9}, {3.796661377716734*^9, 
   3.796661382701233*^9}, {3.79666142451544*^9, 3.796661432398801*^9}, {
   3.796662295430895*^9, 3.796662300213688*^9}, {3.796751985414648*^9, 
   3.796752008164106*^9}, 3.796901486293532*^9, {3.796924038670122*^9, 
   3.796924075190193*^9}, {3.79692411708181*^9, 3.7969241575137587`*^9}, {
   3.7970132179759903`*^9, 3.797013226320665*^9}, 3.79701326487462*^9, {
   3.797082603763859*^9, 3.797082630982724*^9}, 3.797096202274786*^9, {
   3.799486822991398*^9, 3.7994868252964687`*^9}},
 CellLabel->
  "In[846]:=",ExpressionUUID->"4018c797-0f0e-41ed-b5b0-1e6f2c73f1c9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ham", "[", "1.", "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.797277952738563*^9, 3.797277964885384*^9}, 
   3.79735746132434*^9, {3.797861303191547*^9, 3.797861304822616*^9}},
 CellLabel->
  "In[849]:=",ExpressionUUID->"df212735-f391-461d-943e-26c4b2df4626"],

Cell[TextData[{
 "Define angular momentum operators ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["J", "x"], ",", 
     SubscriptBox["J", "y"], ",", 
     SubscriptBox["J", "z"]}], "}"}], TraditionalForm]],ExpressionUUID->
  "7742d779-44d8-4c37-b9c5-c29e0152b64b"]
}], "Text",
 CellChangeTimes->{{3.797063047872074*^9, 
  3.797063089681067*^9}},ExpressionUUID->"be023d4b-db9b-4cfa-8d54-\
4ce11da5f624"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"JzOp", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "JVal"}], "+", "idx"}], ",", 
      RowBox[{"{", 
       RowBox[{"idx", ",", "0", ",", 
        RowBox[{"2", "*", "JVal"}]}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JPlusOp", "=", 
   RowBox[{
    RowBox[{"SparseArray", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i_", ",", "j_"}], "}"}], "\[Rule]", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"JVal", "-", 
             RowBox[{"(", 
              RowBox[{"j", "-", "JVal", "-", "1"}], ")"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"JVal", "+", 
             RowBox[{"(", 
              RowBox[{"j", "-", "JVal", "-", "1"}], ")"}], "+", "1"}], 
            ")"}]}], "]"}], "*", 
         RowBox[{"KroneckerDelta", "[", 
          RowBox[{"j", ",", 
           RowBox[{"i", "-", "1"}]}], "]"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"2", "*", "JVal"}], "+", "1"}], ",", 
        RowBox[{
         RowBox[{"2", "*", "JVal"}], "+", "1"}]}], "}"}]}], "]"}], "//", 
    "Normal"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JMinusOp", "=", 
   RowBox[{
    RowBox[{"SparseArray", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i_", ",", "j_"}], "}"}], "\[Rule]", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"JVal", "+", 
             RowBox[{"(", 
              RowBox[{"j", "-", "JVal", "-", "1"}], ")"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"JVal", "-", 
             RowBox[{"(", 
              RowBox[{"j", "-", "JVal", "-", "1"}], ")"}], "+", "1"}], 
            ")"}]}], "]"}], "*", 
         RowBox[{"KroneckerDelta", "[", 
          RowBox[{"j", ",", 
           RowBox[{"i", "+", "1"}]}], "]"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"2", "*", "JVal"}], "+", "1"}], ",", 
        RowBox[{
         RowBox[{"2", "*", "JVal"}], "+", "1"}]}], "}"}]}], "]"}], "//", 
    "Normal"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JxOp", "=", 
   RowBox[{
    RowBox[{"1", "/", "2"}], "*", 
    RowBox[{"(", 
     RowBox[{"JPlusOp", "+", "JMinusOp"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JyOp", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "I"}], "/", "2"}], "*", 
    RowBox[{"(", 
     RowBox[{"JPlusOp", "-", "JMinusOp"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "MatrixForm"}], ";"}]}], "Input",
 CellChangeTimes->{
  3.79706309060163*^9, {3.797081490499408*^9, 3.7970816121726933`*^9}, {
   3.797081644065496*^9, 3.7970817508956003`*^9}, {3.797081786592037*^9, 
   3.7970817867899933`*^9}, {3.797081837142178*^9, 3.797081906365307*^9}, {
   3.79708193846343*^9, 3.797081971038479*^9}, {3.797082009835897*^9, 
   3.797082019208625*^9}, {3.7970821041566267`*^9, 3.79708211382547*^9}, {
   3.7970821864704103`*^9, 3.797082230634911*^9}, {3.7970822804937677`*^9, 
   3.797082319503413*^9}, {3.797082350443152*^9, 3.7970823683330393`*^9}, {
   3.797083430702883*^9, 3.797083432264896*^9}, {3.7970834747621927`*^9, 
   3.7970834985768623`*^9}, {3.7970835384383097`*^9, 3.797083552233288*^9}, {
   3.797083631461594*^9, 3.797083634285095*^9}, {3.797083684548766*^9, 
   3.797083688237508*^9}, {3.797083756929514*^9, 3.7970837859396267`*^9}, {
   3.7970838493885803`*^9, 3.7970838549695253`*^9}, {3.797185571480345*^9, 
   3.797185584783328*^9}, {3.797186829423081*^9, 3.797186848397798*^9}, {
   3.7978614682639027`*^9, 3.797861473184061*^9}, {3.799477954399212*^9, 
   3.7994779548498077`*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"85e3d053-5979-4abf-85d6-aa5501cdf7d0"],

Cell[TextData[{
 "Check that my definition of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["J", "z"], TraditionalForm]],ExpressionUUID->
  "54780431-70ac-45e5-b1c4-97dc8d2d0f58"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["J", "+"], ",", " ", 
    SubscriptBox["J", "-"]}], TraditionalForm]],ExpressionUUID->
  "61192757-138d-41ea-b29c-5bdbb324a4ba"],
 " agrees with GTBST convention. Note that the order of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["m", "J"], TraditionalForm]],ExpressionUUID->
  "899ffbd1-1398-4f02-ac06-eee10479d061"],
 " states is {-J, -J+1, ..., J}. Some BST operators in terms of the angular \
momentum operators are defined in Table 7.1 on page 166 of Hergert (HG) book. "
}], "Text",
 CellChangeTimes->{{3.7970893060262823`*^9, 
  3.797089420911922*^9}},ExpressionUUID->"95ab0dd5-0639-439e-95bf-\
2cc13d73c305"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GTBSTOperator", "[", 
    RowBox[{"6", ",", "4", ",", "JVal"}], "]"}], "//", "MatrixForm"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{"63", "/", "512"}], "]"}], "*", 
     RowBox[{"1", "/", "2"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"11", "*", 
           RowBox[{"JzOp", ".", "JzOp"}]}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"JVal", "*", 
              RowBox[{"(", 
               RowBox[{"JVal", "+", "1"}], ")"}]}], "+", "38"}], ")"}], "*", 
           RowBox[{"IdentityMatrix", "[", 
            RowBox[{
             RowBox[{"2", "*", "JVal"}], "+", "1"}], "]"}]}]}], ")"}], ".", 
        "JPlusOp", ".", "JPlusOp", ".", "JPlusOp", ".", "JPlusOp"}], "+", 
       RowBox[{"JPlusOp", ".", "JPlusOp", ".", "JPlusOp", ".", "JPlusOp", ".", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"11", "*", 
           RowBox[{"JzOp", ".", "JzOp"}]}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"JVal", "*", 
              RowBox[{"(", 
               RowBox[{"JVal", "+", "1"}], ")"}]}], "+", "38"}], ")"}], "*", 
           RowBox[{"IdentityMatrix", "[", 
            RowBox[{
             RowBox[{"2", "*", "JVal"}], "+", "1"}], "]"}]}]}], ")"}]}]}], 
      ")"}]}], "//", "MatrixForm"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GTBSTOperator", "[", 
    RowBox[{"4", ",", "4", ",", "JVal"}], "]"}], "//", "MatrixForm"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Sqrt", "[", 
     RowBox[{"35", "/", "128"}], "]"}], "*", 
    RowBox[{"JPlusOp", ".", "JPlusOp", ".", "JPlusOp", ".", "JPlusOp"}]}], "//",
    "MatrixForm"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7970833405852623`*^9, 3.797083400984365*^9}, {
  3.797083860634185*^9, 3.797083889230492*^9}, {3.7970889334720573`*^9, 
  3.797089100726942*^9}, {3.7970892923594303`*^9, 3.797089304700452*^9}, {
  3.7970921488884277`*^9, 3.7970922240215063`*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"26ddbd90-7f55-43a3-bbd2-33a5d953db37"],

Cell[BoxData[
 RowBox[{"StringReplace", "[", 
  RowBox[{
   RowBox[{"ToString", "[", 
    RowBox[{"N", "[", "JVal", "]"}], "]"}], ",", 
   RowBox[{
    RowBox[{"Shortest", "[", 
     RowBox[{"i__", "~~", "\"\<.\>\"", "~~", "j__"}], "]"}], "\[Rule]", 
    RowBox[{"i", "~~", "\"\<_\>\"", "~~", "j"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.79947804206479*^9, 3.7994781376657867`*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"7727067c-1360-485c-b9f2-790a8b8e1a4b"],

Cell["\<\
Define function that converts Mathematica expression into Python string\
\>", "Text",
 CellChangeTimes->{{3.7974109631463003`*^9, 
  3.7974109849172993`*^9}},ExpressionUUID->"09d435c6-bf67-4797-98ed-\
e5bc1d38c012"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ConvertToPyString", "[", "sstr_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"str", "=", "sstr"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"str", "=", 
      RowBox[{"Expand", "[", 
       RowBox[{"Simplify", "[", "str", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"str", "=", 
      RowBox[{"N", "[", "str", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"str", "=", 
      RowBox[{"ToString", "[", 
       RowBox[{"str", ",", "FortranForm"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"str", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"str", ",", 
        RowBox[{
         RowBox[{"Shortest", "[", 
          RowBox[{"\"\<Sqrt(\>\"", "~~", "i__", "~~", "\"\<)\>\""}], "]"}], 
         "\[Rule]", 
         RowBox[{"\"\<np.sqrt(\>\"", "~~", "i", "~~", "\"\<)\>\""}]}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"str", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"str", ",", 
        RowBox[{
         RowBox[{"Shortest", "[", 
          RowBox[{"\"\<Abs(\>\"", "~~", "i__", "~~", "\"\<)\>\""}], "]"}], 
         "\[Rule]", 
         RowBox[{"\"\<np.abs(\>\"", "~~", "i", "~~", "\"\<)\>\""}]}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", "str"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.797261935202834*^9, 3.797261982709478*^9}, {
   3.797262013965489*^9, 3.797262051348982*^9}, {3.797262335959133*^9, 
   3.7972623815014544`*^9}, 3.797262427221718*^9, {3.797266888096942*^9, 
   3.797267015952709*^9}, {3.7972671843860807`*^9, 3.797267196986126*^9}, {
   3.797270231651085*^9, 3.797270236074506*^9}, {3.797270292842783*^9, 
   3.797270580170759*^9}, {3.797272912045128*^9, 3.797272917523796*^9}, {
   3.7972729920677567`*^9, 3.79727318620399*^9}, 3.797273315333137*^9, {
   3.797273475335691*^9, 3.797273524621703*^9}, {3.797273559862084*^9, 
   3.797273569452402*^9}, {3.797273681508535*^9, 3.797273702828506*^9}, 
   3.7972739801683903`*^9, {3.797275761596661*^9, 3.797275780915831*^9}, {
   3.797275844940381*^9, 3.7972758450919313`*^9}, {3.797275941580229*^9, 
   3.7972759705243587`*^9}, {3.797276010244479*^9, 3.797276038684608*^9}, {
   3.7972762116527452`*^9, 3.797276229996397*^9}, {3.797276262476548*^9, 
   3.797276273428364*^9}, {3.797276486085189*^9, 3.797276495173934*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"e50cca83-c1b7-4285-a08f-55a87b80e864"],

Cell["\<\
Write python module file that sets up expression of crystal field matrix\
\>", "Text",
 CellChangeTimes->{{3.797410989418001*^9, 
  3.797411025541195*^9}},ExpressionUUID->"f23043ab-4569-4b66-a489-\
c56d42c53d3b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"outdir", "=", 
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Input_ham_cr/\>\""}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"strm", "=", 
     RowBox[{"OpenWrite", "[", 
      RowBox[{"outdir", "<>", "\"\<ham_cr.py\>\""}], "]"}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"strm", "=", 
    RowBox[{"OpenAppend", "[", 
     RowBox[{"outdir", "<>", "\"\<ham_cr.py\>\""}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"strm", ",", 
    RowBox[{"FormatType", "\[Rule]", "OutputForm"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetOptions", "[", 
    RowBox[{"strm", ",", 
     RowBox[{"PageWidth", "\[Rule]", "Infinity"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pointGroup", "=", "\"\<Oh\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"varsString", "=", 
    RowBox[{"{", 
     RowBox[{"\"\<x0\>\"", ",", "\"\<x1\>\""}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Write", "[", 
   RowBox[{"strm", ",", 
    RowBox[{
    "\"\<# Module creates crystal field Hamiltonian matrix for point group \
(PG) Oh and J = \>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{"N", "[", "JVal", "]"}], "]"}], "<>", 
     "\"\<.\\n# Number of crystal field variables is 2: {x0, x1}.\>\""}]}], 
   "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Write", "[", 
    RowBox[{"strm", ",", "\"\<import numpy as np\>\""}], "]"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Write", "[", 
  RowBox[{"strm", ",", " ", 
   RowBox[{
   "\"\<def ham_cr_PG_\>\"", "<>", "pointGroup", "<>", "\"\<_J_\>\"", "<>", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"ToString", "[", 
       RowBox[{"N", "[", "JVal", "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"Shortest", "[", 
        RowBox[{"i__", "~~", "\"\<.\>\"", "~~", "j__"}], "]"}], "\[Rule]", 
       RowBox[{"i", "~~", "\"\<_\>\"", "~~", "j"}]}]}], "]"}], "<>", 
    "\"\<(\>\"", "<>", 
    RowBox[{"varsString", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "<>", "\"\<, \>\"", "<>", 
    RowBox[{"varsString", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "<>", "\"\<):\>\""}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Write", "[", 
   RowBox[{"strm", ",", 
    RowBox[{"\"\<\\t\>\"", "<>", "\"\<J = \>\"", "<>", " ", 
     RowBox[{"ToString", "[", 
      RowBox[{"N", "[", "JVal", "]"}], "]"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Write", "[", 
   RowBox[{"strm", ",", 
    RowBox[{"\"\<\\t\>\"", "<>", "\"\<dim=int(2*J+1)\>\""}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Write", "[", 
   RowBox[{"strm", ",", 
    RowBox[{
    "\"\<\\t\>\"", "<>", 
     "\"\<ham = np.arange(dim*dim, dtype=np.float)\>\""}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Write", "[", 
   RowBox[{"strm", ",", 
    RowBox[{"\"\<\\t\>\"", "<>", "\"\<ham = ham.reshape(dim,dim)\>\""}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"idx", "=", "0"}], ",", 
   RowBox[{"idx", "<", 
    RowBox[{"Length", "[", 
     RowBox[{"ham", "[", "x", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"jdx", "=", "0"}], ",", 
      RowBox[{"jdx", "<", 
       RowBox[{"Length", "[", 
        RowBox[{"ham", "[", "x", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tmp", "=", 
        RowBox[{"ConvertToPyString", "[", 
         RowBox[{"x0", "*", 
          RowBox[{
           RowBox[{"ham", "[", "x1", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"idx", "+", "1"}], ",", 
             RowBox[{"jdx", "+", "1"}]}], "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Write", "[", 
        RowBox[{"strm", ",", 
         RowBox[{"\"\<\\t\>\"", "<>", "\"\<ham[\>\"", "<>", 
          RowBox[{"ToString", "[", "idx", "]"}], "<>", "\"\<][\>\"", "<>", 
          RowBox[{"ToString", "[", "jdx", "]"}], "<>", "\"\<] = \>\"", "<>", 
          "tmp"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"jdx", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"idx", "++"}], ";"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Write", "[", 
    RowBox[{"strm", ",", 
     RowBox[{"\"\<\\t\>\"", "<>", "\"\<return ham\>\""}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", " ", "[", 
     RowBox[{
      RowBox[{"index", "=", "1"}], ",", 
      RowBox[{"index", "\[LessEqual]", 
       RowBox[{"Length", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{"ham", "[", "x", "]"}], "]"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"label", " ", "=", " ", 
        RowBox[{"\"\<# Element \>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"index", " ", "-", " ", "1"}], "]"}], " ", "<>", 
         "\"\<\\n\>\""}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{
         RowBox[{"ConvertToPyString", "[", 
          RowBox[{"W", "*", 
           RowBox[{"ham", "[", "x", "]"}]}], "]"}], "\"\<\\n\>\""}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Write", "[", 
        RowBox[{"strm", ",", " ", "label"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Write", "[", 
        RowBox[{"strm", ",", " ", "tmp"}], "]"}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"index", "++"}]}]}], "\[IndentingNewLine]", "]"}], ";"}], 
   "\[IndentingNewLine]", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Close", "[", "strm", "]"}]}], "Input",
 CellChangeTimes->{{3.797261935202834*^9, 3.797261982709478*^9}, {
   3.797262013965489*^9, 3.797262051348982*^9}, {3.797262335959133*^9, 
   3.7972623815014544`*^9}, 3.797262427221718*^9, {3.797266888096942*^9, 
   3.797267015952709*^9}, {3.7972671843860807`*^9, 3.797267196986126*^9}, {
   3.797270231651085*^9, 3.797270236074506*^9}, {3.797270292842783*^9, 
   3.797270580170759*^9}, {3.797272912045128*^9, 3.797272917523796*^9}, {
   3.7972729920677567`*^9, 3.79727318620399*^9}, 3.797273315333137*^9, {
   3.797273475335691*^9, 3.797273524621703*^9}, {3.797273559862084*^9, 
   3.797273569452402*^9}, {3.797273681508535*^9, 3.797273702828506*^9}, 
   3.7972739801683903`*^9, 3.7972740463108187`*^9, {3.797274082205628*^9, 
   3.797274124732308*^9}, {3.7972741647722883`*^9, 3.797274203885873*^9}, {
   3.797274283221828*^9, 3.7972743047964287`*^9}, {3.7972743678766317`*^9, 
   3.79727437209227*^9}, {3.797274502044259*^9, 3.797274765276348*^9}, {
   3.7972749534688063`*^9, 3.7972749750917997`*^9}, {3.7972751965084352`*^9, 
   3.797275262893379*^9}, {3.7972753702688007`*^9, 3.797275380468472*^9}, 
   3.797275755293952*^9, {3.797276355982937*^9, 3.797276396637413*^9}, {
   3.797276542686059*^9, 3.797276572213047*^9}, {3.797276979701881*^9, 
   3.797277077452806*^9}, {3.797277425470429*^9, 3.797277427708932*^9}, {
   3.797277531934023*^9, 3.797277577164948*^9}, {3.797277659094515*^9, 
   3.797277681141062*^9}, {3.79727781107787*^9, 3.7972778907410107`*^9}, {
   3.797278024198574*^9, 3.797278031765902*^9}, {3.797278091061487*^9, 
   3.7972780914453983`*^9}, {3.7974464682023087`*^9, 
   3.7974465001163473`*^9}, {3.797446545036593*^9, 3.797446545924204*^9}, {
   3.799477988514586*^9, 3.7994779918424683`*^9}, {3.7994781452228203`*^9, 
   3.7994782085713787`*^9}, {3.799478260309897*^9, 3.799478261302959*^9}, {
   3.799478414495525*^9, 3.799478417355886*^9}, {3.799478481387685*^9, 
   3.799478484595398*^9}, {3.799485013074031*^9, 3.799485014872113*^9}, {
   3.7994867731624203`*^9, 3.79948677612311*^9}},
 CellLabel->
  "In[850]:=",ExpressionUUID->"83516c46-f2b5-4d93-b875-6628579d1543"],

Cell["\<\
Energy spectrum as a function of crystal field parameter x (setting W = 1).\
\>", "Text",
 CellChangeTimes->{{3.7974110323239393`*^9, 
  3.797411051605345*^9}},ExpressionUUID->"24a0df4a-bb3f-436a-adf8-\
fb315d303b15"],

Cell[BoxData[
 RowBox[{"plot1", "=", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"Sort", "[", 
     RowBox[{
      RowBox[{"esys", "[", "x", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<E/W\>\"", ",", "\"\<\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<x\>\"", ",", "\"\<\>\""}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"Directive", "[", "Blue", "]"}]}], ",", " ", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"Thickness", "[", "0.0025", "]"}], ",", 
       RowBox[{"FontSize", "\[Rule]", "14"}], ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.796660288131609*^9, 3.796660308531536*^9}, {
  3.796660375760756*^9, 3.796660383352623*^9}, {3.7967502105470667`*^9, 
  3.7967502377208014`*^9}, {3.796750381125403*^9, 3.796750426440358*^9}, {
  3.7967504619482527`*^9, 3.7967505605332336`*^9}, {3.7967506415632267`*^9, 
  3.796750642344624*^9}, {3.796901500735393*^9, 3.796901502349043*^9}, {
  3.796923661767095*^9, 3.7969236636434717`*^9}, {3.796924078244068*^9, 
  3.796924092974341*^9}},
 CellLabel->
  "In[162]:=",ExpressionUUID->"dd3efdaf-7d7c-4cdd-b8a7-b7321f6e44eb"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{
    "\"\<../Notes_Peter/Graphics/Energies-J_4-B_0-BST.pdf\>\"", ",", " ", 
     "plot1"}], "]"}]}], "\[IndentingNewLine]", "*)"}]], "Input",
 CellChangeTimes->{{3.797169660485691*^9, 3.797169733261634*^9}},
 CellLabel->
  "In[163]:=",ExpressionUUID->"1efeba03-4185-4ba0-9516-da3f6acc4ce5"],

Cell["\<\
For a random choice of W and x we find the level spectrum and associated \
partition function (at B=0). Find numerical eigenvalues (with lowest one set \
to zero) and eigenstates for that W and x: called energies and evecs.\
\>", "Text",
 CellChangeTimes->{{3.7970827426845922`*^9, 3.797082783840917*^9}, {
  3.797082978577118*^9, 
  3.797083019581115*^9}},ExpressionUUID->"29d8fce6-b9ea-44d7-b2ee-\
ad28ced3e224"],

Cell[BoxData[{
 RowBox[{"WVal", "=", "4.25"}], "\[IndentingNewLine]", 
 RowBox[{"xVal", "=", 
  RowBox[{"-", "0.32", 
   RowBox[{"(*", 
    RowBox[{"-", "0.32"}], "*)"}]}]}]}], "Input",
 CellChangeTimes->{{3.797357491852181*^9, 3.7973574991633577`*^9}, {
  3.797357578731799*^9, 3.797357586611557*^9}, {3.797411058838107*^9, 
  3.797411061429859*^9}, {3.797439002077861*^9, 3.797439007365304*^9}, {
  3.797861328039669*^9, 3.797861331254691*^9}, {3.797861489911742*^9, 
  3.797861490782529*^9}, {3.797861524535771*^9, 3.7978615280465393`*^9}, {
  3.7978615591675158`*^9, 3.7978615829986134`*^9}, {3.797862430503572*^9, 
  3.797862510423088*^9}, {3.7978726615536633`*^9, 3.797872664207889*^9}, {
  3.797872887009087*^9, 3.797872896825186*^9}, {3.797872971769289*^9, 
  3.79787298718382*^9}, {3.797875873075204*^9, 3.79787587407414*^9}, {
  3.797878353266358*^9, 3.797878381384943*^9}, {3.797882434485785*^9, 
  3.797882439012787*^9}},
 CellLabel->
  "In[164]:=",ExpressionUUID->"63ec70f2-7af0-4d8c-9f6e-b5f2d6a04fc6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{"WVal", "*", 
    RowBox[{
     RowBox[{"esys", "[", "xVal", "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"energies", "=", 
   RowBox[{"temp", "-", 
    RowBox[{"Min", "[", "temp", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"evecs", "=", 
   RowBox[{
    RowBox[{"esys", "[", "xVal", "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Zcr", "[", "Temp_", "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"energies", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "/", "Temp"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "energies", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.797082819112352*^9, 3.79708281928535*^9}, {
   3.797082934987808*^9, 3.797082967965996*^9}, {3.797083051134324*^9, 
   3.797083055826861*^9}, 3.7970960250450373`*^9, {3.797096110974231*^9, 
   3.797096112653965*^9}},
 CellLabel->
  "In[166]:=",ExpressionUUID->"6122f8b9-408b-4a3f-a98c-5e140ad66e76"],

Cell[BoxData[
 RowBox[{"plot1", "=", 
  RowBox[{"ListPlot", "[", 
   RowBox[{
    RowBox[{"Sort", "[", "energies", "]"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "10"}], "}"}], ",", "Automatic"}], "}"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.796932106125465*^9, 3.7969321211145697`*^9}, {
  3.7969323689530487`*^9, 3.79693246184328*^9}, {3.797082708844481*^9, 
  3.797082715042218*^9}, {3.797169922681107*^9, 3.7971699233440723`*^9}},
 CellLabel->
  "In[170]:=",ExpressionUUID->"7f5a2018-3955-40e9-af99-57d14b491eae"],

Cell["Magnetic Jz expectation values of the different levels", "Text",
 CellChangeTimes->{{3.797096529184803*^9, 
  3.797096544645657*^9}},ExpressionUUID->"36cb6760-da0b-4efe-b90b-\
82fec91ad3e2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"WVal", "*", 
    RowBox[{
     RowBox[{"esys", "[", "xVal", "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "-", 
   RowBox[{"Min", "[", 
    RowBox[{"WVal", "*", 
     RowBox[{
      RowBox[{"esys", "[", "xVal", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "//", 
  "Chop"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Conjugate", "[", 
      RowBox[{"Normalize", "[", 
       RowBox[{
        RowBox[{"esys", "[", "xVal", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "i"}], "]"}], "]"}], "]"}], "]"}], ".", "JzOp", 
     ".", 
     RowBox[{"Normalize", "[", 
      RowBox[{
       RowBox[{"esys", "[", "xVal", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "i"}], "]"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{
       RowBox[{"2", "*", "JVal"}], "+", "1"}]}], "}"}]}], "]"}], "//", 
  "Chop"}]}], "Input",
 CellChangeTimes->{{3.797093190611351*^9, 3.7970932180792503`*^9}, {
  3.797093253296327*^9, 3.797093316758301*^9}, {3.797096524906625*^9, 
  3.797096525653751*^9}, {3.7978613532720337`*^9, 3.7978613539831057`*^9}, {
  3.7978614174962378`*^9, 3.797861427199119*^9}, {3.797861597311604*^9, 
  3.79786159810277*^9}, {3.797861769928259*^9, 3.7978617744066133`*^9}, {
  3.797861854400024*^9, 3.797861867846881*^9}},
 CellLabel->
  "In[171]:=",ExpressionUUID->"de0ea3f8-2690-44f3-9a4b-461cc2e35c40"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"WVal", "*", 
    RowBox[{
     RowBox[{"esys", "[", "xVal", "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "-", 
   RowBox[{"Min", "[", 
    RowBox[{"WVal", "*", 
     RowBox[{
      RowBox[{"esys", "[", "xVal", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "//", 
  "Chop"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"esys", "[", "xVal", "]"}], "[", 
  RowBox[{"[", 
   RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.797861879543489*^9, 3.797861948254446*^9}},
 CellLabel->
  "In[173]:=",ExpressionUUID->"71cb9c34-8801-4571-84ab-f2bdb01e8a43"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Specific heat", "Subsection",
 CellChangeTimes->{
  3.7969240324035873`*^9, {3.796924410869841*^9, 3.7969244150530243`*^9}, {
   3.796925959211782*^9, 
   3.796925960854185*^9}},ExpressionUUID->"101b3432-38c6-4cf5-81ab-\
5fc6ddb28077"],

Cell["\<\
Specific heat cV/kB. Enter energies and Temperature (Temp) in Kelvin. \
\>", "Text",
 CellChangeTimes->{{3.7969311498218527`*^9, 
  3.796931198623749*^9}},ExpressionUUID->"b583c3fd-698c-42ac-996a-\
6190aae6004f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"cVOverkB", "[", "Temp_", "]"}], ":=", 
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"Temp", "^", "2"}]}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"1", "/", 
        RowBox[{"Zcr", "[", "Temp", "]"}]}], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"energies", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "^", "2"}], "*", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"energies", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "/", "Temp"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "energies", "]"}]}], "}"}]}], "]"}]}], "-", 
      
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{"Zcr", "[", "Temp", "]"}]}], "*", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"energies", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "*", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"energies", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "/", "Temp"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "energies", "]"}]}], "}"}]}], "]"}]}], 
        ")"}], "^", "2"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.796926979792131*^9, 3.7969271048098993`*^9}, 
   3.796931147117601*^9, {3.7969311823582697`*^9, 3.7969311824794207`*^9}, {
   3.7969312126058826`*^9, 3.7969312172307367`*^9}, {3.796931258023196*^9, 
   3.7969313150286703`*^9}, {3.7969329721765747`*^9, 3.79693298676687*^9}, {
   3.797026627954834*^9, 3.7970266291532927`*^9}, {3.797082599131392*^9, 
   3.7970826000070353`*^9}, {3.7970828249944696`*^9, 3.7970828303844757`*^9}, 
   3.797096038077091*^9},
 CellLabel->
  "In[175]:=",ExpressionUUID->"3018019f-471c-432b-b260-97364df61dbb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Quiet", "[", 
   RowBox[{"maxy", "=", 
    RowBox[{
     RowBox[{"FindMaxValue", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"cVOverkB", "[", "Temp", "]"}], ",", 
         RowBox[{
          RowBox[{"Temp", ">", "0"}], "&&", 
          RowBox[{"Temp", "<", "300"}]}]}], "}"}], ",", 
       RowBox[{"{", "Temp", "}"}]}], "]"}], "*", "1.1"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GapAboveGSVal", "=", 
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Sort", "[", "energies", "]"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "-", 
         RowBox[{
          RowBox[{"Sort", "[", "energies", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{
           RowBox[{"Length", "[", "energies", "]"}], "-", "1"}]}], "}"}]}], 
       "]"}], ",", 
      RowBox[{
       RowBox[{"#", ">", "0"}], "&"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lineGapAboveGS", "=", 
   RowBox[{"Line", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"GapAboveGSVal", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"GapAboveGSVal", ",", "maxy"}], "}"}]}], "}"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.79706244662847*^9, 3.7970625220042973`*^9}, {
   3.797062558115399*^9, 3.7970625824583797`*^9}, 3.797062798717841*^9, {
   3.797062834719076*^9, 3.797062942118616*^9}, 3.797082837003025*^9},
 CellLabel->
  "In[176]:=",ExpressionUUID->"23e1b422-6204-452e-bf35-5e0cbc225054"],

Cell[BoxData[
 RowBox[{"plot1", "=", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"cVOverkB", "[", "Temp", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"Temp", ",", "1", ",", "300"}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(c\), \(V\)]\)/\!\(\*SubscriptBox[\(k\), \(B\
\)]\) (dimensionless)\>\"", ",", "\"\<\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<T (Kelvin)\>\"", ",", "\"\<\>\""}], "}"}]}], "}"}]}], 
    ",", 
    RowBox[{"Epilog", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{"Dashed", ",", " ", "Red"}], "]"}], ",", "lineGapAboveGS"}], 
      "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"Thickness", "[", "0.0025", "]"}], ",", 
       RowBox[{"FontSize", "\[Rule]", "14"}], ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.796931219243614*^9, 3.796931228437479*^9}, {
  3.796931770546015*^9, 3.796931802507873*^9}, {3.7969330051706953`*^9, 
  3.796933009185679*^9}, {3.797026633860376*^9, 3.797026664080826*^9}, {
  3.79702670858775*^9, 3.797026717364566*^9}, {3.797062588394966*^9, 
  3.797062659604664*^9}, {3.797062945438847*^9, 3.797062956104608*^9}, {
  3.797062986583458*^9, 3.797062994271462*^9}, {3.797169876368163*^9, 
  3.797169876806964*^9}, {3.7971747331118717`*^9, 3.79717473876569*^9}, {
  3.797174773160492*^9, 3.797174773989563*^9}, {3.79717499330341*^9, 
  3.797175038902234*^9}, {3.797175308007824*^9, 3.79717531383041*^9}},
 CellLabel->
  "In[179]:=",ExpressionUUID->"0d576976-de2e-4fe5-8326-551add2d64b0"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"\"\<../Notes_Peter/Graphics/cV-J_4-W_\>\"", "~~", 
      RowBox[{"ToString", "[", "WVal", "]"}], "~~", "\"\<-x_\>\"", "~~", 
      RowBox[{"ToString", "[", "xVal", "]"}], "~~", "\"\<.pdf\>\""}], ",", 
     " ", "plot1"}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.7971697910121307`*^9, 3.797169844877747*^9}, 
   3.7971698870628843`*^9, {3.797357639316393*^9, 3.797357641047388*^9}},
 CellLabel->
  "In[180]:=",ExpressionUUID->"d1d6f116-d5ab-4ed6-80d9-585ba0d14d48"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Magnetization in finite magnetic field and magnetic susceptibility\
\>", "Subsection",
 CellChangeTimes->{{3.79709104619378*^9, 3.797091063478002*^9}, {
  3.797102375276865*^9, 
  3.797102396139666*^9}},ExpressionUUID->"bde64d0f-869b-4c7c-b40d-\
eb16a1d992b7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Entity", "[", 
    RowBox[{"\"\<PhysicalConstant\>\"", ",", "\"\<BoltzmannConstant\>\""}], 
    "]"}], "[", "\"\<Value\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Entity", "[", 
    RowBox[{"\"\<PhysicalConstant\>\"", ",", "\"\<BohrMagneton\>\""}], "]"}], 
   "[", "\"\<Value\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/", "%%"}], ";"}]}], "Input",
 CellChangeTimes->{
  3.797091130674865*^9, {3.79709150239548*^9, 3.797091584189026*^9}, {
   3.79709181325438*^9, 3.797091817539772*^9}, {3.797092026755538*^9, 
   3.797092032995563*^9}, {3.797169753667864*^9, 3.7971697573468933`*^9}},
 CellLabel->
  "In[181]:=",ExpressionUUID->"e1f86394-44e1-492d-bc06-8f88ba4eaef8"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"263", "/", "6.51"}]}]], "Input",
 CellChangeTimes->{{3.797101918185444*^9, 3.7971019417999773`*^9}, 
   3.7971020149791813`*^9},
 CellLabel->
  "In[184]:=",ExpressionUUID->"9276c180-8308-48c9-8330-ac940e6aa914"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"kBVal", "=", 
     FractionBox["1380649", "100000000000000000000000000000"]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "\[Mu]BVal", "=", 
     "9.2740100783000004424165405042207403`9.219079536512577*^-24"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"\[Mu]BVal", "/", "kBVal"}]}]}]], "Input",
 CellChangeTimes->{{3.797092038757635*^9, 3.7970920615092897`*^9}},
 CellLabel->
  "In[185]:=",ExpressionUUID->"4368b146-7dd0-411d-a617-49f229e812b7"],

Cell[CellGroupData[{

Cell["Magnetic field along z", "Subsubsection",
 CellChangeTimes->{{3.797091867319274*^9, 
  3.797091881074354*^9}},ExpressionUUID->"314ab424-b2f6-4ffe-80c1-\
cd11939d9bbe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"hamB", "[", 
    RowBox[{"Bfield_", ",", "W_", ",", "x_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"W", "*", 
      RowBox[{"ham", "[", "x", "]"}]}], "-", 
     RowBox[{
      RowBox[{"gJLS", "[", 
       RowBox[{"JVal", ",", "LVal", ",", "SVal"}], "]"}], "*", 
      RowBox[{"\[Mu]BVal", "/", "kBVal"}], "*", "JzOp", "*", "Bfield"}]}], "//",
     "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "MatrixForm"}], ";"}]}], "Input",
 CellChangeTimes->{{3.797091064331895*^9, 3.797091128686928*^9}, {
   3.797091779730118*^9, 3.7970917978472*^9}, {3.797091844726115*^9, 
   3.797091903384541*^9}, {3.797092070896071*^9, 3.797092117997636*^9}, 
   3.797092233665975*^9, 3.797092273944283*^9, 3.797092316377521*^9, {
   3.7970925655526667`*^9, 3.797092576402527*^9}, 3.7970960542870407`*^9},
 CellLabel->
  "In[188]:=",ExpressionUUID->"0b23a4e9-30c1-42a1-9dbf-65f1a8472b9e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"esysB", "[", 
     RowBox[{"Bfield_", ",", "W_", ",", "x_"}], "]"}], ":=", 
    RowBox[{"Eigensystem", "[", 
     RowBox[{"hamB", "[", 
      RowBox[{"Bfield", ",", "W", ",", "x"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ZB", "[", 
    RowBox[{"Bfield_", ",", "Temp_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"esysB", "[", 
            RowBox[{"Bfield", ",", "WVal", ",", "xVal"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "i"}], "]"}], "]"}], "-", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{"esysB", "[", 
             RowBox[{"Bfield", ",", "WVal", ",", "xVal"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ")"}]}], "/", "Temp"}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{
        RowBox[{"2", "*", "JVal"}], "+", "1"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.797092303909333*^9, 3.7970924393080797`*^9}, {
   3.797092510287903*^9, 3.797092643733098*^9}, {3.797092711299571*^9, 
   3.797092721618252*^9}, {3.797093510139996*^9, 3.797093511284247*^9}, {
   3.7970955196946783`*^9, 3.7970955204649343`*^9}, 3.797096060624319*^9},
 CellLabel->
  "In[190]:=",ExpressionUUID->"f940bede-a450-47ad-9493-fe20a168ea1b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"gJLS", "[", 
     RowBox[{"JVal", ",", "LVal", ",", "SVal"}], "]"}], "*", 
    RowBox[{"\[Mu]BVal", "/", "kBVal"}], "*", "JzOp", "*", "1"}], "//", 
   "MatrixForm"}], ";"}]], "Input",
 CellChangeTimes->{{3.797093677185074*^9, 3.797093697849971*^9}, 
   3.797096074448151*^9},
 CellLabel->
  "In[192]:=",ExpressionUUID->"49ef8df6-970a-4d8e-aa55-9452873cfc71"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"esysB", "[", 
   RowBox[{"1", ",", "1", ",", 
    RowBox[{"-", "0.32"}]}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Sort", "[", 
  RowBox[{"%", "-", 
   RowBox[{"Min", "[", "%", "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.797358213520982*^9, 3.797358242883663*^9}, {
  3.7973583081013737`*^9, 3.797358330355772*^9}},
 CellLabel->
  "In[193]:=",ExpressionUUID->"ee85ae95-a2c5-43c9-9d3c-7631c756c257"],

Cell[BoxData[
 RowBox[{"plot1", "=", 
  RowBox[{"ListPlot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Sort", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"esysB", "[", 
          RowBox[{"0", ",", "WVal", ",", "xVal"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"esysB", "[", 
           RowBox[{"0", ",", "WVal", ",", "xVal"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"Sort", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"esysB", "[", 
          RowBox[{"2", ",", "WVal", ",", "xVal"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"esysB", "[", 
           RowBox[{"2", ",", "WVal", ",", "xVal"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"Sort", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"esysB", "[", 
          RowBox[{"10", ",", "WVal", ",", "xVal"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"esysB", "[", 
           RowBox[{"10", ",", "WVal", ",", "xVal"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(E\), \(i\)]\)(B)-\!\(\*SubscriptBox[\(E\), \
\(GS\)]\)(B)  (K)\>\"", ",", "\"\<\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<Eigenstate index i\>\"", ",", "\"\<\>\""}], "}"}]}], 
      "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"Thickness", "[", "0.0025", "]"}], ",", 
       RowBox[{"FontSize", "\[Rule]", "14"}], ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "10"}], "}"}], ",", "Automatic"}], "}"}]}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"Placed", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<B=0\>\"", ",", " ", "\"\<B=2T\>\"", ",", " ", "\"\<B=10T\>\""}], 
        "}"}], ",", "Above"}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.796932106125465*^9, 3.7969321211145697`*^9}, {
  3.7969323689530487`*^9, 3.79693246184328*^9}, {3.797082708844481*^9, 
  3.797082715042218*^9}, {3.797093396870356*^9, 3.797093485958498*^9}, {
  3.7970935339539137`*^9, 3.7970935359882793`*^9}, {3.797093579643457*^9, 
  3.7970936548623457`*^9}, {3.797169953529686*^9, 3.797169955241962*^9}, {
  3.797174143877552*^9, 3.797174266324847*^9}, {3.797174337222294*^9, 
  3.797174408549038*^9}, {3.7971747544643507`*^9, 3.797174755661996*^9}, {
  3.797174889948656*^9, 3.7971749084621964`*^9}, {3.7971752315373096`*^9, 
  3.797175271894486*^9}},
 CellLabel->
  "In[195]:=",ExpressionUUID->"cdb329fe-cc1d-4977-82e8-3ae58d7a12ad"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"\"\<../Notes_Peter/Graphics/Spectrum_Vs_B-J_4-W_\>\"", "~~", 
      RowBox[{"ToString", "[", "WVal", "]"}], "~~", "\"\<-x_\>\"", "~~", 
      RowBox[{"ToString", "[", "xVal", "]"}], "~~", "\"\<.pdf\>\""}], ",", 
     " ", "plot1"}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.797174417004724*^9, 3.797174418884845*^9}, {
  3.797358205004739*^9, 3.797358210637102*^9}},
 CellLabel->
  "In[196]:=",ExpressionUUID->"6bddb1e8-fccc-4cba-b47a-d22d28446824"],

Cell[BoxData[{
 RowBox[{"WVal", "=", "4.25"}], "\[IndentingNewLine]", 
 RowBox[{"xVal", "=", "1"}], "\[IndentingNewLine]", 
 RowBox[{"BminVal", "=", "0.001"}]}], "Input",
 CellChangeTimes->{{3.797864800474155*^9, 3.797864804280871*^9}, {
   3.797864858257777*^9, 3.797864947744698*^9}, 3.79787236808969*^9},
 CellLabel->
  "In[197]:=",ExpressionUUID->"20341e1d-8ee5-4fec-bbf3-7f6c6bc89de6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"esysB", "[", 
   RowBox[{"BminVal", ",", "WVal", ",", "xVal"}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Conjugate", "[", 
     RowBox[{
      RowBox[{"esysB", "[", 
       RowBox[{"BminVal", ",", "WVal", ",", "xVal"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "i"}], "]"}], "]"}], "]"}], ".", "JzOp", ".", 
    RowBox[{
     RowBox[{"esysB", "[", 
      RowBox[{"BminVal", ",", "WVal", ",", "xVal"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", "i"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{
      RowBox[{"2", "*", "JVal"}], "+", "1"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7978723789213257`*^9, 3.797872382392186*^9}},
 CellLabel->
  "In[200]:=",ExpressionUUID->"8483d177-416f-4304-a572-788950211242"],

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Conjugate", "[", 
     RowBox[{
      RowBox[{"esys", "[", "xVal", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "i"}], "]"}], "]"}], "]"}], ".", "JzOp", ".", 
    RowBox[{
     RowBox[{"esys", "[", "xVal", "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", "i"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{
      RowBox[{"2", "*", "JVal"}], "+", "1"}]}], "}"}]}], "]"}]], "Input",
 CellLabel->
  "In[202]:=",ExpressionUUID->"6f9adf8d-a87b-4c74-ae56-ae9e8ca00b03"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"WVal", "*", 
   RowBox[{
    RowBox[{"esys", "[", "xVal", "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"ListPlot", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Chop", "[", 
         RowBox[{
          RowBox[{"Conjugate", "[", 
           RowBox[{
            RowBox[{"esys", "[", "xVal", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "i"}], "]"}], "]"}], "]"}], ".", "JzOp", ".", 
          RowBox[{
           RowBox[{"esys", "[", "xVal", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "i"}], "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{
           RowBox[{"2", "*", "JVal"}], "+", "1"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"xVal", ",", 
        RowBox[{"-", "1"}], ",", "1", ",", "0.01"}], "}"}]}], "]"}], "]"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"plot", "=", 
  RowBox[{"ListPlot", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{
           RowBox[{"esysB", "[", 
            RowBox[{"BminVal", ",", "WVal", ",", "xVal"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "i"}], "]"}], "]"}], "]"}], ".", "JzOp", ".", 
         RowBox[{
          RowBox[{"esysB", "[", 
           RowBox[{"BminVal", ",", "WVal", ",", "xVal"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "i"}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{
           RowBox[{"2", "*", "JVal"}], "+", "1"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"xVal", ",", 
        RowBox[{"-", "1"}], ",", "1", ",", "0.01"}], "}"}]}], "]"}], ",", " ", 
    RowBox[{"Epilog", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{"Dashed", ",", "Red"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "2.5"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"9", ",", 
            RowBox[{"-", "2.5"}]}], "}"}]}], "}"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "2.5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"9", ",", "2.5"}], "}"}]}], "}"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "0.5"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"9", ",", 
            RowBox[{"-", "0.5"}]}], "}"}]}], "}"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0.5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"9", ",", "0.5"}], "}"}]}], "}"}], "]"}]}], "}"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}]}], 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.797093190611351*^9, 3.7970932180792503`*^9}, {
   3.797093253296327*^9, 3.797093316758301*^9}, {3.7970935596895037`*^9, 
   3.7970935609004803`*^9}, {3.797864831361746*^9, 3.797864879125102*^9}, {
   3.797864952970232*^9, 3.797865085201283*^9}, 3.7978718337777348`*^9, {
   3.797871899715857*^9, 3.797871909344805*^9}, {3.797871993242395*^9, 
   3.797872296576542*^9}},
 CellLabel->
  "In[203]:=",ExpressionUUID->"d2c83489-d14f-4d11-932d-9464d3b5c8dc"],

Cell["Magnetization in finite field", "Text",
 CellChangeTimes->{{3.79709245886586*^9, 3.7970924678399563`*^9}, {
  3.797097004106513*^9, 3.797097006350685*^9}, {3.797102404987516*^9, 
  3.79710240569556*^9}},
 Background->GrayLevel[
  0.85],ExpressionUUID->"5a6c9c81-7b43-41cc-a21c-36023417a57d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"magZ", "[", 
    RowBox[{"Bfield_", ",", "Temp_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"ZB", "[", 
      RowBox[{"Bfield", ",", "Temp"}], "]"}]}], "*", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Conjugate", "[", 
         RowBox[{
          RowBox[{"esysB", "[", 
           RowBox[{"Bfield", ",", "WVal", ",", "xVal"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "i"}], "]"}], "]"}], "]"}], ".", "JzOp", ".", 
        RowBox[{
         RowBox[{"esysB", "[", 
          RowBox[{"Bfield", ",", "WVal", ",", "xVal"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "i"}], "]"}], "]"}]}], " ", "*", 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"esysB", "[", 
              RowBox[{"Bfield", ",", "WVal", ",", "xVal"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "i"}], "]"}], "]"}], "-", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"esysB", "[", 
               RowBox[{"Bfield", ",", "WVal", ",", "xVal"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ")"}]}], "/", "Temp"}],
         "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{
         RowBox[{"2", "*", "JVal"}], "+", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.797092468495714*^9, 3.79709250035081*^9}, {
   3.797092651331514*^9, 3.7970927961129827`*^9}, {3.797095445201747*^9, 
   3.797095449037384*^9}, {3.7970958842573023`*^9, 3.797095891615671*^9}, 
   3.797095978403713*^9, 3.7970972689182568`*^9},
 CellLabel->
  "In[205]:=",ExpressionUUID->"337c198a-6e33-4377-907f-f5d72d5413ee"],

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"esysB", "[", 
         RowBox[{"1", ",", "WVal", ",", "xVal"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "i"}], "]"}], "]"}], "]"}], ".", "JzOp", ".", 
      RowBox[{
       RowBox[{"esysB", "[", 
        RowBox[{"1", ",", "WVal", ",", "xVal"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "i"}], "]"}], "]"}]}], "*", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"esysB", "[", 
            RowBox[{"1", ",", "WVal", ",", "xVal"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "i"}], "]"}], "]"}], "-", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{"esysB", "[", 
             RowBox[{"1", ",", "WVal", ",", "xVal"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ")"}]}], " ", "/", "1"}],
       "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{
       RowBox[{"2", "*", "JVal"}], "+", "1"}]}], "}"}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.79735838047291*^9, 3.797358401845393*^9}, {
   3.797358477214653*^9, 3.797358481676236*^9}, {3.797359168126816*^9, 
   3.797359253676956*^9}, 3.797439164550324*^9},
 CellLabel->
  "In[206]:=",ExpressionUUID->"723bab12-a5c3-4bdb-a3a2-7d01ed45ac35"],

Cell[BoxData[
 RowBox[{"plot1", "=", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"magZ", "[", 
       RowBox[{"B", ",", "1"}], "]"}], ",", 
      RowBox[{"magZ", "[", 
       RowBox[{"B", ",", "6.69"}], "]"}], ",", 
      RowBox[{"magZ", "[", 
       RowBox[{"B", ",", "44.8"}], "]"}], ",", 
      RowBox[{"magZ", "[", 
       RowBox[{"B", ",", "300"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"B", ",", "0", ",", "10"}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(M\), \
\(z\)]\)/(\!\(\*SubscriptBox[\(\[Mu]\), \(B\)]\)\!\(\*SubscriptBox[\(g\), \(J\
\)]\))\>\"", ",", "\"\<\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<B (T)\>\"", ",", "\"\<\>\""}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"Placed", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<T=1K\>\"", ",", "\"\<T=50K\>\"", ",", "\"\<T=100K\>\"", ",", 
         "\"\<T=300K\>\""}], "}"}], ",", "Above"}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.79709279725414*^9, 3.79709283037326*^9}, {
   3.797092895029755*^9, 3.797092895446526*^9}, 3.7970937485300703`*^9, {
   3.797097011149433*^9, 3.797097025966505*^9}, {3.797097104784625*^9, 
   3.797097120523793*^9}, {3.797097153877613*^9, 3.797097162955976*^9}, {
   3.797097216753148*^9, 3.7970972202747927`*^9}, {3.797097279270802*^9, 
   3.797097283677964*^9}, {3.797097540282523*^9, 3.797097575449111*^9}, {
   3.797175376143649*^9, 3.797175425518318*^9}, {3.797175473535611*^9, 
   3.797175476043096*^9}, {3.797361538734376*^9, 3.797361546877021*^9}},
 CellLabel->
  "In[207]:=",ExpressionUUID->"8051bd3d-bdd4-4a96-bbdf-b1938f000fd9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"SetDirectory", "[", 
     RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"\"\<../Notes_Peter/Graphics/MagnetizationZ_Vs_B-J_4-W_\>\"", "~~", 
       RowBox[{"ToString", "[", "WVal", "]"}], "~~", "\"\<-x_\>\"", "~~", 
       RowBox[{"ToString", "[", "xVal", "]"}], "~~", "\"\<.pdf\>\""}], ",", 
      " ", "plot1"}], "]"}]}], "*)"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.797175431938917*^9, 3.797175447492741*^9}, 
   3.79717568021587*^9, {3.797439168565961*^9, 
   3.797439170637067*^9}},ExpressionUUID->"0a19fa64-25b0-4252-9eb1-\
2bacd63fdbfe"],

Cell[BoxData[
 RowBox[{"plot1", "=", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"magZ", "[", 
      RowBox[{"B", ",", "1"}], "]"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"B", ",", "0", ",", "50"}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(M\), \(z\)]\)/\!\(\*SubscriptBox[\(\[Mu]\), \
\(B\)]\)\!\(\*SubscriptBox[\(g\), \(J\)]\)\>\"", ",", "\"\<\>\""}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"\"\<B (T)\>\"", ",", "\"\<\>\""}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", "\"\<Expressions\>\""}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.797102240765374*^9, 3.7971022487091293`*^9}, {
  3.797102326203043*^9, 3.797102327118113*^9}, {3.7971756571273203`*^9, 
  3.797175657766761*^9}, {3.79717606172987*^9, 3.79717606178377*^9}},
 CellLabel->
  "In[142]:=",ExpressionUUID->"17025b33-13d6-470e-952b-6ae0f1dfbfd0"],

Cell[BoxData[{
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{
   "\"\<../Notes_Peter/Graphics/MagnetizationZ_Vs_B-Larger_B-J_4-W_\>\"", "~~", 
    RowBox[{"ToString", "[", "WVal", "]"}], "~~", "\"\<-x_\>\"", "~~", 
    RowBox[{"ToString", "[", "xVal", "]"}], "~~", "\"\<.pdf\>\""}], ",", " ", 
   "plot1"}], "]"}]}], "Input",
 CellChangeTimes->{{3.797176072064929*^9, 3.797176080263286*^9}},
 CellLabel->
  "In[143]:=",ExpressionUUID->"2de6bd23-8707-400d-81ad-3e9257ec89d5"],

Cell["Susceptibility", "Text",
 CellChangeTimes->{{3.7971023556973143`*^9, 3.797102363156039*^9}},
 Background->GrayLevel[
  0.85],ExpressionUUID->"a8f800f6-75a4-40f9-adae-92994f5f0da2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BfieldVal", "=", "0.001"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"chiZ", "[", "Temp_", "]"}], ":=", 
   RowBox[{"gVal", "*", "\[Mu]BVal", "*", 
    RowBox[{
     RowBox[{"magZ", "[", 
      RowBox[{"BfieldVal", ",", "Temp"}], "]"}], "/", "BfieldVal"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.797097222219215*^9, 3.7970972662744427`*^9}, 
   3.7970973201114397`*^9, {3.7970975959393806`*^9, 3.79709765000082*^9}, {
   3.797100860125086*^9, 3.797100864221684*^9}},
 CellLabel->
  "In[176]:=",ExpressionUUID->"2fab7b7d-d09f-4bfc-b151-ba29ecdbab06"],

Cell[BoxData[
 RowBox[{"plot2", "=", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"chiZ", "[", "Temp", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"Temp", ",", "1", ",", "300"}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(\[Chi]\), \(z\)]\) for single ion (dimless)\
\>\"", ",", "\"\<\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<T (K)\>\"", ",", "\"\<\>\""}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.797097324961033*^9, 3.7970973499365063`*^9}, {
  3.7970977000898647`*^9, 3.797097720238015*^9}, {3.797102200890143*^9, 
  3.7971022180246077`*^9}, {3.797175717647236*^9, 3.797175746798649*^9}, {
  3.797175780248435*^9, 3.797175805534971*^9}},
 CellLabel->
  "In[178]:=",ExpressionUUID->"edc405fa-1d89-4769-863e-2187c8f2b13a"],

Cell[BoxData[
 RowBox[{"plot2", "=", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"chiZ", "[", "Temp", "]"}], "/", "gVal"}], "/", "\[Mu]BVal"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"Temp", ",", "1", ",", "300"}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(\[Chi]\), \(z\)]\)/(\!\(\*SubscriptBox[\(\
\[Mu]\), \(B\)]\)*\!\(\*SubscriptBox[\(g\), \(JLS\)]\)) for single ion \
(dimless)\>\"", ",", "\"\<\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<T (K)\>\"", ",", "\"\<\>\""}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7974395800298443`*^9, 3.797439600717285*^9}},
 CellLabel->
  "In[189]:=",ExpressionUUID->"a07c0519-6b82-424a-b5fd-f35f62a1a079"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"chiZ", "[", "15", "]"}], "/", "gVal"}], "/", 
  "\[Mu]BVal"}]], "Input",
 CellChangeTimes->{{3.797439044169868*^9, 3.797439050957301*^9}, 
   3.797439177797879*^9, {3.7974395592225723`*^9, 3.797439565965206*^9}},
 CellLabel->
  "In[182]:=",ExpressionUUID->"531d8889-781f-489e-9837-5833951a31e3"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"\"\<../Notes_Peter/Graphics/SusceptibilityZ_Vs_T-J_4-W_\>\"", "~~", 
      RowBox[{"ToString", "[", "WVal", "]"}], "~~", "\"\<-x_\>\"", "~~", 
      RowBox[{"ToString", "[", "xVal", "]"}], "~~", "\"\<.pdf\>\""}], ",", 
     " ", "plot2"}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.797175668046732*^9, 3.797175675846446*^9}, {
  3.797175740806499*^9, 3.797175740870315*^9}, {3.797175795871879*^9, 
  3.7971758018805428`*^9}, {3.7974390396532516`*^9, 
  3.7974390420978317`*^9}},ExpressionUUID->"4e6b3ca3-7307-4d3c-8bf9-\
373db779e589"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Mu]BVal", "^", "2"}], "*", 
  RowBox[{
   RowBox[{"gVal", "^", "2"}], "/", "kBVal"}], "*", "JVal", "*", 
  RowBox[{"(", 
   RowBox[{"JVal", "+", "1"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.797101238532258*^9, 3.797101276417392*^9}},
 CellLabel->
  "In[136]:=",ExpressionUUID->"92c99646-2fc7-41be-a66d-ac56a83fdb34"],

Cell[BoxData[
 RowBox[{"6", "*", 
  RowBox[{"10", "^", "23"}], "*", "40", "*", "5", "*", 
  RowBox[{"10", "^", 
   RowBox[{"(", 
    RowBox[{"-", "25"}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.797102178150481*^9, 3.7971021915664873`*^9}, 
   3.797102345961636*^9},ExpressionUUID->"95569e5b-4ab1-4bcc-ba84-\
13b25922780f"],

Cell["\<\
Check that I am getting the correct van-Vleck susceptibility in the low \
temperature limit. Important: this requires that the GS be the singlet and I \
need to use the energy splitting to the triplet with dipole moment 1/2. This \
depends on the choice of W and x and since these are randomly drawn, the two \
cells below may not work if the ground state is different or the triplet is \
not the first excited state (this occurs for x=-0.380623, for which I have \
checked my calculation). \
\>", "Text",
 CellChangeTimes->{{3.7970968647143*^9, 
  3.7970969933233213`*^9}},ExpressionUUID->"9014e7ef-24c2-4a7c-9156-\
b797b7b5ef0d"],

Cell[BoxData["xVal"], "Input",
 CellChangeTimes->{{3.79709697446278*^9, 
  3.797096998594058*^9}},ExpressionUUID->"88d63097-8e84-41c6-82ed-\
98b78e630779"],

Cell[BoxData[
 RowBox[{
  RowBox[{"kBVal", "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"gJLS", "[", 
      RowBox[{"JVal", ",", "LVal", ",", "SVal"}], "]"}], "*", "\[Mu]BVal"}], 
    ")"}]}], "*", 
  RowBox[{
   RowBox[{"magZ", "[", 
    RowBox[{"0.01", ",", "1"}], "]"}], "/", "0.01"}]}]], "Input",
 CellChangeTimes->{{3.797094020834476*^9, 3.797094048870845*^9}, {
   3.797094322261258*^9, 3.797094330128172*^9}, {3.797095454047832*^9, 
   3.797095460074473*^9}, {3.797095814642474*^9, 3.79709582333989*^9}, {
   3.7970960994682703`*^9, 3.797096101943779*^9}, {3.797096670767456*^9, 
   3.79709667394707*^9}, {3.7970967728621683`*^9, 3.797096783757464*^9}, {
   3.7970968329987707`*^9, 3.7970968382661257`*^9}, 3.7970974055264177`*^9},
 CellLabel->
  "In[123]:=",ExpressionUUID->"f223bc5a-653c-4ec4-858d-3745fbfd248f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"40", "/", "3"}], "/", 
  RowBox[{
   RowBox[{"Sort", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"esysB", "[", 
       RowBox[{"0", ",", "WVal", ",", "xVal"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "-", 
     RowBox[{"Min", "[", 
      RowBox[{
       RowBox[{"esysB", "[", 
        RowBox[{"0", ",", "WVal", ",", "xVal"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], "[", 
   RowBox[{"[", "2", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7970939979411287`*^9, 3.797094012980019*^9}, {
  3.797094075908804*^9, 3.7970940981513977`*^9}, {3.797095057281535*^9, 
  3.797095068934136*^9}, {3.797096117629939*^9, 3.797096142761301*^9}, {
  3.797096651072448*^9, 3.797096653110276*^9}},
 CellLabel->
  "In[107]:=",ExpressionUUID->"5c960c4d-edd7-447b-b3ea-a1e3a445cd47"],

Cell[BoxData[{
 RowBox[{"kBVal", "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"gJLS", "[", 
     RowBox[{"JVal", ",", "LVal", ",", "SVal"}], "]"}], "*", "\[Mu]BVal"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gJLS", "[", 
   RowBox[{"JVal", ",", "LVal", ",", "SVal"}], "]"}], "*", 
  "\[Mu]BVal"}]}], "Input",
 CellChangeTimes->{{3.797097448334342*^9, 3.7970974485314617`*^9}},
 CellLabel->
  "In[125]:=",ExpressionUUID->"e03ac346-7c29-4410-b608-a3ddc7099ada"]
}, Closed]],

Cell[CellGroupData[{

Cell["Magnetic field along x", "Subsubsection",
 CellChangeTimes->{{3.797091867319274*^9, 3.797091881074354*^9}, {
  3.797185074070167*^9, 
  3.797185074144825*^9}},ExpressionUUID->"4e39fea5-6c85-44dc-abdb-\
0e3ba1fa5598"],

Cell[BoxData[{"WVal", "\[IndentingNewLine]", "xVal"}], "Input",
 CellChangeTimes->{{3.7971866120877447`*^9, 3.7971866150453167`*^9}},
 CellLabel->
  "In[248]:=",ExpressionUUID->"4fef8d79-6593-47bf-9413-c2cdcd9ef909"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"hamBX", "[", 
    RowBox[{"Bfield_", ",", "W_", ",", "x_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"W", "*", 
      RowBox[{"ham", "[", "x", "]"}]}], "-", 
     RowBox[{
      RowBox[{"gJLS", "[", 
       RowBox[{"JVal", ",", "LVal", ",", "SVal"}], "]"}], "*", 
      RowBox[{"\[Mu]BVal", "/", "kBVal"}], "*", "JxOp", "*", "Bfield"}]}], "//",
     "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "MatrixForm"}], ";"}]}], "Input",
 CellChangeTimes->{{3.797091064331895*^9, 3.797091128686928*^9}, {
   3.797091779730118*^9, 3.7970917978472*^9}, {3.797091844726115*^9, 
   3.797091903384541*^9}, {3.797092070896071*^9, 3.797092117997636*^9}, 
   3.797092233665975*^9, 3.797092273944283*^9, 3.797092316377521*^9, {
   3.7970925655526667`*^9, 3.797092576402527*^9}, 3.7970960542870407`*^9, {
   3.797185082118867*^9, 3.79718508495817*^9}, {3.79718662375134*^9, 
   3.797186648269558*^9}, {3.797186686390986*^9, 3.797186690149913*^9}},
 CellLabel->
  "In[250]:=",ExpressionUUID->"3a502131-a3e5-4106-8e85-82eb8507ce48"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"esysB", "[", 
     RowBox[{"Bfield_", ",", "W_", ",", "x_"}], "]"}], ":=", 
    RowBox[{"Eigensystem", "[", 
     RowBox[{"hamBX", "[", 
      RowBox[{"Bfield", ",", "W", ",", "x"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ZB", "[", 
    RowBox[{"Bfield_", ",", "Temp_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"esysB", "[", 
            RowBox[{"Bfield", ",", "WVal", ",", "xVal"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "i"}], "]"}], "]"}], "-", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{"esysB", "[", 
             RowBox[{"Bfield", ",", "WVal", ",", "xVal"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ")"}]}], "/", "Temp"}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{
        RowBox[{"2", "*", "JVal"}], "+", "1"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.797092303909333*^9, 3.7970924393080797`*^9}, {
   3.797092510287903*^9, 3.797092643733098*^9}, {3.797092711299571*^9, 
   3.797092721618252*^9}, {3.797093510139996*^9, 3.797093511284247*^9}, {
   3.7970955196946783`*^9, 3.7970955204649343`*^9}, 3.797096060624319*^9, 
   3.79718509215942*^9},
 CellLabel->
  "In[252]:=",ExpressionUUID->"1b82662d-05b5-47bb-96b6-d2dafd279e40"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"gJLS", "[", 
     RowBox[{"JVal", ",", "LVal", ",", "SVal"}], "]"}], "*", 
    RowBox[{"\[Mu]BVal", "/", "kBVal"}], "*", "JzOp", "*", "1"}], "//", 
   "MatrixForm"}], ";"}]], "Input",
 CellChangeTimes->{{3.797093677185074*^9, 3.797093697849971*^9}, 
   3.797096074448151*^9},
 CellLabel->
  "In[254]:=",ExpressionUUID->"c2fb3aec-e425-4441-8d42-287f683c43ac"],

Cell[BoxData[
 RowBox[{"plot2", "=", 
  RowBox[{"ListPlot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Sort", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"esysB", "[", 
          RowBox[{"0", ",", "WVal", ",", "xVal"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"esysB", "[", 
           RowBox[{"0", ",", "WVal", ",", "xVal"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"Sort", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"esysB", "[", 
          RowBox[{"2", ",", "WVal", ",", "xVal"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"esysB", "[", 
           RowBox[{"2", ",", "WVal", ",", "xVal"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"Sort", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"esysB", "[", 
          RowBox[{"10", ",", "WVal", ",", "xVal"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"esysB", "[", 
           RowBox[{"10", ",", "WVal", ",", "xVal"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(E\), \(i\)]\)(B)-\!\(\*SubscriptBox[\(E\), \
\(GS\)]\)(B)  (K)\>\"", ",", "\"\<\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<Eigenstate index i\>\"", ",", "\"\<\>\""}], "}"}]}], 
      "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"Thickness", "[", "0.0025", "]"}], ",", 
       RowBox[{"FontSize", "\[Rule]", "14"}], ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "10"}], "}"}], ",", "Automatic"}], "}"}]}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"Placed", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<B=0\>\"", ",", " ", "\"\<B=2T\>\"", ",", " ", "\"\<B=10T\>\""}], 
        "}"}], ",", "Above"}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.796932106125465*^9, 3.7969321211145697`*^9}, {
  3.7969323689530487`*^9, 3.79693246184328*^9}, {3.797082708844481*^9, 
  3.797082715042218*^9}, {3.797093396870356*^9, 3.797093485958498*^9}, {
  3.7970935339539137`*^9, 3.7970935359882793`*^9}, {3.797093579643457*^9, 
  3.7970936548623457`*^9}, {3.797169953529686*^9, 3.797169955241962*^9}, {
  3.797174143877552*^9, 3.797174266324847*^9}, {3.797174337222294*^9, 
  3.797174408549038*^9}, {3.7971747544643507`*^9, 3.797174755661996*^9}, {
  3.797174889948656*^9, 3.7971749084621964`*^9}, {3.7971752315373096`*^9, 
  3.797175271894486*^9}, {3.7971867368688593`*^9, 3.797186736926545*^9}},
 CellLabel->
  "In[255]:=",ExpressionUUID->"6d1fba2a-136b-4968-a034-10e0ab57621a"],

Cell[BoxData[{
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"\"\<../Notes_Peter/Graphics/Spectrum_Vs_BX-J_4-W_\>\"", "~~", 
    RowBox[{"ToString", "[", "WVal", "]"}], "~~", "\"\<-x_\>\"", "~~", 
    RowBox[{"ToString", "[", "xVal", "]"}], "~~", "\"\<.pdf\>\""}], ",", " ", 
   "plot1"}], "]"}]}], "Input",
 CellChangeTimes->{{3.797174417004724*^9, 3.797174418884845*^9}, 
   3.797185135503376*^9},
 CellLabel->
  "In[151]:=",ExpressionUUID->"b980efd1-41ca-4fa9-871b-908de7981c76"],

Cell[BoxData[{
 RowBox[{"WVal", "*", 
  RowBox[{
   RowBox[{"esys", "[", "xVal", "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Conjugate", "[", 
      RowBox[{
       RowBox[{"esys", "[", "xVal", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "i"}], "]"}], "]"}], "]"}], ".", "JzOp", ".", 
     RowBox[{
      RowBox[{"esys", "[", "xVal", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "i"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{
       RowBox[{"2", "*", "JVal"}], "+", "1"}]}], "}"}]}], "]"}], "//", 
  "Chop"}]}], "Input",
 CellChangeTimes->{{3.797093190611351*^9, 3.7970932180792503`*^9}, {
  3.797093253296327*^9, 3.797093316758301*^9}, {3.7970935596895037`*^9, 
  3.7970935609004803`*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"7a9168cb-5f66-4936-b7d2-4e01a3ddfe98"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"esys", "[", "xVal", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "i"}], "]"}], "]"}], ".", "JzOp", ".", 
     RowBox[{
      RowBox[{"esys", "[", "xVal", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{
       RowBox[{"2", "*", "JVal"}], "+", "1"}]}], "}"}]}], "]"}], "//", 
  "Chop"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sqrt", "[", 
   RowBox[{"20", "/", "3"}], "]"}], "//", "N"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"energies", "[", 
   RowBox[{"[", "5", "]"}], "]"}], "-", 
  RowBox[{"energies", "[", 
   RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"40", "/", "3"}], "/", "%"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.797095088111053*^9, 3.797095183295354*^9}, {
  3.797095282764439*^9, 3.7970953628113117`*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"4f89cfce-3337-46a5-b4e5-ec537ae6f9ca"],

Cell["Magnetization in finite field", "Text",
 CellChangeTimes->{{3.79709245886586*^9, 3.7970924678399563`*^9}, {
  3.797097004106513*^9, 3.797097006350685*^9}, {3.797102404987516*^9, 
  3.79710240569556*^9}},
 Background->GrayLevel[
  0.85],ExpressionUUID->"74aba51d-9146-4fdd-9baf-cdd5161044f5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"magX", "[", 
    RowBox[{"Bfield_", ",", "Temp_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"ZB", "[", 
      RowBox[{"Bfield", ",", "Temp"}], "]"}]}], "*", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Conjugate", "[", 
         RowBox[{
          RowBox[{"esysB", "[", 
           RowBox[{"Bfield", ",", "WVal", ",", "xVal"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "i"}], "]"}], "]"}], "]"}], ".", "JxOp", ".", 
        RowBox[{
         RowBox[{"esysB", "[", 
          RowBox[{"Bfield", ",", "WVal", ",", "xVal"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "i"}], "]"}], "]"}]}], " ", "*", 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"esysB", "[", 
              RowBox[{"Bfield", ",", "WVal", ",", "xVal"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "i"}], "]"}], "]"}], "-", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"esysB", "[", 
               RowBox[{"Bfield", ",", "WVal", ",", "xVal"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ")"}]}], "/", "Temp"}],
         "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{
         RowBox[{"2", "*", "JVal"}], "+", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.797092468495714*^9, 3.79709250035081*^9}, {
   3.797092651331514*^9, 3.7970927961129827`*^9}, {3.797095445201747*^9, 
   3.797095449037384*^9}, {3.7970958842573023`*^9, 3.797095891615671*^9}, 
   3.797095978403713*^9, 3.7970972689182568`*^9, {3.797185147207944*^9, 
   3.79718514739859*^9}, {3.7971852408480387`*^9, 3.797185241006818*^9}},
 CellLabel->
  "In[257]:=",ExpressionUUID->"1e105a6a-f581-4f70-bdd7-0064e6ed05ff"],

Cell[BoxData[
 RowBox[{"plot1", "=", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"magX", "[", 
       RowBox[{"B", ",", "1"}], "]"}], ",", 
      RowBox[{"magX", "[", 
       RowBox[{"B", ",", "50"}], "]"}], ",", 
      RowBox[{"magX", "[", 
       RowBox[{"B", ",", "100"}], "]"}], ",", 
      RowBox[{"magX", "[", 
       RowBox[{"B", ",", "300"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"B", ",", "0", ",", "10"}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(M\), \
\(x\)]\)/(\!\(\*SubscriptBox[\(\[Mu]\), \(B\)]\)\!\(\*SubscriptBox[\(g\), \(J\
\)]\))\>\"", ",", "\"\<\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<B (T)\>\"", ",", "\"\<\>\""}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"Placed", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<T=1K\>\"", ",", "\"\<T=50K\>\"", ",", "\"\<T=100K\>\"", ",", 
         "\"\<T=300K\>\""}], "}"}], ",", "Above"}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.79709279725414*^9, 3.79709283037326*^9}, {
   3.797092895029755*^9, 3.797092895446526*^9}, 3.7970937485300703`*^9, {
   3.797097011149433*^9, 3.797097025966505*^9}, {3.797097104784625*^9, 
   3.797097120523793*^9}, {3.797097153877613*^9, 3.797097162955976*^9}, {
   3.797097216753148*^9, 3.7970972202747927`*^9}, {3.797097279270802*^9, 
   3.797097283677964*^9}, {3.797097540282523*^9, 3.797097575449111*^9}, {
   3.797175376143649*^9, 3.797175425518318*^9}, {3.797175473535611*^9, 
   3.797175476043096*^9}, {3.797185149688875*^9, 3.797185155846217*^9}, {
   3.7971852332791233`*^9, 3.797185237918827*^9}},
 CellLabel->
  "In[258]:=",ExpressionUUID->"07874b93-2c9b-4f12-8e2b-ef4209e5e507"],

Cell[BoxData[{
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"\"\<../Notes_Peter/Graphics/MagnetizationX_Vs_B-J_4-W_\>\"", "~~", 
    RowBox[{"ToString", "[", "WVal", "]"}], "~~", "\"\<-x_\>\"", "~~", 
    RowBox[{"ToString", "[", "xVal", "]"}], "~~", "\"\<.pdf\>\""}], ",", " ", 
   "plot1"}], "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.797175431938917*^9, 3.797175447492741*^9}, 
   3.79717568021587*^9, {3.7971852547672586`*^9, 
   3.7971852549743967`*^9}},ExpressionUUID->"3ad3e312-dd34-4654-ba20-\
6f378b9c7aec"],

Cell[BoxData[
 RowBox[{"plot1", "=", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"magX", "[", 
      RowBox[{"B", ",", "1"}], "]"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"B", ",", "0", ",", "50"}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(M\), \(x\)]\)/\!\(\*SubscriptBox[\(\[Mu]\), \
\(B\)]\)\!\(\*SubscriptBox[\(g\), \(J\)]\)\>\"", ",", "\"\<\>\""}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"\"\<B (T)\>\"", ",", "\"\<\>\""}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", "\"\<Expressions\>\""}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.797102240765374*^9, 3.7971022487091293`*^9}, {
  3.797102326203043*^9, 3.797102327118113*^9}, {3.7971756571273203`*^9, 
  3.797175657766761*^9}, {3.79717606172987*^9, 3.79717606178377*^9}, {
  3.7971852616157084`*^9, 
  3.797185264606319*^9}},ExpressionUUID->"d959e63f-2707-4004-baf0-\
b249bc1d6e2a"],

Cell[BoxData[{
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{
   "\"\<../Notes_Peter/Graphics/MagnetizationX_Vs_B-Larger_B-J_4-W_\>\"", "~~", 
    RowBox[{"ToString", "[", "WVal", "]"}], "~~", "\"\<-x_\>\"", "~~", 
    RowBox[{"ToString", "[", "xVal", "]"}], "~~", "\"\<.pdf\>\""}], ",", " ", 
   "plot1"}], "]"}]}], "Input",
 CellChangeTimes->{{3.797176072064929*^9, 3.797176080263286*^9}, 
   3.797185269319586*^9},ExpressionUUID->"f0257d01-0fb2-4288-96dd-\
a1cfb0b76d19"],

Cell["Susceptibility", "Text",
 CellChangeTimes->{{3.7971023556973143`*^9, 3.797102363156039*^9}},
 Background->GrayLevel[
  0.85],ExpressionUUID->"3ae9dfda-8b74-4de3-8829-7c484b1458b1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BfieldVal", "=", "0.001"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"chiX", "[", "Temp_", "]"}], ":=", 
   RowBox[{"gVal", "*", "\[Mu]BVal", "*", 
    RowBox[{
     RowBox[{"magX", "[", 
      RowBox[{"BfieldVal", ",", "Temp"}], "]"}], "/", "BfieldVal"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.797097222219215*^9, 3.7970972662744427`*^9}, 
   3.7970973201114397`*^9, {3.7970975959393806`*^9, 3.79709765000082*^9}, {
   3.797100860125086*^9, 3.797100864221684*^9}, {3.797185275007655*^9, 
   3.797185277334392*^9}},ExpressionUUID->"9a8a9628-9b30-4676-8f6f-\
afd5c5e72d49"],

Cell[BoxData[
 RowBox[{"plot2", "=", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"chiX", "[", "Temp", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"Temp", ",", "1", ",", "300"}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(\[Chi]\), \(x\)]\) for single ion (dimless)\
\>\"", ",", "\"\<\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<T (K)\>\"", ",", "\"\<\>\""}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.797097324961033*^9, 3.7970973499365063`*^9}, {
  3.7970977000898647`*^9, 3.797097720238015*^9}, {3.797102200890143*^9, 
  3.7971022180246077`*^9}, {3.797175717647236*^9, 3.797175746798649*^9}, {
  3.797175780248435*^9, 3.797175805534971*^9}, {3.797185279358679*^9, 
  3.797185283190592*^9}},ExpressionUUID->"a9b4b730-436a-413a-91cd-\
abc3fa0ecf62"],

Cell[BoxData[{
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"\"\<../Notes_Peter/Graphics/SusceptibilityX_Vs_T-J_4-W_\>\"", "~~", 
    RowBox[{"ToString", "[", "WVal", "]"}], "~~", "\"\<-x_\>\"", "~~", 
    RowBox[{"ToString", "[", "xVal", "]"}], "~~", "\"\<.pdf\>\""}], ",", " ", 
   "plot2"}], "]"}]}], "Input",
 CellChangeTimes->{{3.797175668046732*^9, 3.797175675846446*^9}, {
  3.797175740806499*^9, 3.797175740870315*^9}, {3.797175795871879*^9, 
  3.7971758018805428`*^9}, {3.79718528729462*^9, 
  3.797185287462672*^9}},ExpressionUUID->"b5081da6-f3b6-4414-9e47-\
88a94173a17f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Mu]BVal", "^", "2"}], "*", 
  RowBox[{
   RowBox[{"gVal", "^", "2"}], "/", "kBVal"}], "*", "JVal", "*", 
  RowBox[{"(", 
   RowBox[{"JVal", "+", "1"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.797101238532258*^9, 3.797101276417392*^9}},
 CellLabel->
  "In[136]:=",ExpressionUUID->"77083307-a522-45cf-b6f1-99b3cb243294"],

Cell[BoxData[
 RowBox[{"6", "*", 
  RowBox[{"10", "^", "23"}], "*", "40", "*", "5", "*", 
  RowBox[{"10", "^", 
   RowBox[{"(", 
    RowBox[{"-", "25"}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.797102178150481*^9, 3.7971021915664873`*^9}, 
   3.797102345961636*^9},ExpressionUUID->"4f41b6f3-2649-4c28-baf0-\
13b376647f93"],

Cell["\<\
Check that I am getting the correct van-Vleck susceptibility in the low \
temperature limit. Important: this requires that the GS be the singlet and I \
need to use the energy splitting to the triplet with dipole moment 1/2. This \
depends on the choice of W and x and since these are randomly drawn, the two \
cells below may not work if the ground state is different or the triplet is \
not the first excited state (this occurs for x=-0.380623, for which I have \
checked my calculation). \
\>", "Text",
 CellChangeTimes->{{3.7970968647143*^9, 
  3.7970969933233213`*^9}},ExpressionUUID->"fc3dc837-9c39-4a67-985d-\
92e6b9b0a764"],

Cell[BoxData["xVal"], "Input",
 CellChangeTimes->{{3.79709697446278*^9, 
  3.797096998594058*^9}},ExpressionUUID->"8846210a-18d7-4b7e-92ab-\
40e259e68319"],

Cell[BoxData[
 RowBox[{
  RowBox[{"kBVal", "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"gJLS", "[", 
      RowBox[{"JVal", ",", "LVal", ",", "SVal"}], "]"}], "*", "\[Mu]BVal"}], 
    ")"}]}], "*", 
  RowBox[{
   RowBox[{"magZ", "[", 
    RowBox[{"0.01", ",", "1"}], "]"}], "/", "0.01"}]}]], "Input",
 CellChangeTimes->{{3.797094020834476*^9, 3.797094048870845*^9}, {
   3.797094322261258*^9, 3.797094330128172*^9}, {3.797095454047832*^9, 
   3.797095460074473*^9}, {3.797095814642474*^9, 3.79709582333989*^9}, {
   3.7970960994682703`*^9, 3.797096101943779*^9}, {3.797096670767456*^9, 
   3.79709667394707*^9}, {3.7970967728621683`*^9, 3.797096783757464*^9}, {
   3.7970968329987707`*^9, 3.7970968382661257`*^9}, 3.7970974055264177`*^9},
 CellLabel->
  "In[123]:=",ExpressionUUID->"428e06d1-7b52-4928-ace8-8e7de2c7545f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"40", "/", "3"}], "/", 
  RowBox[{
   RowBox[{"Sort", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"esysB", "[", 
       RowBox[{"0", ",", "WVal", ",", "xVal"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "-", 
     RowBox[{"Min", "[", 
      RowBox[{
       RowBox[{"esysB", "[", 
        RowBox[{"0", ",", "WVal", ",", "xVal"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], "[", 
   RowBox[{"[", "2", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7970939979411287`*^9, 3.797094012980019*^9}, {
  3.797094075908804*^9, 3.7970940981513977`*^9}, {3.797095057281535*^9, 
  3.797095068934136*^9}, {3.797096117629939*^9, 3.797096142761301*^9}, {
  3.797096651072448*^9, 3.797096653110276*^9}},
 CellLabel->
  "In[107]:=",ExpressionUUID->"c8ed82f0-f205-485c-b869-3795a5f80565"],

Cell[BoxData[{
 RowBox[{"kBVal", "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"gJLS", "[", 
     RowBox[{"JVal", ",", "LVal", ",", "SVal"}], "]"}], "*", "\[Mu]BVal"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gJLS", "[", 
   RowBox[{"JVal", ",", "LVal", ",", "SVal"}], "]"}], "*", 
  "\[Mu]BVal"}]}], "Input",
 CellChangeTimes->{{3.797097448334342*^9, 3.7970974485314617`*^9}},
 CellLabel->
  "In[125]:=",ExpressionUUID->"2c4a00c3-ad3c-4501-b962-b8c5a6dde77b"]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Training data: ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["C", 
    RowBox[{"4", "v"}]], TraditionalForm]],ExpressionUUID->
  "6805871d-6aee-4dbe-92aa-484827d528b7"],
 "= 4mm symmetry"
}], "Section",
 CellChangeTimes->{{3.7969237703461857`*^9, 3.796923781980577*^9}, {
   3.7969259622094307`*^9, 3.796925976376203*^9}, {3.798607623413109*^9, 
   3.798607630071587*^9}, 
   3.798607816200563*^9},ExpressionUUID->"9b2e5264-fe89-46b4-bb0f-\
1071b0db6680"],

Cell["\<\
There are two crystal field parameters {A[4,4], A[6,4]} = {W, x}, where -1 <= \
x <= 1. Here, W sets the band width of the crystal field spectrum (band width \
= approx. W/10) and x depends on the ratio of A[4,4] and A[6,4]. We thus draw \
two random numbers to set W and x. We express energies in Kelvin and thus \
draw W in the range 10 K - 300 K. This is a rough range of crystal field \
energies. \
\>", "Text",
 CellChangeTimes->{{3.796925985532331*^9, 3.796926119622555*^9}, {
  3.796926197131414*^9, 3.796926197190735*^9}, {3.796926606571512*^9, 
  3.79692660936616*^9}, {3.796932542201441*^9, 
  3.796932561977922*^9}},ExpressionUUID->"93eb1a45-cafd-4c0a-a1a7-\
ccdc27e272d2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"x0MinVal", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x0MaxVal", "=", "30"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"x0Val", "=", 
  RowBox[{"RandomReal", "[", 
   RowBox[{"{", 
    RowBox[{"x0MinVal", ",", "x0MaxVal"}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"x1Val", "=", 
  RowBox[{"RandomReal", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"x2Val", "=", 
  RowBox[{"RandomReal", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"x3Val", "=", 
  RowBox[{"RandomReal", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"x4Val", "=", 
  RowBox[{"RandomReal", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.7969265851578493`*^9, 3.796926651622409*^9}, {
  3.7969324850696917`*^9, 3.7969324856586533`*^9}, {3.796932566024177*^9, 
  3.796932574198258*^9}, {3.797410905134459*^9, 3.797410905933223*^9}, {
  3.799071253246426*^9, 3.799071273874688*^9}},
 CellLabel->
  "In[102]:=",ExpressionUUID->"f194fe0b-71b4-4a94-81ac-1fed2ce384da"],

Cell[CellGroupData[{

Cell["Crystal field Hamiltonian ", "Subsection",
 CellChangeTimes->{{3.796923783849966*^9, 3.796923797869154*^9}, {
  3.7969239115297403`*^9, 3.7969239219126368`*^9}, {3.7969259726549997`*^9, 
  3.7969259796325693`*^9}},ExpressionUUID->"5aeb1d11-47b6-4e0d-aaa3-\
6748c658e77a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PG", "=", 
   RowBox[{"GTInstallGroup", "[", 
    RowBox[{"C4v", ",", 
     RowBox[{"GOVerbose", "\[Rule]", "\"\<False\>\""}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.785269160622649*^9, {3.785269281480538*^9, 3.785269336414172*^9}, 
   3.786627168376821*^9, {3.796923821876587*^9, 3.796923822481081*^9}, {
   3.7986078392786283`*^9, 3.798607857913569*^9}},
 CellLabel->
  "In[865]:=",ExpressionUUID->"a511142c-96f2-4522-884c-5e6bf87b37af"],

Cell[BoxData[
 RowBox[{"vcr", "=", 
  RowBox[{"GTCrystalField", "[", 
   RowBox[{"PG", ",", "6"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.785269341649662*^9, 3.7852693624398003`*^9}, 
   3.796923935630218*^9, 3.797943202737104*^9, {3.798607844448896*^9, 
   3.798607852493536*^9}},
 CellLabel->
  "In[866]:=",ExpressionUUID->"bc3fc034-1d75-4b4e-a1c2-1eb63b7e782d"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["Pr", 
      RowBox[{"3", "+"}]], " ", "has", " ", "ground", " ", "state", " ", 
     "term", " ", 
     SuperscriptBox[
      RowBox[{"symbol", " "}], "3"], 
     SubscriptBox["H", 
      RowBox[{"4", " "}]]}], 
    SuperscriptBox["=", 
     RowBox[{" ", 
      RowBox[{
       RowBox[{"2", "S"}], "+", "1"}]}]], 
    SubscriptBox["L", "J"]}], TraditionalForm]],ExpressionUUID->
  "7c6d8795-691f-4cb4-b161-4561382d6ea6"],
 " corresponding to S=1, L=5, J=4. Pr 1-2-20 compounds have ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["T", 
    RowBox[{"d", " "}]], TraditionalForm]],ExpressionUUID->
  "85fd9229-0ce3-4bbd-b6c3-ed63baa39090"],
 "symmetry, which has the same CEF expansion as ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["O", "h"], TraditionalForm]],ExpressionUUID->
  "ab70806f-23fd-49d8-a467-3700f86f824a"],
 "."
}], "Text",
 CellChangeTimes->{{3.797091712406839*^9, 3.797091763734208*^9}, {
  3.797943739438446*^9, 
  3.797943774768508*^9}},ExpressionUUID->"4fdc99b2-d0e3-47e9-b364-\
9ccd2f7a8b08"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"JVal", "=", 
   RowBox[{"9", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LVal", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SVal", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gJLS", "[", 
    RowBox[{"J_", ",", "L_", ",", "S_"}], "]"}], "=", 
   RowBox[{"1", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"J", "*", 
        RowBox[{"(", 
         RowBox[{"J", "+", "1"}], ")"}]}], "+", 
       RowBox[{"S", "*", 
        RowBox[{"(", 
         RowBox[{"S", "+", "1"}], ")"}]}], "-", 
       RowBox[{"L", "*", 
        RowBox[{"(", 
         RowBox[{"L", "+", "1"}], ")"}]}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"2", "*", "J", "*", 
       RowBox[{"(", 
        RowBox[{"J", "+", "1"}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gVal", "=", 
   RowBox[{"gJLS", "[", 
    RowBox[{"JVal", ",", "LVal", ",", "SVal"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.786640148438908*^9, 3.7866401487685127`*^9}, {
   3.7881950585497932`*^9, 3.788195058644024*^9}, {3.788195412637435*^9, 
   3.788195413708387*^9}, {3.788195886755945*^9, 3.78819588762637*^9}, {
   3.788196025865087*^9, 3.788196026015921*^9}, {3.796901445279166*^9, 
   3.7969014466723547`*^9}, 3.796901956860958*^9, {3.797091658869198*^9, 
   3.797091662472419*^9}, {3.7970917077388477`*^9, 3.797091710309637*^9}, {
   3.797096565075316*^9, 3.79709657248085*^9}, {3.7994785939072857`*^9, 
   3.799478595289188*^9}, {3.79947874017999*^9, 3.799478757709075*^9}, {
   3.7994788632883577`*^9, 3.799478864164633*^9}, 3.799479065539369*^9, {
   3.799479298998925*^9, 3.799479299679881*^9}, {3.7994869915326033`*^9, 
   3.7994870043546677`*^9}},
 CellLabel->
  "In[896]:=",ExpressionUUID->"1c5f7f3c-1dcd-46cc-8270-51ecfb594a28"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{
    RowBox[{"vcr", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Y", "[", 
        RowBox[{"ll_", ",", "mm_"}], "]"}], "\[RuleDelayed]", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "*", "ll"}], "+", "1"}], ")"}], "/", "4"}], "/", 
          "Pi"}], "]"}], "*", 
        RowBox[{"GTBSTOperator", "[", 
         RowBox[{"ll", ",", "mm", ",", "JVal"}], "]"}]}]}], "}"}]}], "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{"temp", "/.", 
    RowBox[{
     RowBox[{"A", "[", 
      RowBox[{"0", ",", "0"}], "]"}], "\[Rule]", "0"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matcrBST", "=", 
   RowBox[{"temp", "/.", 
    RowBox[{"{", 
     RowBox[{"r", "\[Rule]", "1"}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "MatrixForm"}], ";"}]}], "Input",
 CellChangeTimes->{{3.786627507720357*^9, 3.78662757792964*^9}, {
   3.7866277202481613`*^9, 3.786627735412421*^9}, {3.786627788623618*^9, 
   3.786627795672579*^9}, {3.786627923395748*^9, 3.786627953386715*^9}, {
   3.786628019298029*^9, 3.786628041536735*^9}, {3.786628426059493*^9, 
   3.786628461686534*^9}, {3.786628743577692*^9, 3.786628760372045*^9}, {
   3.7866400864895163`*^9, 3.78664015233587*^9}, {3.786640825633441*^9, 
   3.786640832701601*^9}, {3.786646996634104*^9, 3.786646999540801*^9}, {
   3.7866488342181587`*^9, 3.786648840252643*^9}, {3.7866491497723207`*^9, 
   3.786649155594781*^9}, {3.786649253814671*^9, 3.7866492654485893`*^9}, {
   3.7866494124688387`*^9, 3.786649414051375*^9}, {3.786649585012562*^9, 
   3.786649586039554*^9}, {3.78664990702824*^9, 3.786649915694008*^9}, {
   3.788195070645948*^9, 3.78819508183741*^9}, {3.7901104347783127`*^9, 
   3.7901104682891407`*^9}, {3.796657789537939*^9, 3.7966578185610228`*^9}, 
   3.7966578637771597`*^9, {3.796657927196455*^9, 3.796657936733631*^9}, {
   3.796658160029942*^9, 3.7966581781722927`*^9}, 3.796923929138701*^9, {
   3.7986079769773207`*^9, 3.798607989785933*^9}},
 CellLabel->
  "In[901]:=",ExpressionUUID->"684a869f-2ff6-47b2-bec4-ffdcd314dcf8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"matA20", "=", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"matcrBST", ",", 
     RowBox[{"A", "[", 
      RowBox[{"2", ",", "0"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matA44", "=", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"matcrBST", ",", 
     RowBox[{"A", "[", 
      RowBox[{"4", ",", "4"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matA40", "=", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"matcrBST", ",", 
     RowBox[{"A", "[", 
      RowBox[{"4", ",", "0"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matA64", "=", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"matcrBST", ",", 
     RowBox[{"A", "[", 
      RowBox[{"6", ",", "4"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matA60", "=", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"matcrBST", ",", 
     RowBox[{"A", "[", 
      RowBox[{"6", ",", "0"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"A", "[", 
      RowBox[{"2", ",", "0"}], "]"}], "*", "matA20"}], "+", 
    RowBox[{
     RowBox[{"A", "[", 
      RowBox[{"4", ",", "4"}], "]"}], "*", "matA44"}], "+", 
    RowBox[{
     RowBox[{"A", "[", 
      RowBox[{"4", ",", "0"}], "]"}], "*", "matA40"}], "+", 
    RowBox[{
     RowBox[{"A", "[", 
      RowBox[{"6", ",", "4"}], "]"}], "*", "matA64"}], "+", 
    RowBox[{
     RowBox[{"A", "[", 
      RowBox[{"6", ",", "0"}], "]"}], "*", "matA60"}], "+", 
    RowBox[{"-", "matcrBST"}]}], "//", "FullSimplify"}], ";"}]}], "Input",
 CellChangeTimes->{
  3.796658119511499*^9, {3.79665817602528*^9, 3.796658216521126*^9}, {
   3.796658250575593*^9, 3.7966583079603167`*^9}, {3.798607992815401*^9, 
   3.798608116468232*^9}},
 CellLabel->
  "In[906]:=",ExpressionUUID->"37b16397-174b-4d4b-a0af-b0b03417658c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"matA20", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matA44", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matA40", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matA64", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matA60", "//", "MatrixForm"}], ";"}]}], "Input",
 CellChangeTimes->{{3.799071327183543*^9, 3.799071359761353*^9}, {
  3.7990715387787724`*^9, 3.7990715401599693`*^9}},
 CellLabel->
  "In[912]:=",ExpressionUUID->"ffcbaa2d-6fcf-4d24-8d90-f81d3ef8577a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"matA20Av", "=", 
   RowBox[{
    RowBox[{"Norm", "[", 
     RowBox[{"Eigenvalues", "[", "matA20", "]"}], "]"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", "*", "JVal"}], "+", "1"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matA44Av", "=", 
   RowBox[{
    RowBox[{"Norm", "[", 
     RowBox[{"Eigenvalues", "[", "matA44", "]"}], "]"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", "*", "JVal"}], "+", "1"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matA40Av", "=", 
   RowBox[{
    RowBox[{"Norm", "[", 
     RowBox[{"Eigenvalues", "[", "matA40", "]"}], "]"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", "*", "JVal"}], "+", "1"}], ")"}]}]}], ";", 
  RowBox[{"matA64Av", "=", 
   RowBox[{
    RowBox[{"Norm", "[", 
     RowBox[{"Eigenvalues", "[", "matA64", "]"}], "]"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", "*", "JVal"}], "+", "1"}], ")"}]}]}], ";", 
  RowBox[{"matA60Av", "=", 
   RowBox[{
    RowBox[{"Norm", "[", 
     RowBox[{"Eigenvalues", "[", "matA60", "]"}], "]"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", "*", "JVal"}], "+", "1"}], ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7966583111783867`*^9, 3.7966583147590723`*^9}, 
   3.796658356374555*^9, {3.796658433420876*^9, 3.7966584633918657`*^9}, {
   3.796658496436825*^9, 3.796658532089654*^9}, {3.796659172254266*^9, 
   3.796659339374614*^9}, {3.796659474082996*^9, 3.7966595613539248`*^9}, {
   3.796659600789694*^9, 3.796659662278084*^9}, {3.796659906477929*^9, 
   3.796659961441085*^9}, {3.7966600937494097`*^9, 3.796660134489295*^9}, {
   3.796660720624673*^9, 3.7966607296844482`*^9}, {3.796896789760777*^9, 
   3.7968968102344*^9}, {3.7968969371331*^9, 3.796896954700213*^9}, {
   3.79689925287754*^9, 3.79689927695789*^9}, {3.796923959503933*^9, 
   3.796923978059507*^9}, {3.798608126150509*^9, 3.798608173180851*^9}, {
   3.7986085965977907`*^9, 3.798608599104416*^9}},
 CellLabel->
  "In[917]:=",ExpressionUUID->"f228490f-f721-400f-bce6-c4a6789850a6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"matA20", "/", "matA20Av"}], "//", "MatrixForm"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"matA44", "/", "matA44Av"}], "//", "MatrixForm"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"matA40", "/", "matA40Av"}], "//", "MatrixForm"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"matA64", "/", "matA64Av"}], "//", "MatrixForm"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"matA60", "/", "matA60Av"}], "//", "MatrixForm"}], ";"}]}], "Input",\

 CellChangeTimes->{{3.799071487248335*^9, 3.799071542875042*^9}, {
  3.799121199777563*^9, 3.799121204134091*^9}, {3.799122255004277*^9, 
  3.799122264368807*^9}},
 CellLabel->
  "In[920]:=",ExpressionUUID->"07fd5560-ae0d-4f34-8eb2-0262e62c32c0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ham", "[", 
    RowBox[{
    "x0_", ",", "x1_", ",", "x2_", ",", "x3_", ",", "x4_", ",", "x5_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"x0", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"x1", "*", 
        RowBox[{"matA20", "/", "matA20Av"}]}], "+", 
       RowBox[{"x2", "*", 
        RowBox[{"matA44", "/", "matA44Av"}]}], "+", 
       RowBox[{"x3", "*", 
        RowBox[{"matA40", "/", "matA40Av"}]}], "+", 
       RowBox[{"x4", "*", 
        RowBox[{"matA64", "/", "matA64Av"}]}], "+", 
       RowBox[{
        RowBox[{"Sign", "[", "x5", "]"}], "*", 
        RowBox[{"Abs", "[", 
         RowBox[{"1", "-", 
          RowBox[{"Abs", "[", "x1", "]"}], "-", 
          RowBox[{"Abs", "[", "x2", "]"}], "-", 
          RowBox[{"Abs", "[", "x3", "]"}], "-", 
          RowBox[{"Abs", "[", "x4", "]"}]}], "]"}], "*", 
        RowBox[{"matA60", "/", "matA60Av"}]}]}], ")"}]}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"esys", "[", 
    RowBox[{
    "x0_", ",", "x1_", ",", "x2_", ",", "x3_", ",", "x4_", ",", "x5_"}], 
    "]"}], ":=", 
   RowBox[{"Eigensystem", "[", 
    RowBox[{"ham", "[", 
     RowBox[{"x0", ",", "x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5"}], 
     "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.7966583263578873`*^9, {3.796660148329115*^9, 3.796660226315435*^9}, {
   3.79666074479909*^9, 3.796660745715601*^9}, {3.796661377716734*^9, 
   3.796661382701233*^9}, {3.79666142451544*^9, 3.796661432398801*^9}, {
   3.796662295430895*^9, 3.796662300213688*^9}, {3.796751985414648*^9, 
   3.796752008164106*^9}, 3.796901486293532*^9, {3.796924038670122*^9, 
   3.796924075190193*^9}, {3.79692411708181*^9, 3.7969241575137587`*^9}, {
   3.7970132179759903`*^9, 3.797013226320665*^9}, 3.79701326487462*^9, {
   3.797082603763859*^9, 3.797082630982724*^9}, 3.797096202274786*^9, {
   3.798608259030445*^9, 3.798608306414939*^9}, {3.7986085650850277`*^9, 
   3.7986085800692673`*^9}, {3.798608613474999*^9, 3.798608677887776*^9}, {
   3.798608720458528*^9, 3.798608787605392*^9}, {3.799121213985855*^9, 
   3.799121216907447*^9}, {3.7991212506592817`*^9, 3.7991212644411077`*^9}, {
   3.799121909099485*^9, 3.799121960603478*^9}, {3.799122138277803*^9, 
   3.7991221418248587`*^9}},
 CellLabel->
  "In[925]:=",ExpressionUUID->"2ebb34f7-0668-4a49-b01d-f55749d94b7e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ham", "[", 
   RowBox[{"1.", ",", "1", ",", "1", ",", "0", ",", "1", ",", 
    RowBox[{"-", "1"}]}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.797277952738563*^9, 3.797277964885384*^9}, 
   3.79735746132434*^9, {3.797861303191547*^9, 3.797861304822616*^9}, {
   3.798608793989986*^9, 3.79860879744168*^9}, {3.7990713061681147`*^9, 
   3.7990713181960487`*^9}, 3.799121922149579*^9, {3.799122002273933*^9, 
   3.7991220167565107`*^9}, 3.799122153607473*^9},
 CellLabel->
  "In[928]:=",ExpressionUUID->"74fb22f4-c107-43ba-b6a1-974f691d12b4"],

Cell["\<\
Define function that converts Mathematica expression into Python string\
\>", "Text",
 CellChangeTimes->{{3.7974109631463003`*^9, 
  3.7974109849172993`*^9}},ExpressionUUID->"ac9b3058-746b-488d-aaf7-\
e8b491f31bdf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ConvertToPyString", "[", "sstr_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"str", "=", "sstr"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"str", "=", 
      RowBox[{"Expand", "[", 
       RowBox[{"Simplify", "[", "str", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"str", "=", 
      RowBox[{"N", "[", "str", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"str", "=", 
      RowBox[{"ToString", "[", 
       RowBox[{"str", ",", "FortranForm"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"str", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"str", ",", 
        RowBox[{
         RowBox[{"Shortest", "[", 
          RowBox[{"\"\<Abs(\>\"", "~~", "i__", "~~", "\"\<)\>\""}], "]"}], 
         "\[Rule]", 
         RowBox[{"\"\<np.abs(\>\"", "~~", "i", "~~", "\"\<)\>\""}]}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"str", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"str", ",", 
        RowBox[{
         RowBox[{"Shortest", "[", 
          RowBox[{"\"\<Sqrt(\>\"", "~~", "i__", "~~", "\"\<)\>\""}], "]"}], 
         "\[Rule]", 
         RowBox[{"\"\<np.sqrt(\>\"", "~~", "i", "~~", "\"\<)\>\""}]}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"str", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"str", ",", 
        RowBox[{
         RowBox[{"Shortest", "[", 
          RowBox[{"\"\<Abs(\>\"", "~~", "i__", "~~", "\"\<)\>\""}], "]"}], 
         "\[Rule]", 
         RowBox[{"\"\<np.abs(\>\"", "~~", "i", "~~", "\"\<)\>\""}]}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"str", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"str", ",", 
        RowBox[{
         RowBox[{"Shortest", "[", 
          RowBox[{"\"\<Sign(\>\"", "~~", "i__", "~~", "\"\<)\>\""}], "]"}], 
         "\[Rule]", 
         RowBox[{"\"\<np.sign(\>\"", "~~", "i", "~~", "\"\<)\>\""}]}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", "str"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.797261935202834*^9, 3.797261982709478*^9}, {
   3.797262013965489*^9, 3.797262051348982*^9}, {3.797262335959133*^9, 
   3.7972623815014544`*^9}, 3.797262427221718*^9, {3.797266888096942*^9, 
   3.797267015952709*^9}, {3.7972671843860807`*^9, 3.797267196986126*^9}, {
   3.797270231651085*^9, 3.797270236074506*^9}, {3.797270292842783*^9, 
   3.797270580170759*^9}, {3.797272912045128*^9, 3.797272917523796*^9}, {
   3.7972729920677567`*^9, 3.79727318620399*^9}, 3.797273315333137*^9, {
   3.797273475335691*^9, 3.797273524621703*^9}, {3.797273559862084*^9, 
   3.797273569452402*^9}, {3.797273681508535*^9, 3.797273702828506*^9}, 
   3.7972739801683903`*^9, {3.797275761596661*^9, 3.797275780915831*^9}, {
   3.797275844940381*^9, 3.7972758450919313`*^9}, {3.797275941580229*^9, 
   3.7972759705243587`*^9}, {3.797276010244479*^9, 3.797276038684608*^9}, {
   3.7972762116527452`*^9, 3.797276229996397*^9}, {3.797276262476548*^9, 
   3.797276273428364*^9}, {3.797276486085189*^9, 3.797276495173934*^9}, {
   3.799121985380055*^9, 3.799121991999998*^9}, {3.799122705261236*^9, 
   3.799122705487258*^9}},
 CellLabel->
  "In[456]:=",ExpressionUUID->"4e5e0dfc-49c6-47f9-a34c-be1c19cb32bd"],

Cell["\<\
Write python module file that sets up expression of crystal field matrix. Use \
OpenAppend if file exists already. In that case, comment out \
\[OpenCurlyDoubleQuote]import numpy as np\[CloseCurlyDoubleQuote] line below. \
\>", "Text",
 CellChangeTimes->{{3.797410989418001*^9, 3.797411025541195*^9}, {
  3.798650189925866*^9, 
  3.798650215682035*^9}},ExpressionUUID->"414eac6c-e016-46d3-a263-\
511d3c12a90a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"outdir", "=", 
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Input_ham_cr/\>\""}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"strm", "=", 
     RowBox[{"OpenWrite", "[", 
      RowBox[{"outdir", "<>", "\"\<ham_cr.py\>\""}], "]"}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"strm", "=", 
    RowBox[{"OpenAppend", "[", 
     RowBox[{"outdir", "<>", "\"\<ham_cr.py\>\""}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"strm", ",", 
    RowBox[{"FormatType", "\[Rule]", "OutputForm"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetOptions", "[", 
    RowBox[{"strm", ",", 
     RowBox[{"PageWidth", "\[Rule]", "Infinity"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pointGroup", "=", "\"\<C4v\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"varsString", "=", 
    RowBox[{"{", 
     RowBox[{
     "\"\<x0\>\"", ",", "\"\<x1\>\"", ",", "\"\<x2\>\"", ",", "\"\<x3\>\"", 
      ",", "\"\<x4\>\"", ",", " ", "\"\<x5\>\""}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Write", "[", 
   RowBox[{"strm", ",", 
    RowBox[{
    "\"\<# Module creates crystal field Hamiltonian matrix for point group \
(PG) C4v and J = \>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{"N", "[", "JVal", "]"}], "]"}], "<>", 
     "\"\<.\\n# Number of crystal field variables is 5 (and sign of x5): {x0, \
x1, x2, x3, x4, sign(x5)}.\>\""}]}], "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Write", "[", 
    RowBox[{"strm", ",", "\"\<import numpy as np\>\""}], "]"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Write", "[", 
  RowBox[{"strm", ",", " ", 
   RowBox[{
   "\"\<def ham_cr_PG_\>\"", "<>", "pointGroup", "<>", "\"\<_J_\>\"", "<>", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"ToString", "[", 
       RowBox[{"N", "[", "JVal", "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"Shortest", "[", 
        RowBox[{"i__", "~~", "\"\<.\>\"", "~~", "j__"}], "]"}], "\[Rule]", 
       RowBox[{"i", "~~", "\"\<_\>\"", "~~", "j"}]}]}], "]"}], "<>", 
    "\"\<(\>\"", "<>", 
    RowBox[{"varsString", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "<>", "\"\<, \>\"", "<>", 
    RowBox[{"varsString", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "<>", "\"\<, \>\"", "<>", 
    RowBox[{"varsString", "[", 
     RowBox[{"[", "3", "]"}], "]"}], "<>", "\"\<, \>\"", "<>", 
    RowBox[{"varsString", "[", 
     RowBox[{"[", "4", "]"}], "]"}], "<>", "\"\<, \>\"", "<>", 
    RowBox[{"varsString", "[", 
     RowBox[{"[", "5", "]"}], "]"}], "<>", "\"\<, \>\"", "<>", 
    RowBox[{"varsString", "[", 
     RowBox[{"[", "6", "]"}], "]"}], "<>", "\"\<):\>\""}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Write", "[", 
   RowBox[{"strm", ",", 
    RowBox[{"\"\<\\t\>\"", "<>", "\"\<J = \>\"", "<>", " ", 
     RowBox[{"ToString", "[", 
      RowBox[{"N", "[", "JVal", "]"}], "]"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Write", "[", 
   RowBox[{"strm", ",", 
    RowBox[{"\"\<\\t\>\"", "<>", "\"\<dim = int(2*J+1)\>\""}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Write", "[", 
   RowBox[{"strm", ",", 
    RowBox[{
    "\"\<\\t\>\"", "<>", 
     "\"\<ham = np.arange(dim*dim, dtype=np.float)\>\""}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Write", "[", 
   RowBox[{"strm", ",", 
    RowBox[{"\"\<\\t\>\"", "<>", "\"\<ham = ham.reshape(dim,dim)\>\""}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"idx", "=", "0"}], ",", 
   RowBox[{"idx", "<", 
    RowBox[{"Length", "[", 
     RowBox[{"ham", "[", 
      RowBox[{"x0", ",", "x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5"}], 
      "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"jdx", "=", "0"}], ",", 
      RowBox[{"jdx", "<", 
       RowBox[{"Length", "[", 
        RowBox[{"ham", "[", 
         RowBox[{
         "x0", ",", "x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5"}], "]"}],
         "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tmp", "=", 
        RowBox[{"ConvertToPyString", "[", 
         RowBox[{
          RowBox[{"ham", "[", 
           RowBox[{
           "x0", ",", "x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5"}], 
           "]"}], "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"idx", "+", "1"}], ",", 
            RowBox[{"jdx", "+", "1"}]}], "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Write", "[", 
        RowBox[{"strm", ",", 
         RowBox[{"\"\<\\t\>\"", "<>", "\"\<ham[\>\"", "<>", 
          RowBox[{"ToString", "[", "idx", "]"}], "<>", "\"\<][\>\"", "<>", 
          RowBox[{"ToString", "[", "jdx", "]"}], "<>", "\"\<] = \>\"", "<>", 
          "tmp"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"jdx", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"idx", "++"}], ";"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Write", "[", 
    RowBox[{"strm", ",", 
     RowBox[{"\"\<\\t\>\"", "<>", "\"\<return ham\>\""}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", " ", "[", 
     RowBox[{
      RowBox[{"index", "=", "1"}], ",", 
      RowBox[{"index", "\[LessEqual]", 
       RowBox[{"Length", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{"ham", "[", "x", "]"}], "]"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"label", " ", "=", " ", 
        RowBox[{"\"\<# Element \>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"index", " ", "-", " ", "1"}], "]"}], " ", "<>", 
         "\"\<\\n\>\""}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{
         RowBox[{"ConvertToPyString", "[", 
          RowBox[{"W", "*", 
           RowBox[{"ham", "[", "x", "]"}]}], "]"}], "\"\<\\n\>\""}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Write", "[", 
        RowBox[{"strm", ",", " ", "label"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Write", "[", 
        RowBox[{"strm", ",", " ", "tmp"}], "]"}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"index", "++"}]}]}], "\[IndentingNewLine]", "]"}], ";"}], 
   "\[IndentingNewLine]", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Close", "[", "strm", "]"}]}], "Input",
 CellChangeTimes->{{3.797261935202834*^9, 3.797261982709478*^9}, {
   3.797262013965489*^9, 3.797262051348982*^9}, {3.797262335959133*^9, 
   3.7972623815014544`*^9}, 3.797262427221718*^9, {3.797266888096942*^9, 
   3.797267015952709*^9}, {3.7972671843860807`*^9, 3.797267196986126*^9}, {
   3.797270231651085*^9, 3.797270236074506*^9}, {3.797270292842783*^9, 
   3.797270580170759*^9}, {3.797272912045128*^9, 3.797272917523796*^9}, {
   3.7972729920677567`*^9, 3.79727318620399*^9}, 3.797273315333137*^9, {
   3.797273475335691*^9, 3.797273524621703*^9}, {3.797273559862084*^9, 
   3.797273569452402*^9}, {3.797273681508535*^9, 3.797273702828506*^9}, 
   3.7972739801683903`*^9, 3.7972740463108187`*^9, {3.797274082205628*^9, 
   3.797274124732308*^9}, {3.7972741647722883`*^9, 3.797274203885873*^9}, {
   3.797274283221828*^9, 3.7972743047964287`*^9}, {3.7972743678766317`*^9, 
   3.79727437209227*^9}, {3.797274502044259*^9, 3.797274765276348*^9}, {
   3.7972749534688063`*^9, 3.7972749750917997`*^9}, {3.7972751965084352`*^9, 
   3.797275262893379*^9}, {3.7972753702688007`*^9, 3.797275380468472*^9}, 
   3.797275755293952*^9, {3.797276355982937*^9, 3.797276396637413*^9}, {
   3.797276542686059*^9, 3.797276572213047*^9}, {3.797276979701881*^9, 
   3.797277077452806*^9}, {3.797277425470429*^9, 3.797277427708932*^9}, {
   3.797277531934023*^9, 3.797277577164948*^9}, {3.797277659094515*^9, 
   3.797277681141062*^9}, {3.79727781107787*^9, 3.7972778907410107`*^9}, {
   3.797278024198574*^9, 3.797278031765902*^9}, {3.797278091061487*^9, 
   3.7972780914453983`*^9}, {3.7974464682023087`*^9, 
   3.7974465001163473`*^9}, {3.797446545036593*^9, 3.797446545924204*^9}, {
   3.798621978910795*^9, 3.798621992611054*^9}, {3.798622062749778*^9, 
   3.798622126403528*^9}, {3.798650110542528*^9, 3.798650117234069*^9}, {
   3.79865018340699*^9, 3.798650185093807*^9}, {3.798904159319667*^9, 
   3.798904209649302*^9}, 3.798904552281777*^9, {3.799122049377425*^9, 
   3.7991220662140827`*^9}, {3.799122178044877*^9, 3.7991221965034246`*^9}, {
   3.799122286877605*^9, 3.799122293599984*^9}, {3.7994786377456293`*^9, 
   3.7994786606329603`*^9}, {3.799478730265254*^9, 3.799478730606552*^9}, {
   3.7994849980804577`*^9, 3.799485000832799*^9}},
 CellLabel->
  "In[929]:=",ExpressionUUID->"39f09912-8e2b-41ce-b895-c4e3595bb652"],

Cell["\<\
Energy spectrum as a function of crystal field parameter x (setting W = 1).\
\>", "Text",
 CellChangeTimes->{{3.7974110323239393`*^9, 
  3.797411051605345*^9}},ExpressionUUID->"50e7e180-bf6d-4ead-b0b6-\
c8355f64d4e9"],

Cell[BoxData[
 RowBox[{"plot1", "=", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"Sort", "[", 
     RowBox[{
      RowBox[{"esys", "[", 
       RowBox[{"1", ",", "0.2", ",", "x", ",", 
        RowBox[{"-", "0.2"}], ",", "0.15", ",", "1"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<E/x0\>\"", ",", "\"\<\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<x4\>\"", ",", "\"\<\>\""}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"Directive", "[", "Blue", "]"}]}], ",", " ", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"Thickness", "[", "0.0025", "]"}], ",", 
       RowBox[{"FontSize", "\[Rule]", "14"}], ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.796660288131609*^9, 3.796660308531536*^9}, {
  3.796660375760756*^9, 3.796660383352623*^9}, {3.7967502105470667`*^9, 
  3.7967502377208014`*^9}, {3.796750381125403*^9, 3.796750426440358*^9}, {
  3.7967504619482527`*^9, 3.7967505605332336`*^9}, {3.7967506415632267`*^9, 
  3.796750642344624*^9}, {3.796901500735393*^9, 3.796901502349043*^9}, {
  3.796923661767095*^9, 3.7969236636434717`*^9}, {3.796924078244068*^9, 
  3.796924092974341*^9}, {3.7990715570808563`*^9, 3.799071643162817*^9}, {
  3.799071837110753*^9, 3.799071847834877*^9}, {3.799072103100527*^9, 
  3.799072121665756*^9}, {3.799121418829997*^9, 3.799121456217017*^9}, {
  3.799121603126279*^9, 3.7991216084397306`*^9}, {3.79912220407338*^9, 
  3.799122204377499*^9}},
 CellLabel->
  "In[213]:=",ExpressionUUID->"d4afdea5-aeeb-4e1e-b7d5-2c81750e4d5e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"10", "^", "4"}], ")"}], "^", 
   RowBox[{"(", 
    RowBox[{"1", "/", "5"}], ")"}]}], "//", "N"}]], "Input",
 CellChangeTimes->{{3.79907204101052*^9, 3.799072064684408*^9}},
 CellLabel->
  "In[168]:=",ExpressionUUID->"824237e9-073c-4faa-ae92-8315245077bb"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"Plot3D", "[", 
   RowBox[{
    RowBox[{"Sort", "[", 
     RowBox[{
      RowBox[{"esys", "[", 
       RowBox[{"1", ",", "0.2", ",", "x", ",", "0", ",", "y"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"y", ",", 
      RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
    RowBox[{"PlotPoints", "\[Rule]", "10"}], ",", 
    RowBox[{"Mesh", "\[Rule]", "All"}], ",", 
    RowBox[{"MaxRecursion", "\[Rule]", "0"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.799071657919037*^9, 3.799071693308012*^9}, {
  3.79907212798214*^9, 3.799072152427339*^9}, {3.7990723995984297`*^9, 
  3.79907242917094*^9}},
 CellLabel->
  "In[173]:=",ExpressionUUID->"e2979ea0-3207-407b-8f7c-868d4db03d19"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{
    "\"\<../Notes_Peter/Graphics/Energies-J_4-B_0-BST.pdf\>\"", ",", " ", 
     "plot1"}], "]"}]}], "\[IndentingNewLine]", "*)"}]], "Input",
 CellChangeTimes->{{3.797169660485691*^9, 
  3.797169733261634*^9}},ExpressionUUID->"e56768df-2302-4602-9a0f-\
0315112710a8"],

Cell["\<\
For a random choice of W and x we find the level spectrum and associated \
partition function (at B=0). Find numerical eigenvalues (with lowest one set \
to zero) and eigenstates for that W and x: called energies and evecs.\
\>", "Text",
 CellChangeTimes->{{3.7970827426845922`*^9, 3.797082783840917*^9}, {
  3.797082978577118*^9, 
  3.797083019581115*^9}},ExpressionUUID->"05313c9a-c033-4f8d-a5ed-\
548940947b0c"],

Cell[BoxData[{
 RowBox[{"WVal", "=", "4.25"}], "\[IndentingNewLine]", 
 RowBox[{"xVal", "=", 
  RowBox[{"-", "0.32", 
   RowBox[{"(*", 
    RowBox[{"-", "0.32"}], "*)"}]}]}]}], "Input",
 CellChangeTimes->{{3.797357491852181*^9, 3.7973574991633577`*^9}, {
  3.797357578731799*^9, 3.797357586611557*^9}, {3.797411058838107*^9, 
  3.797411061429859*^9}, {3.797439002077861*^9, 3.797439007365304*^9}, {
  3.797861328039669*^9, 3.797861331254691*^9}, {3.797861489911742*^9, 
  3.797861490782529*^9}, {3.797861524535771*^9, 3.7978615280465393`*^9}, {
  3.7978615591675158`*^9, 3.7978615829986134`*^9}, {3.797862430503572*^9, 
  3.797862510423088*^9}, {3.7978726615536633`*^9, 3.797872664207889*^9}, {
  3.797872887009087*^9, 3.797872896825186*^9}, {3.797872971769289*^9, 
  3.79787298718382*^9}, {3.797875873075204*^9, 3.79787587407414*^9}, {
  3.797878353266358*^9, 3.797878381384943*^9}, {3.797882434485785*^9, 
  3.797882439012787*^9}},
 CellLabel->
  "In[453]:=",ExpressionUUID->"677dd59d-98f6-462a-a8f5-2926bebbf43d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{"WVal", "*", 
    RowBox[{
     RowBox[{"esys", "[", "xVal", "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"energies", "=", 
   RowBox[{"temp", "-", 
    RowBox[{"Min", "[", "temp", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"evecs", "=", 
   RowBox[{
    RowBox[{"esys", "[", "xVal", "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Zcr", "[", "Temp_", "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"energies", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "/", "Temp"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "energies", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.797082819112352*^9, 3.79708281928535*^9}, {
   3.797082934987808*^9, 3.797082967965996*^9}, {3.797083051134324*^9, 
   3.797083055826861*^9}, 3.7970960250450373`*^9, {3.797096110974231*^9, 
   3.797096112653965*^9}},
 CellLabel->
  "In[455]:=",ExpressionUUID->"de23ec7e-998d-436f-bcbc-6f7cfb3edba0"],

Cell[BoxData[
 RowBox[{"plot1", "=", 
  RowBox[{"ListPlot", "[", 
   RowBox[{
    RowBox[{"Sort", "[", "energies", "]"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "10"}], "}"}], ",", "Automatic"}], "}"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.796932106125465*^9, 3.7969321211145697`*^9}, {
  3.7969323689530487`*^9, 3.79693246184328*^9}, {3.797082708844481*^9, 
  3.797082715042218*^9}, {3.797169922681107*^9, 3.7971699233440723`*^9}},
 CellLabel->
  "In[459]:=",ExpressionUUID->"8dbdd770-6520-474b-a4a2-eefd3d6bce3e"],

Cell["Magnetic Jz expectation values of the different levels", "Text",
 CellChangeTimes->{{3.797096529184803*^9, 
  3.797096544645657*^9}},ExpressionUUID->"89d11009-a713-42a8-ae0e-\
7d7ba60d3a84"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"WVal", "*", 
    RowBox[{
     RowBox[{"esys", "[", "xVal", "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "-", 
   RowBox[{"Min", "[", 
    RowBox[{"WVal", "*", 
     RowBox[{
      RowBox[{"esys", "[", "xVal", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "//", 
  "Chop"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Conjugate", "[", 
      RowBox[{"Normalize", "[", 
       RowBox[{
        RowBox[{"esys", "[", "xVal", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "i"}], "]"}], "]"}], "]"}], "]"}], ".", "JzOp", 
     ".", 
     RowBox[{"Normalize", "[", 
      RowBox[{
       RowBox[{"esys", "[", "xVal", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "i"}], "]"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{
       RowBox[{"2", "*", "JVal"}], "+", "1"}]}], "}"}]}], "]"}], "//", 
  "Chop"}]}], "Input",
 CellChangeTimes->{{3.797093190611351*^9, 3.7970932180792503`*^9}, {
  3.797093253296327*^9, 3.797093316758301*^9}, {3.797096524906625*^9, 
  3.797096525653751*^9}, {3.7978613532720337`*^9, 3.7978613539831057`*^9}, {
  3.7978614174962378`*^9, 3.797861427199119*^9}, {3.797861597311604*^9, 
  3.79786159810277*^9}, {3.797861769928259*^9, 3.7978617744066133`*^9}, {
  3.797861854400024*^9, 3.797861867846881*^9}},
 CellLabel->
  "In[423]:=",ExpressionUUID->"bc7eb4c8-c6b4-4285-aa5a-e7d0caaca755"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"WVal", "*", 
    RowBox[{
     RowBox[{"esys", "[", "xVal", "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "-", 
   RowBox[{"Min", "[", 
    RowBox[{"WVal", "*", 
     RowBox[{
      RowBox[{"esys", "[", "xVal", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "//", 
  "Chop"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"esys", "[", "xVal", "]"}], "[", 
  RowBox[{"[", 
   RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.797861879543489*^9, 3.797861948254446*^9}},
 CellLabel->
  "In[217]:=",ExpressionUUID->"65f41ba2-c9c9-4e24-a79b-62e70bd5933a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Specific heat", "Subsection",
 CellChangeTimes->{
  3.7969240324035873`*^9, {3.796924410869841*^9, 3.7969244150530243`*^9}, {
   3.796925959211782*^9, 
   3.796925960854185*^9}},ExpressionUUID->"06860581-da56-4aea-aee3-\
70e6d4e4f284"],

Cell["\<\
Specific heat cV/kB. Enter energies and Temperature (Temp) in Kelvin. \
\>", "Text",
 CellChangeTimes->{{3.7969311498218527`*^9, 
  3.796931198623749*^9}},ExpressionUUID->"76099d19-4838-4310-97b3-\
43d07b372029"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"cVOverkB", "[", "Temp_", "]"}], ":=", 
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"Temp", "^", "2"}]}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"1", "/", 
        RowBox[{"Zcr", "[", "Temp", "]"}]}], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"energies", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "^", "2"}], "*", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"energies", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "/", "Temp"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "energies", "]"}]}], "}"}]}], "]"}]}], "-", 
      
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{"Zcr", "[", "Temp", "]"}]}], "*", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"energies", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "*", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"energies", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "/", "Temp"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "energies", "]"}]}], "}"}]}], "]"}]}], 
        ")"}], "^", "2"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.796926979792131*^9, 3.7969271048098993`*^9}, 
   3.796931147117601*^9, {3.7969311823582697`*^9, 3.7969311824794207`*^9}, {
   3.7969312126058826`*^9, 3.7969312172307367`*^9}, {3.796931258023196*^9, 
   3.7969313150286703`*^9}, {3.7969329721765747`*^9, 3.79693298676687*^9}, {
   3.797026627954834*^9, 3.7970266291532927`*^9}, {3.797082599131392*^9, 
   3.7970826000070353`*^9}, {3.7970828249944696`*^9, 3.7970828303844757`*^9}, 
   3.797096038077091*^9},
 CellLabel->
  "In[460]:=",ExpressionUUID->"f1a79c07-11ef-46c9-964c-1d58b52f2919"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Quiet", "[", 
   RowBox[{"maxy", "=", 
    RowBox[{
     RowBox[{"FindMaxValue", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"cVOverkB", "[", "Temp", "]"}], ",", 
         RowBox[{
          RowBox[{"Temp", ">", "0"}], "&&", 
          RowBox[{"Temp", "<", "300"}]}]}], "}"}], ",", 
       RowBox[{"{", "Temp", "}"}]}], "]"}], "*", "1.1"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GapAboveGSVal", "=", 
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Sort", "[", "energies", "]"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "-", 
         RowBox[{
          RowBox[{"Sort", "[", "energies", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{
           RowBox[{"Length", "[", "energies", "]"}], "-", "1"}]}], "}"}]}], 
       "]"}], ",", 
      RowBox[{
       RowBox[{"#", ">", "0"}], "&"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lineGapAboveGS", "=", 
   RowBox[{"Line", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"GapAboveGSVal", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"GapAboveGSVal", ",", "maxy"}], "}"}]}], "}"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.79706244662847*^9, 3.7970625220042973`*^9}, {
   3.797062558115399*^9, 3.7970625824583797`*^9}, 3.797062798717841*^9, {
   3.797062834719076*^9, 3.797062942118616*^9}, 3.797082837003025*^9},
 CellLabel->
  "In[461]:=",ExpressionUUID->"948d88c3-0a66-4c8a-91d3-ab5267e33e0b"],

Cell[BoxData[
 RowBox[{"plot1", "=", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"cVOverkB", "[", "Temp", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"Temp", ",", "1", ",", "300"}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(c\), \(V\)]\)/\!\(\*SubscriptBox[\(k\), \(B\
\)]\) (dimensionless)\>\"", ",", "\"\<\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<T (Kelvin)\>\"", ",", "\"\<\>\""}], "}"}]}], "}"}]}], 
    ",", 
    RowBox[{"Epilog", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{"Dashed", ",", " ", "Red"}], "]"}], ",", "lineGapAboveGS"}], 
      "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"Thickness", "[", "0.0025", "]"}], ",", 
       RowBox[{"FontSize", "\[Rule]", "14"}], ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.796931219243614*^9, 3.796931228437479*^9}, {
  3.796931770546015*^9, 3.796931802507873*^9}, {3.7969330051706953`*^9, 
  3.796933009185679*^9}, {3.797026633860376*^9, 3.797026664080826*^9}, {
  3.79702670858775*^9, 3.797026717364566*^9}, {3.797062588394966*^9, 
  3.797062659604664*^9}, {3.797062945438847*^9, 3.797062956104608*^9}, {
  3.797062986583458*^9, 3.797062994271462*^9}, {3.797169876368163*^9, 
  3.797169876806964*^9}, {3.7971747331118717`*^9, 3.79717473876569*^9}, {
  3.797174773160492*^9, 3.797174773989563*^9}, {3.79717499330341*^9, 
  3.797175038902234*^9}, {3.797175308007824*^9, 3.79717531383041*^9}},
 CellLabel->
  "In[464]:=",ExpressionUUID->"0ba11338-6f72-426c-bf1d-eff804895058"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"\"\<../Notes_Peter/Graphics/cV-J_4-W_\>\"", "~~", 
      RowBox[{"ToString", "[", "WVal", "]"}], "~~", "\"\<-x_\>\"", "~~", 
      RowBox[{"ToString", "[", "xVal", "]"}], "~~", "\"\<.pdf\>\""}], ",", 
     " ", "plot1"}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.7971697910121307`*^9, 3.797169844877747*^9}, 
   3.7971698870628843`*^9, {3.797357639316393*^9, 
   3.797357641047388*^9}},ExpressionUUID->"9bb7c9e6-bc4a-41f2-aecf-\
6fe26c876941"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Magnetization in finite magnetic field and magnetic susceptibility\
\>", "Subsection",
 CellChangeTimes->{{3.79709104619378*^9, 3.797091063478002*^9}, {
  3.797102375276865*^9, 
  3.797102396139666*^9}},ExpressionUUID->"1ede7757-ae35-463e-bd31-\
1ff8f72dfc91"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Entity", "[", 
    RowBox[{"\"\<PhysicalConstant\>\"", ",", "\"\<BoltzmannConstant\>\""}], 
    "]"}], "[", "\"\<Value\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Entity", "[", 
    RowBox[{"\"\<PhysicalConstant\>\"", ",", "\"\<BohrMagneton\>\""}], "]"}], 
   "[", "\"\<Value\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/", "%%"}], ";"}]}], "Input",
 CellChangeTimes->{
  3.797091130674865*^9, {3.79709150239548*^9, 3.797091584189026*^9}, {
   3.79709181325438*^9, 3.797091817539772*^9}, {3.797092026755538*^9, 
   3.797092032995563*^9}, {3.797169753667864*^9, 3.7971697573468933`*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"2e2b1749-301b-47bf-af19-69a0a2af3f17"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"263", "/", "6.51"}]}]], "Input",
 CellChangeTimes->{{3.797101918185444*^9, 3.7971019417999773`*^9}, 
   3.7971020149791813`*^9},
 CellLabel->
  "In[141]:=",ExpressionUUID->"81d3a329-6d96-46db-9af0-26f617db6cc2"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"kBVal", "=", 
     FractionBox["1380649", "100000000000000000000000000000"]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "\[Mu]BVal", "=", 
     "9.2740100783000004424165405042207403`9.219079536512577*^-24"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"\[Mu]BVal", "/", "kBVal"}]}]}]], "Input",
 CellChangeTimes->{{3.797092038757635*^9, 3.7970920615092897`*^9}},
 CellLabel->
  "In[219]:=",ExpressionUUID->"144ad3bd-a10c-4a58-adff-d482027be62c"],

Cell[CellGroupData[{

Cell["Magnetic field along z", "Subsubsection",
 CellChangeTimes->{{3.797091867319274*^9, 
  3.797091881074354*^9}},ExpressionUUID->"ff893d72-0187-4490-b99e-\
e6c815041ad0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"hamB", "[", 
    RowBox[{"Bfield_", ",", "W_", ",", "x_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"W", "*", 
      RowBox[{"ham", "[", "x", "]"}]}], "-", 
     RowBox[{
      RowBox[{"gJLS", "[", 
       RowBox[{"JVal", ",", "LVal", ",", "SVal"}], "]"}], "*", 
      RowBox[{"\[Mu]BVal", "/", "kBVal"}], "*", "JzOp", "*", "Bfield"}]}], "//",
     "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "MatrixForm"}], ";"}]}], "Input",
 CellChangeTimes->{{3.797091064331895*^9, 3.797091128686928*^9}, {
   3.797091779730118*^9, 3.7970917978472*^9}, {3.797091844726115*^9, 
   3.797091903384541*^9}, {3.797092070896071*^9, 3.797092117997636*^9}, 
   3.797092233665975*^9, 3.797092273944283*^9, 3.797092316377521*^9, {
   3.7970925655526667`*^9, 3.797092576402527*^9}, 3.7970960542870407`*^9},
 CellLabel->
  "In[233]:=",ExpressionUUID->"c912519f-ff15-439a-b182-fbd6c6107aba"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"esysB", "[", 
     RowBox[{"Bfield_", ",", "W_", ",", "x_"}], "]"}], ":=", 
    RowBox[{"Eigensystem", "[", 
     RowBox[{"hamB", "[", 
      RowBox[{"Bfield", ",", "W", ",", "x"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ZB", "[", 
    RowBox[{"Bfield_", ",", "Temp_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"esysB", "[", 
            RowBox[{"Bfield", ",", "WVal", ",", "xVal"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "i"}], "]"}], "]"}], "-", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{"esysB", "[", 
             RowBox[{"Bfield", ",", "WVal", ",", "xVal"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ")"}]}], "/", "Temp"}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{
        RowBox[{"2", "*", "JVal"}], "+", "1"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.797092303909333*^9, 3.7970924393080797`*^9}, {
   3.797092510287903*^9, 3.797092643733098*^9}, {3.797092711299571*^9, 
   3.797092721618252*^9}, {3.797093510139996*^9, 3.797093511284247*^9}, {
   3.7970955196946783`*^9, 3.7970955204649343`*^9}, 3.797096060624319*^9},
 CellLabel->
  "In[224]:=",ExpressionUUID->"35cc76a4-e51b-4cbe-a70c-60bce70c4c70"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"gJLS", "[", 
     RowBox[{"JVal", ",", "LVal", ",", "SVal"}], "]"}], "*", 
    RowBox[{"\[Mu]BVal", "/", "kBVal"}], "*", "JzOp", "*", "1"}], "//", 
   "MatrixForm"}], ";"}]], "Input",
 CellChangeTimes->{{3.797093677185074*^9, 3.797093697849971*^9}, 
   3.797096074448151*^9},
 CellLabel->
  "In[226]:=",ExpressionUUID->"4556d91f-e6db-4aef-8708-54a17648cf7c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"esysB", "[", 
   RowBox[{"1", ",", "1", ",", 
    RowBox[{"-", "0.32"}]}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Sort", "[", 
  RowBox[{"%", "-", 
   RowBox[{"Min", "[", "%", "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.797358213520982*^9, 3.797358242883663*^9}, {
  3.7973583081013737`*^9, 3.797358330355772*^9}},
 CellLabel->
  "In[227]:=",ExpressionUUID->"5e105eb2-94dc-412f-a6b1-8e7fa6d5cc79"],

Cell[BoxData[
 RowBox[{"plot1", "=", 
  RowBox[{"ListPlot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Sort", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"esysB", "[", 
          RowBox[{"0", ",", "WVal", ",", "xVal"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"esysB", "[", 
           RowBox[{"0", ",", "WVal", ",", "xVal"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"Sort", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"esysB", "[", 
          RowBox[{"2", ",", "WVal", ",", "xVal"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"esysB", "[", 
           RowBox[{"2", ",", "WVal", ",", "xVal"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"Sort", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"esysB", "[", 
          RowBox[{"10", ",", "WVal", ",", "xVal"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"esysB", "[", 
           RowBox[{"10", ",", "WVal", ",", "xVal"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(E\), \(i\)]\)(B)-\!\(\*SubscriptBox[\(E\), \
\(GS\)]\)(B)  (K)\>\"", ",", "\"\<\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<Eigenstate index i\>\"", ",", "\"\<\>\""}], "}"}]}], 
      "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"Thickness", "[", "0.0025", "]"}], ",", 
       RowBox[{"FontSize", "\[Rule]", "14"}], ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "10"}], "}"}], ",", "Automatic"}], "}"}]}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"Placed", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<B=0\>\"", ",", " ", "\"\<B=2T\>\"", ",", " ", "\"\<B=10T\>\""}], 
        "}"}], ",", "Above"}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.796932106125465*^9, 3.7969321211145697`*^9}, {
  3.7969323689530487`*^9, 3.79693246184328*^9}, {3.797082708844481*^9, 
  3.797082715042218*^9}, {3.797093396870356*^9, 3.797093485958498*^9}, {
  3.7970935339539137`*^9, 3.7970935359882793`*^9}, {3.797093579643457*^9, 
  3.7970936548623457`*^9}, {3.797169953529686*^9, 3.797169955241962*^9}, {
  3.797174143877552*^9, 3.797174266324847*^9}, {3.797174337222294*^9, 
  3.797174408549038*^9}, {3.7971747544643507`*^9, 3.797174755661996*^9}, {
  3.797174889948656*^9, 3.7971749084621964`*^9}, {3.7971752315373096`*^9, 
  3.797175271894486*^9}},
 CellLabel->
  "In[229]:=",ExpressionUUID->"346a7552-1b0b-4b25-8b86-fda3e65f4dba"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"\"\<../Notes_Peter/Graphics/Spectrum_Vs_B-J_4-W_\>\"", "~~", 
      RowBox[{"ToString", "[", "WVal", "]"}], "~~", "\"\<-x_\>\"", "~~", 
      RowBox[{"ToString", "[", "xVal", "]"}], "~~", "\"\<.pdf\>\""}], ",", 
     " ", "plot1"}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.797174417004724*^9, 3.797174418884845*^9}, {
  3.797358205004739*^9, 
  3.797358210637102*^9}},ExpressionUUID->"8b787401-bc63-4096-b6bc-\
b1ae54c70585"],

Cell[BoxData[{
 RowBox[{"WVal", "=", "4.25"}], "\[IndentingNewLine]", 
 RowBox[{"xVal", "=", "1"}], "\[IndentingNewLine]", 
 RowBox[{"BminVal", "=", "0.001"}]}], "Input",
 CellChangeTimes->{{3.797864800474155*^9, 3.797864804280871*^9}, {
   3.797864858257777*^9, 3.797864947744698*^9}, 3.79787236808969*^9},
 CellLabel->
  "In[356]:=",ExpressionUUID->"ba2f4c2f-8244-4d9e-8935-fe8f0faeeeb8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"esysB", "[", 
   RowBox[{"BminVal", ",", "WVal", ",", "xVal"}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Conjugate", "[", 
     RowBox[{
      RowBox[{"esysB", "[", 
       RowBox[{"BminVal", ",", "WVal", ",", "xVal"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "i"}], "]"}], "]"}], "]"}], ".", "JzOp", ".", 
    RowBox[{
     RowBox[{"esysB", "[", 
      RowBox[{"BminVal", ",", "WVal", ",", "xVal"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", "i"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{
      RowBox[{"2", "*", "JVal"}], "+", "1"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7978723789213257`*^9, 3.797872382392186*^9}},
 CellLabel->
  "In[359]:=",ExpressionUUID->"c2682267-2fa3-40d1-b3b4-7701871ac07c"],

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Conjugate", "[", 
     RowBox[{
      RowBox[{"esys", "[", "xVal", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "i"}], "]"}], "]"}], "]"}], ".", "JzOp", ".", 
    RowBox[{
     RowBox[{"esys", "[", "xVal", "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", "i"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{
      RowBox[{"2", "*", "JVal"}], "+", "1"}]}], "}"}]}], "]"}]], "Input",
 CellLabel->
  "In[313]:=",ExpressionUUID->"159bd0af-b731-432f-af3f-7bba990888e3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"WVal", "*", 
   RowBox[{
    RowBox[{"esys", "[", "xVal", "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"ListPlot", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Chop", "[", 
         RowBox[{
          RowBox[{"Conjugate", "[", 
           RowBox[{
            RowBox[{"esys", "[", "xVal", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "i"}], "]"}], "]"}], "]"}], ".", "JzOp", ".", 
          RowBox[{
           RowBox[{"esys", "[", "xVal", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "i"}], "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{
           RowBox[{"2", "*", "JVal"}], "+", "1"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"xVal", ",", 
        RowBox[{"-", "1"}], ",", "1", ",", "0.01"}], "}"}]}], "]"}], "]"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"plot", "=", 
  RowBox[{"ListPlot", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{
           RowBox[{"esysB", "[", 
            RowBox[{"BminVal", ",", "WVal", ",", "xVal"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "i"}], "]"}], "]"}], "]"}], ".", "JzOp", ".", 
         RowBox[{
          RowBox[{"esysB", "[", 
           RowBox[{"BminVal", ",", "WVal", ",", "xVal"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "i"}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{
           RowBox[{"2", "*", "JVal"}], "+", "1"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"xVal", ",", 
        RowBox[{"-", "1"}], ",", "1", ",", "0.01"}], "}"}]}], "]"}], ",", " ", 
    RowBox[{"Epilog", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{"Dashed", ",", "Red"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "2.5"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"9", ",", 
            RowBox[{"-", "2.5"}]}], "}"}]}], "}"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "2.5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"9", ",", "2.5"}], "}"}]}], "}"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "0.5"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"9", ",", 
            RowBox[{"-", "0.5"}]}], "}"}]}], "}"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0.5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"9", ",", "0.5"}], "}"}]}], "}"}], "]"}]}], "}"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}]}], 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.797093190611351*^9, 3.7970932180792503`*^9}, {
   3.797093253296327*^9, 3.797093316758301*^9}, {3.7970935596895037`*^9, 
   3.7970935609004803`*^9}, {3.797864831361746*^9, 3.797864879125102*^9}, {
   3.797864952970232*^9, 3.797865085201283*^9}, 3.7978718337777348`*^9, {
   3.797871899715857*^9, 3.797871909344805*^9}, {3.797871993242395*^9, 
   3.797872296576542*^9}},
 CellLabel->
  "In[353]:=",ExpressionUUID->"734fc895-9863-44f5-af29-f4bbef22e57e"],

Cell["Magnetization in finite field", "Text",
 CellChangeTimes->{{3.79709245886586*^9, 3.7970924678399563`*^9}, {
  3.797097004106513*^9, 3.797097006350685*^9}, {3.797102404987516*^9, 
  3.79710240569556*^9}},
 Background->GrayLevel[
  0.85],ExpressionUUID->"cf354d25-31dd-4436-af10-cf35055a9f68"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"magZ", "[", 
    RowBox[{"Bfield_", ",", "Temp_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"ZB", "[", 
      RowBox[{"Bfield", ",", "Temp"}], "]"}]}], "*", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Conjugate", "[", 
         RowBox[{
          RowBox[{"esysB", "[", 
           RowBox[{"Bfield", ",", "WVal", ",", "xVal"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "i"}], "]"}], "]"}], "]"}], ".", "JzOp", ".", 
        RowBox[{
         RowBox[{"esysB", "[", 
          RowBox[{"Bfield", ",", "WVal", ",", "xVal"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "i"}], "]"}], "]"}]}], " ", "*", 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"esysB", "[", 
              RowBox[{"Bfield", ",", "WVal", ",", "xVal"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "i"}], "]"}], "]"}], "-", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"esysB", "[", 
               RowBox[{"Bfield", ",", "WVal", ",", "xVal"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ")"}]}], "/", "Temp"}],
         "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{
         RowBox[{"2", "*", "JVal"}], "+", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.797092468495714*^9, 3.79709250035081*^9}, {
   3.797092651331514*^9, 3.7970927961129827`*^9}, {3.797095445201747*^9, 
   3.797095449037384*^9}, {3.7970958842573023`*^9, 3.797095891615671*^9}, 
   3.797095978403713*^9, 3.7970972689182568`*^9},
 CellLabel->
  "In[185]:=",ExpressionUUID->"e0c1a2ab-400c-48a4-8436-9d12005c28f7"],

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"esysB", "[", 
         RowBox[{"1", ",", "WVal", ",", "xVal"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "i"}], "]"}], "]"}], "]"}], ".", "JzOp", ".", 
      RowBox[{
       RowBox[{"esysB", "[", 
        RowBox[{"1", ",", "WVal", ",", "xVal"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "i"}], "]"}], "]"}]}], "*", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"esysB", "[", 
            RowBox[{"1", ",", "WVal", ",", "xVal"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "i"}], "]"}], "]"}], "-", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{"esysB", "[", 
             RowBox[{"1", ",", "WVal", ",", "xVal"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ")"}]}], " ", "/", "1"}],
       "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{
       RowBox[{"2", "*", "JVal"}], "+", "1"}]}], "}"}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.79735838047291*^9, 3.797358401845393*^9}, {
   3.797358477214653*^9, 3.797358481676236*^9}, {3.797359168126816*^9, 
   3.797359253676956*^9}, 3.797439164550324*^9},
 CellLabel->
  "In[170]:=",ExpressionUUID->"02b19725-73d9-48cf-b356-17f29f181128"],

Cell[BoxData[
 RowBox[{"plot1", "=", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"magZ", "[", 
       RowBox[{"B", ",", "1"}], "]"}], ",", 
      RowBox[{"magZ", "[", 
       RowBox[{"B", ",", "6.69"}], "]"}], ",", 
      RowBox[{"magZ", "[", 
       RowBox[{"B", ",", "44.8"}], "]"}], ",", 
      RowBox[{"magZ", "[", 
       RowBox[{"B", ",", "300"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"B", ",", "0", ",", "10"}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(M\), \
\(z\)]\)/(\!\(\*SubscriptBox[\(\[Mu]\), \(B\)]\)\!\(\*SubscriptBox[\(g\), \(J\
\)]\))\>\"", ",", "\"\<\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<B (T)\>\"", ",", "\"\<\>\""}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"Placed", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<T=1K\>\"", ",", "\"\<T=50K\>\"", ",", "\"\<T=100K\>\"", ",", 
         "\"\<T=300K\>\""}], "}"}], ",", "Above"}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.79709279725414*^9, 3.79709283037326*^9}, {
   3.797092895029755*^9, 3.797092895446526*^9}, 3.7970937485300703`*^9, {
   3.797097011149433*^9, 3.797097025966505*^9}, {3.797097104784625*^9, 
   3.797097120523793*^9}, {3.797097153877613*^9, 3.797097162955976*^9}, {
   3.797097216753148*^9, 3.7970972202747927`*^9}, {3.797097279270802*^9, 
   3.797097283677964*^9}, {3.797097540282523*^9, 3.797097575449111*^9}, {
   3.797175376143649*^9, 3.797175425518318*^9}, {3.797175473535611*^9, 
   3.797175476043096*^9}, {3.797361538734376*^9, 3.797361546877021*^9}},
 CellLabel->
  "In[171]:=",ExpressionUUID->"b7edd98f-7e78-4967-a4c5-400fd9ea1b12"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"SetDirectory", "[", 
     RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"\"\<../Notes_Peter/Graphics/MagnetizationZ_Vs_B-J_4-W_\>\"", "~~", 
       RowBox[{"ToString", "[", "WVal", "]"}], "~~", "\"\<-x_\>\"", "~~", 
       RowBox[{"ToString", "[", "xVal", "]"}], "~~", "\"\<.pdf\>\""}], ",", 
      " ", "plot1"}], "]"}]}], "*)"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.797175431938917*^9, 3.797175447492741*^9}, 
   3.79717568021587*^9, {3.797439168565961*^9, 
   3.797439170637067*^9}},ExpressionUUID->"ebc4e241-70b4-4d92-b795-\
557efbebf93d"],

Cell[BoxData[
 RowBox[{"plot1", "=", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"magZ", "[", 
      RowBox[{"B", ",", "1"}], "]"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"B", ",", "0", ",", "50"}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(M\), \(z\)]\)/\!\(\*SubscriptBox[\(\[Mu]\), \
\(B\)]\)\!\(\*SubscriptBox[\(g\), \(J\)]\)\>\"", ",", "\"\<\>\""}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"\"\<B (T)\>\"", ",", "\"\<\>\""}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", "\"\<Expressions\>\""}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.797102240765374*^9, 3.7971022487091293`*^9}, {
  3.797102326203043*^9, 3.797102327118113*^9}, {3.7971756571273203`*^9, 
  3.797175657766761*^9}, {3.79717606172987*^9, 3.79717606178377*^9}},
 CellLabel->
  "In[142]:=",ExpressionUUID->"34077929-1b8c-4cf7-b5ac-83a17e1ca879"],

Cell[BoxData[{
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{
   "\"\<../Notes_Peter/Graphics/MagnetizationZ_Vs_B-Larger_B-J_4-W_\>\"", "~~", 
    RowBox[{"ToString", "[", "WVal", "]"}], "~~", "\"\<-x_\>\"", "~~", 
    RowBox[{"ToString", "[", "xVal", "]"}], "~~", "\"\<.pdf\>\""}], ",", " ", 
   "plot1"}], "]"}]}], "Input",
 CellChangeTimes->{{3.797176072064929*^9, 3.797176080263286*^9}},
 CellLabel->
  "In[143]:=",ExpressionUUID->"03ca9e7b-9c81-4ebe-93c3-77bc26f06225"],

Cell["Susceptibility", "Text",
 CellChangeTimes->{{3.7971023556973143`*^9, 3.797102363156039*^9}},
 Background->GrayLevel[
  0.85],ExpressionUUID->"bb0d8127-896d-4b02-aed3-a7e79e37542b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BfieldVal", "=", "0.001"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"chiZ", "[", "Temp_", "]"}], ":=", 
   RowBox[{"gVal", "*", "\[Mu]BVal", "*", 
    RowBox[{
     RowBox[{"magZ", "[", 
      RowBox[{"BfieldVal", ",", "Temp"}], "]"}], "/", "BfieldVal"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.797097222219215*^9, 3.7970972662744427`*^9}, 
   3.7970973201114397`*^9, {3.7970975959393806`*^9, 3.79709765000082*^9}, {
   3.797100860125086*^9, 3.797100864221684*^9}},
 CellLabel->
  "In[176]:=",ExpressionUUID->"7bff04ec-4d38-47ab-b42f-23380aab8520"],

Cell[BoxData[
 RowBox[{"plot2", "=", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"chiZ", "[", "Temp", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"Temp", ",", "1", ",", "300"}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(\[Chi]\), \(z\)]\) for single ion (dimless)\
\>\"", ",", "\"\<\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<T (K)\>\"", ",", "\"\<\>\""}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.797097324961033*^9, 3.7970973499365063`*^9}, {
  3.7970977000898647`*^9, 3.797097720238015*^9}, {3.797102200890143*^9, 
  3.7971022180246077`*^9}, {3.797175717647236*^9, 3.797175746798649*^9}, {
  3.797175780248435*^9, 3.797175805534971*^9}},
 CellLabel->
  "In[178]:=",ExpressionUUID->"8b6a6dd1-d65f-4d89-8859-814427466d16"],

Cell[BoxData[
 RowBox[{"plot2", "=", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"chiZ", "[", "Temp", "]"}], "/", "gVal"}], "/", "\[Mu]BVal"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"Temp", ",", "1", ",", "300"}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(\[Chi]\), \(z\)]\)/(\!\(\*SubscriptBox[\(\
\[Mu]\), \(B\)]\)*\!\(\*SubscriptBox[\(g\), \(JLS\)]\)) for single ion \
(dimless)\>\"", ",", "\"\<\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<T (K)\>\"", ",", "\"\<\>\""}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7974395800298443`*^9, 3.797439600717285*^9}},
 CellLabel->
  "In[189]:=",ExpressionUUID->"882d33dd-54ea-4c62-8a7b-a273309caff1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"chiZ", "[", "15", "]"}], "/", "gVal"}], "/", 
  "\[Mu]BVal"}]], "Input",
 CellChangeTimes->{{3.797439044169868*^9, 3.797439050957301*^9}, 
   3.797439177797879*^9, {3.7974395592225723`*^9, 3.797439565965206*^9}},
 CellLabel->
  "In[182]:=",ExpressionUUID->"46f2eb91-23dc-4a3c-aed3-b4efc97019ee"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"\"\<../Notes_Peter/Graphics/SusceptibilityZ_Vs_T-J_4-W_\>\"", "~~", 
      RowBox[{"ToString", "[", "WVal", "]"}], "~~", "\"\<-x_\>\"", "~~", 
      RowBox[{"ToString", "[", "xVal", "]"}], "~~", "\"\<.pdf\>\""}], ",", 
     " ", "plot2"}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.797175668046732*^9, 3.797175675846446*^9}, {
  3.797175740806499*^9, 3.797175740870315*^9}, {3.797175795871879*^9, 
  3.7971758018805428`*^9}, {3.7974390396532516`*^9, 
  3.7974390420978317`*^9}},ExpressionUUID->"a47f8f71-61fc-4b77-bb7e-\
e92487af2e7f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Mu]BVal", "^", "2"}], "*", 
  RowBox[{
   RowBox[{"gVal", "^", "2"}], "/", "kBVal"}], "*", "JVal", "*", 
  RowBox[{"(", 
   RowBox[{"JVal", "+", "1"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.797101238532258*^9, 3.797101276417392*^9}},
 CellLabel->
  "In[136]:=",ExpressionUUID->"0a37809f-5836-4683-b583-d30d28dbe925"],

Cell[BoxData[
 RowBox[{"6", "*", 
  RowBox[{"10", "^", "23"}], "*", "40", "*", "5", "*", 
  RowBox[{"10", "^", 
   RowBox[{"(", 
    RowBox[{"-", "25"}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.797102178150481*^9, 3.7971021915664873`*^9}, 
   3.797102345961636*^9},ExpressionUUID->"997545e5-c8ee-4c2d-83fa-\
e3f2945faee4"],

Cell["\<\
Check that I am getting the correct van-Vleck susceptibility in the low \
temperature limit. Important: this requires that the GS be the singlet and I \
need to use the energy splitting to the triplet with dipole moment 1/2. This \
depends on the choice of W and x and since these are randomly drawn, the two \
cells below may not work if the ground state is different or the triplet is \
not the first excited state (this occurs for x=-0.380623, for which I have \
checked my calculation). \
\>", "Text",
 CellChangeTimes->{{3.7970968647143*^9, 
  3.7970969933233213`*^9}},ExpressionUUID->"034e29e3-ef41-4f92-b6f7-\
c247211537b1"],

Cell[BoxData["xVal"], "Input",
 CellChangeTimes->{{3.79709697446278*^9, 
  3.797096998594058*^9}},ExpressionUUID->"5ec6be1c-bc83-48a3-9957-\
bdf4a048d64a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"kBVal", "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"gJLS", "[", 
      RowBox[{"JVal", ",", "LVal", ",", "SVal"}], "]"}], "*", "\[Mu]BVal"}], 
    ")"}]}], "*", 
  RowBox[{
   RowBox[{"magZ", "[", 
    RowBox[{"0.01", ",", "1"}], "]"}], "/", "0.01"}]}]], "Input",
 CellChangeTimes->{{3.797094020834476*^9, 3.797094048870845*^9}, {
   3.797094322261258*^9, 3.797094330128172*^9}, {3.797095454047832*^9, 
   3.797095460074473*^9}, {3.797095814642474*^9, 3.79709582333989*^9}, {
   3.7970960994682703`*^9, 3.797096101943779*^9}, {3.797096670767456*^9, 
   3.79709667394707*^9}, {3.7970967728621683`*^9, 3.797096783757464*^9}, {
   3.7970968329987707`*^9, 3.7970968382661257`*^9}, 3.7970974055264177`*^9},
 CellLabel->
  "In[123]:=",ExpressionUUID->"5eddfc5b-9155-4a81-a49c-16ceadc24271"],

Cell[BoxData[
 RowBox[{
  RowBox[{"40", "/", "3"}], "/", 
  RowBox[{
   RowBox[{"Sort", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"esysB", "[", 
       RowBox[{"0", ",", "WVal", ",", "xVal"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "-", 
     RowBox[{"Min", "[", 
      RowBox[{
       RowBox[{"esysB", "[", 
        RowBox[{"0", ",", "WVal", ",", "xVal"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], "[", 
   RowBox[{"[", "2", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7970939979411287`*^9, 3.797094012980019*^9}, {
  3.797094075908804*^9, 3.7970940981513977`*^9}, {3.797095057281535*^9, 
  3.797095068934136*^9}, {3.797096117629939*^9, 3.797096142761301*^9}, {
  3.797096651072448*^9, 3.797096653110276*^9}},
 CellLabel->
  "In[107]:=",ExpressionUUID->"1bac5a65-2da4-4d5f-ac54-6dd3dc8e0378"],

Cell[BoxData[{
 RowBox[{"kBVal", "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"gJLS", "[", 
     RowBox[{"JVal", ",", "LVal", ",", "SVal"}], "]"}], "*", "\[Mu]BVal"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gJLS", "[", 
   RowBox[{"JVal", ",", "LVal", ",", "SVal"}], "]"}], "*", 
  "\[Mu]BVal"}]}], "Input",
 CellChangeTimes->{{3.797097448334342*^9, 3.7970974485314617`*^9}},
 CellLabel->
  "In[125]:=",ExpressionUUID->"d42837e5-fade-4045-9dd6-7c3468d79ee8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Magnetic field along x", "Subsubsection",
 CellChangeTimes->{{3.797091867319274*^9, 3.797091881074354*^9}, {
  3.797185074070167*^9, 
  3.797185074144825*^9}},ExpressionUUID->"34b28dc7-1161-4e63-9c89-\
ba6e6fd217e1"],

Cell[BoxData[{"WVal", "\[IndentingNewLine]", "xVal"}], "Input",
 CellChangeTimes->{{3.7971866120877447`*^9, 3.7971866150453167`*^9}},
 CellLabel->
  "In[248]:=",ExpressionUUID->"b3567c3e-4a05-47fe-9c53-d6c0a701a8cf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"hamBX", "[", 
    RowBox[{"Bfield_", ",", "W_", ",", "x_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"W", "*", 
      RowBox[{"ham", "[", "x", "]"}]}], "-", 
     RowBox[{
      RowBox[{"gJLS", "[", 
       RowBox[{"JVal", ",", "LVal", ",", "SVal"}], "]"}], "*", 
      RowBox[{"\[Mu]BVal", "/", "kBVal"}], "*", "JxOp", "*", "Bfield"}]}], "//",
     "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "MatrixForm"}], ";"}]}], "Input",
 CellChangeTimes->{{3.797091064331895*^9, 3.797091128686928*^9}, {
   3.797091779730118*^9, 3.7970917978472*^9}, {3.797091844726115*^9, 
   3.797091903384541*^9}, {3.797092070896071*^9, 3.797092117997636*^9}, 
   3.797092233665975*^9, 3.797092273944283*^9, 3.797092316377521*^9, {
   3.7970925655526667`*^9, 3.797092576402527*^9}, 3.7970960542870407`*^9, {
   3.797185082118867*^9, 3.79718508495817*^9}, {3.79718662375134*^9, 
   3.797186648269558*^9}, {3.797186686390986*^9, 3.797186690149913*^9}},
 CellLabel->
  "In[250]:=",ExpressionUUID->"7a7f7822-04ab-425c-998c-173dd85f6d70"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"esysB", "[", 
     RowBox[{"Bfield_", ",", "W_", ",", "x_"}], "]"}], ":=", 
    RowBox[{"Eigensystem", "[", 
     RowBox[{"hamBX", "[", 
      RowBox[{"Bfield", ",", "W", ",", "x"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ZB", "[", 
    RowBox[{"Bfield_", ",", "Temp_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"esysB", "[", 
            RowBox[{"Bfield", ",", "WVal", ",", "xVal"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "i"}], "]"}], "]"}], "-", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{"esysB", "[", 
             RowBox[{"Bfield", ",", "WVal", ",", "xVal"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ")"}]}], "/", "Temp"}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{
        RowBox[{"2", "*", "JVal"}], "+", "1"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.797092303909333*^9, 3.7970924393080797`*^9}, {
   3.797092510287903*^9, 3.797092643733098*^9}, {3.797092711299571*^9, 
   3.797092721618252*^9}, {3.797093510139996*^9, 3.797093511284247*^9}, {
   3.7970955196946783`*^9, 3.7970955204649343`*^9}, 3.797096060624319*^9, 
   3.79718509215942*^9},
 CellLabel->
  "In[252]:=",ExpressionUUID->"e52bd640-030d-415a-bcc4-0a0e09f9a172"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"gJLS", "[", 
     RowBox[{"JVal", ",", "LVal", ",", "SVal"}], "]"}], "*", 
    RowBox[{"\[Mu]BVal", "/", "kBVal"}], "*", "JzOp", "*", "1"}], "//", 
   "MatrixForm"}], ";"}]], "Input",
 CellChangeTimes->{{3.797093677185074*^9, 3.797093697849971*^9}, 
   3.797096074448151*^9},
 CellLabel->
  "In[254]:=",ExpressionUUID->"5ed5baf7-e6ad-4db5-bff8-fba54eb722bb"],

Cell[BoxData[
 RowBox[{"plot2", "=", 
  RowBox[{"ListPlot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Sort", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"esysB", "[", 
          RowBox[{"0", ",", "WVal", ",", "xVal"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"esysB", "[", 
           RowBox[{"0", ",", "WVal", ",", "xVal"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"Sort", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"esysB", "[", 
          RowBox[{"2", ",", "WVal", ",", "xVal"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"esysB", "[", 
           RowBox[{"2", ",", "WVal", ",", "xVal"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"Sort", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"esysB", "[", 
          RowBox[{"10", ",", "WVal", ",", "xVal"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"esysB", "[", 
           RowBox[{"10", ",", "WVal", ",", "xVal"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(E\), \(i\)]\)(B)-\!\(\*SubscriptBox[\(E\), \
\(GS\)]\)(B)  (K)\>\"", ",", "\"\<\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<Eigenstate index i\>\"", ",", "\"\<\>\""}], "}"}]}], 
      "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"Thickness", "[", "0.0025", "]"}], ",", 
       RowBox[{"FontSize", "\[Rule]", "14"}], ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "10"}], "}"}], ",", "Automatic"}], "}"}]}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"Placed", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<B=0\>\"", ",", " ", "\"\<B=2T\>\"", ",", " ", "\"\<B=10T\>\""}], 
        "}"}], ",", "Above"}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.796932106125465*^9, 3.7969321211145697`*^9}, {
  3.7969323689530487`*^9, 3.79693246184328*^9}, {3.797082708844481*^9, 
  3.797082715042218*^9}, {3.797093396870356*^9, 3.797093485958498*^9}, {
  3.7970935339539137`*^9, 3.7970935359882793`*^9}, {3.797093579643457*^9, 
  3.7970936548623457`*^9}, {3.797169953529686*^9, 3.797169955241962*^9}, {
  3.797174143877552*^9, 3.797174266324847*^9}, {3.797174337222294*^9, 
  3.797174408549038*^9}, {3.7971747544643507`*^9, 3.797174755661996*^9}, {
  3.797174889948656*^9, 3.7971749084621964`*^9}, {3.7971752315373096`*^9, 
  3.797175271894486*^9}, {3.7971867368688593`*^9, 3.797186736926545*^9}},
 CellLabel->
  "In[255]:=",ExpressionUUID->"a73950a5-610b-4923-9214-7e7d22e58908"],

Cell[BoxData[{
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"\"\<../Notes_Peter/Graphics/Spectrum_Vs_BX-J_4-W_\>\"", "~~", 
    RowBox[{"ToString", "[", "WVal", "]"}], "~~", "\"\<-x_\>\"", "~~", 
    RowBox[{"ToString", "[", "xVal", "]"}], "~~", "\"\<.pdf\>\""}], ",", " ", 
   "plot1"}], "]"}]}], "Input",
 CellChangeTimes->{{3.797174417004724*^9, 3.797174418884845*^9}, 
   3.797185135503376*^9},
 CellLabel->
  "In[151]:=",ExpressionUUID->"c78caa70-1521-4b63-8e33-4519f4609274"],

Cell[BoxData[{
 RowBox[{"WVal", "*", 
  RowBox[{
   RowBox[{"esys", "[", "xVal", "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Conjugate", "[", 
      RowBox[{
       RowBox[{"esys", "[", "xVal", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "i"}], "]"}], "]"}], "]"}], ".", "JzOp", ".", 
     RowBox[{
      RowBox[{"esys", "[", "xVal", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "i"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{
       RowBox[{"2", "*", "JVal"}], "+", "1"}]}], "}"}]}], "]"}], "//", 
  "Chop"}]}], "Input",
 CellChangeTimes->{{3.797093190611351*^9, 3.7970932180792503`*^9}, {
  3.797093253296327*^9, 3.797093316758301*^9}, {3.7970935596895037`*^9, 
  3.7970935609004803`*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"13eeddb8-4ce5-48ad-87c6-893320599124"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"esys", "[", "xVal", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "i"}], "]"}], "]"}], ".", "JzOp", ".", 
     RowBox[{
      RowBox[{"esys", "[", "xVal", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{
       RowBox[{"2", "*", "JVal"}], "+", "1"}]}], "}"}]}], "]"}], "//", 
  "Chop"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sqrt", "[", 
   RowBox[{"20", "/", "3"}], "]"}], "//", "N"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"energies", "[", 
   RowBox[{"[", "5", "]"}], "]"}], "-", 
  RowBox[{"energies", "[", 
   RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"40", "/", "3"}], "/", "%"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.797095088111053*^9, 3.797095183295354*^9}, {
  3.797095282764439*^9, 3.7970953628113117`*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"6ff25cc1-338f-4415-9b55-34a056486aea"],

Cell["Magnetization in finite field", "Text",
 CellChangeTimes->{{3.79709245886586*^9, 3.7970924678399563`*^9}, {
  3.797097004106513*^9, 3.797097006350685*^9}, {3.797102404987516*^9, 
  3.79710240569556*^9}},
 Background->GrayLevel[
  0.85],ExpressionUUID->"6647bf51-373f-4044-84ee-64d04c39bf02"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"magX", "[", 
    RowBox[{"Bfield_", ",", "Temp_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"ZB", "[", 
      RowBox[{"Bfield", ",", "Temp"}], "]"}]}], "*", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Conjugate", "[", 
         RowBox[{
          RowBox[{"esysB", "[", 
           RowBox[{"Bfield", ",", "WVal", ",", "xVal"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "i"}], "]"}], "]"}], "]"}], ".", "JxOp", ".", 
        RowBox[{
         RowBox[{"esysB", "[", 
          RowBox[{"Bfield", ",", "WVal", ",", "xVal"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "i"}], "]"}], "]"}]}], " ", "*", 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"esysB", "[", 
              RowBox[{"Bfield", ",", "WVal", ",", "xVal"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "i"}], "]"}], "]"}], "-", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"esysB", "[", 
               RowBox[{"Bfield", ",", "WVal", ",", "xVal"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ")"}]}], "/", "Temp"}],
         "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{
         RowBox[{"2", "*", "JVal"}], "+", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.797092468495714*^9, 3.79709250035081*^9}, {
   3.797092651331514*^9, 3.7970927961129827`*^9}, {3.797095445201747*^9, 
   3.797095449037384*^9}, {3.7970958842573023`*^9, 3.797095891615671*^9}, 
   3.797095978403713*^9, 3.7970972689182568`*^9, {3.797185147207944*^9, 
   3.79718514739859*^9}, {3.7971852408480387`*^9, 3.797185241006818*^9}},
 CellLabel->
  "In[257]:=",ExpressionUUID->"b9177ed6-6edd-4a1a-bf55-e5aa703bf89f"],

Cell[BoxData[
 RowBox[{"plot1", "=", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"magX", "[", 
       RowBox[{"B", ",", "1"}], "]"}], ",", 
      RowBox[{"magX", "[", 
       RowBox[{"B", ",", "50"}], "]"}], ",", 
      RowBox[{"magX", "[", 
       RowBox[{"B", ",", "100"}], "]"}], ",", 
      RowBox[{"magX", "[", 
       RowBox[{"B", ",", "300"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"B", ",", "0", ",", "10"}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(M\), \
\(x\)]\)/(\!\(\*SubscriptBox[\(\[Mu]\), \(B\)]\)\!\(\*SubscriptBox[\(g\), \(J\
\)]\))\>\"", ",", "\"\<\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<B (T)\>\"", ",", "\"\<\>\""}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"Placed", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<T=1K\>\"", ",", "\"\<T=50K\>\"", ",", "\"\<T=100K\>\"", ",", 
         "\"\<T=300K\>\""}], "}"}], ",", "Above"}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.79709279725414*^9, 3.79709283037326*^9}, {
   3.797092895029755*^9, 3.797092895446526*^9}, 3.7970937485300703`*^9, {
   3.797097011149433*^9, 3.797097025966505*^9}, {3.797097104784625*^9, 
   3.797097120523793*^9}, {3.797097153877613*^9, 3.797097162955976*^9}, {
   3.797097216753148*^9, 3.7970972202747927`*^9}, {3.797097279270802*^9, 
   3.797097283677964*^9}, {3.797097540282523*^9, 3.797097575449111*^9}, {
   3.797175376143649*^9, 3.797175425518318*^9}, {3.797175473535611*^9, 
   3.797175476043096*^9}, {3.797185149688875*^9, 3.797185155846217*^9}, {
   3.7971852332791233`*^9, 3.797185237918827*^9}},
 CellLabel->
  "In[258]:=",ExpressionUUID->"7188d7b6-b445-4505-ad8b-24528cbd0740"],

Cell[BoxData[{
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"\"\<../Notes_Peter/Graphics/MagnetizationX_Vs_B-J_4-W_\>\"", "~~", 
    RowBox[{"ToString", "[", "WVal", "]"}], "~~", "\"\<-x_\>\"", "~~", 
    RowBox[{"ToString", "[", "xVal", "]"}], "~~", "\"\<.pdf\>\""}], ",", " ", 
   "plot1"}], "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.797175431938917*^9, 3.797175447492741*^9}, 
   3.79717568021587*^9, {3.7971852547672586`*^9, 
   3.7971852549743967`*^9}},ExpressionUUID->"db53fecd-8a03-44fd-8648-\
39de6e087834"],

Cell[BoxData[
 RowBox[{"plot1", "=", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"magX", "[", 
      RowBox[{"B", ",", "1"}], "]"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"B", ",", "0", ",", "50"}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(M\), \(x\)]\)/\!\(\*SubscriptBox[\(\[Mu]\), \
\(B\)]\)\!\(\*SubscriptBox[\(g\), \(J\)]\)\>\"", ",", "\"\<\>\""}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"\"\<B (T)\>\"", ",", "\"\<\>\""}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", "\"\<Expressions\>\""}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.797102240765374*^9, 3.7971022487091293`*^9}, {
  3.797102326203043*^9, 3.797102327118113*^9}, {3.7971756571273203`*^9, 
  3.797175657766761*^9}, {3.79717606172987*^9, 3.79717606178377*^9}, {
  3.7971852616157084`*^9, 
  3.797185264606319*^9}},ExpressionUUID->"927d8808-feb6-456a-a10f-\
ce9a3c9a891d"],

Cell[BoxData[{
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{
   "\"\<../Notes_Peter/Graphics/MagnetizationX_Vs_B-Larger_B-J_4-W_\>\"", "~~", 
    RowBox[{"ToString", "[", "WVal", "]"}], "~~", "\"\<-x_\>\"", "~~", 
    RowBox[{"ToString", "[", "xVal", "]"}], "~~", "\"\<.pdf\>\""}], ",", " ", 
   "plot1"}], "]"}]}], "Input",
 CellChangeTimes->{{3.797176072064929*^9, 3.797176080263286*^9}, 
   3.797185269319586*^9},ExpressionUUID->"80285532-9ea0-4b57-99cf-\
e1850840351e"],

Cell["Susceptibility", "Text",
 CellChangeTimes->{{3.7971023556973143`*^9, 3.797102363156039*^9}},
 Background->GrayLevel[
  0.85],ExpressionUUID->"cf8e0122-8790-40c9-bc74-2f9484a4d204"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BfieldVal", "=", "0.001"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"chiX", "[", "Temp_", "]"}], ":=", 
   RowBox[{"gVal", "*", "\[Mu]BVal", "*", 
    RowBox[{
     RowBox[{"magX", "[", 
      RowBox[{"BfieldVal", ",", "Temp"}], "]"}], "/", "BfieldVal"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.797097222219215*^9, 3.7970972662744427`*^9}, 
   3.7970973201114397`*^9, {3.7970975959393806`*^9, 3.79709765000082*^9}, {
   3.797100860125086*^9, 3.797100864221684*^9}, {3.797185275007655*^9, 
   3.797185277334392*^9}},ExpressionUUID->"3e58c8cb-3de4-478f-a754-\
0abe725acac7"],

Cell[BoxData[
 RowBox[{"plot2", "=", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"chiX", "[", "Temp", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"Temp", ",", "1", ",", "300"}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(\[Chi]\), \(x\)]\) for single ion (dimless)\
\>\"", ",", "\"\<\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<T (K)\>\"", ",", "\"\<\>\""}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.797097324961033*^9, 3.7970973499365063`*^9}, {
  3.7970977000898647`*^9, 3.797097720238015*^9}, {3.797102200890143*^9, 
  3.7971022180246077`*^9}, {3.797175717647236*^9, 3.797175746798649*^9}, {
  3.797175780248435*^9, 3.797175805534971*^9}, {3.797185279358679*^9, 
  3.797185283190592*^9}},ExpressionUUID->"796767f5-49a7-4ebe-be02-\
a010dcc53630"],

Cell[BoxData[{
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"\"\<../Notes_Peter/Graphics/SusceptibilityX_Vs_T-J_4-W_\>\"", "~~", 
    RowBox[{"ToString", "[", "WVal", "]"}], "~~", "\"\<-x_\>\"", "~~", 
    RowBox[{"ToString", "[", "xVal", "]"}], "~~", "\"\<.pdf\>\""}], ",", " ", 
   "plot2"}], "]"}]}], "Input",
 CellChangeTimes->{{3.797175668046732*^9, 3.797175675846446*^9}, {
  3.797175740806499*^9, 3.797175740870315*^9}, {3.797175795871879*^9, 
  3.7971758018805428`*^9}, {3.79718528729462*^9, 
  3.797185287462672*^9}},ExpressionUUID->"5cacc7cc-e915-417e-9cc0-\
5b8eb56d5162"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Mu]BVal", "^", "2"}], "*", 
  RowBox[{
   RowBox[{"gVal", "^", "2"}], "/", "kBVal"}], "*", "JVal", "*", 
  RowBox[{"(", 
   RowBox[{"JVal", "+", "1"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.797101238532258*^9, 3.797101276417392*^9}},
 CellLabel->
  "In[136]:=",ExpressionUUID->"ad151e83-9aaf-4014-8c49-42ba3de228bb"],

Cell[BoxData[
 RowBox[{"6", "*", 
  RowBox[{"10", "^", "23"}], "*", "40", "*", "5", "*", 
  RowBox[{"10", "^", 
   RowBox[{"(", 
    RowBox[{"-", "25"}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.797102178150481*^9, 3.7971021915664873`*^9}, 
   3.797102345961636*^9},ExpressionUUID->"0a727bbc-9378-4876-84d4-\
1f3889b20c38"],

Cell["\<\
Check that I am getting the correct van-Vleck susceptibility in the low \
temperature limit. Important: this requires that the GS be the singlet and I \
need to use the energy splitting to the triplet with dipole moment 1/2. This \
depends on the choice of W and x and since these are randomly drawn, the two \
cells below may not work if the ground state is different or the triplet is \
not the first excited state (this occurs for x=-0.380623, for which I have \
checked my calculation). \
\>", "Text",
 CellChangeTimes->{{3.7970968647143*^9, 
  3.7970969933233213`*^9}},ExpressionUUID->"da3c5765-e7d7-4d76-8c96-\
ccef7b9186f8"],

Cell[BoxData["xVal"], "Input",
 CellChangeTimes->{{3.79709697446278*^9, 
  3.797096998594058*^9}},ExpressionUUID->"afc47944-ed5b-4d40-92f6-\
8ed70f7232b2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"kBVal", "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"gJLS", "[", 
      RowBox[{"JVal", ",", "LVal", ",", "SVal"}], "]"}], "*", "\[Mu]BVal"}], 
    ")"}]}], "*", 
  RowBox[{
   RowBox[{"magZ", "[", 
    RowBox[{"0.01", ",", "1"}], "]"}], "/", "0.01"}]}]], "Input",
 CellChangeTimes->{{3.797094020834476*^9, 3.797094048870845*^9}, {
   3.797094322261258*^9, 3.797094330128172*^9}, {3.797095454047832*^9, 
   3.797095460074473*^9}, {3.797095814642474*^9, 3.79709582333989*^9}, {
   3.7970960994682703`*^9, 3.797096101943779*^9}, {3.797096670767456*^9, 
   3.79709667394707*^9}, {3.7970967728621683`*^9, 3.797096783757464*^9}, {
   3.7970968329987707`*^9, 3.7970968382661257`*^9}, 3.7970974055264177`*^9},
 CellLabel->
  "In[123]:=",ExpressionUUID->"70a57235-9781-49fb-8257-eab35c1e14b7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"40", "/", "3"}], "/", 
  RowBox[{
   RowBox[{"Sort", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"esysB", "[", 
       RowBox[{"0", ",", "WVal", ",", "xVal"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "-", 
     RowBox[{"Min", "[", 
      RowBox[{
       RowBox[{"esysB", "[", 
        RowBox[{"0", ",", "WVal", ",", "xVal"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], "[", 
   RowBox[{"[", "2", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7970939979411287`*^9, 3.797094012980019*^9}, {
  3.797094075908804*^9, 3.7970940981513977`*^9}, {3.797095057281535*^9, 
  3.797095068934136*^9}, {3.797096117629939*^9, 3.797096142761301*^9}, {
  3.797096651072448*^9, 3.797096653110276*^9}},
 CellLabel->
  "In[107]:=",ExpressionUUID->"39f779e0-b870-4909-b051-f9d5d4c29ca1"],

Cell[BoxData[{
 RowBox[{"kBVal", "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"gJLS", "[", 
     RowBox[{"JVal", ",", "LVal", ",", "SVal"}], "]"}], "*", "\[Mu]BVal"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gJLS", "[", 
   RowBox[{"JVal", ",", "LVal", ",", "SVal"}], "]"}], "*", 
  "\[Mu]BVal"}]}], "Input",
 CellChangeTimes->{{3.797097448334342*^9, 3.7970974485314617`*^9}},
 CellLabel->
  "In[125]:=",ExpressionUUID->"3e8ff3a5-d8b1-4b8a-8103-bc2ae42c999e"]
}, Closed]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "Training data: ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["D", 
    RowBox[{"3", "h"}]], TraditionalForm]],ExpressionUUID->
  "1e04dff6-c8ae-47b0-afdd-b4bd69d5b5d7"],
 "= symmetry"
}], "Section",
 CellChangeTimes->{{3.7969237703461857`*^9, 3.796923781980577*^9}, {
   3.7969259622094307`*^9, 3.796925976376203*^9}, {3.798607623413109*^9, 
   3.798607630071587*^9}, 3.798607816200563*^9, {3.799077426016786*^9, 
   3.799077433321159*^9}, {3.799477137255207*^9, 
   3.7994771373261213`*^9}},ExpressionUUID->"08d981c7-55c2-433b-9662-\
7a95f88bc061"],

Cell["\<\
There are two crystal field parameters {A[4,4], A[6,4]} = {W, x}, where -1 <= \
x <= 1. Here, W sets the band width of the crystal field spectrum (band width \
= approx. W/10) and x depends on the ratio of A[4,4] and A[6,4]. We thus draw \
two random numbers to set W and x. We express energies in Kelvin and thus \
draw W in the range 10 K - 300 K. This is a rough range of crystal field \
energies. \
\>", "Text",
 CellChangeTimes->{{3.796925985532331*^9, 3.796926119622555*^9}, {
  3.796926197131414*^9, 3.796926197190735*^9}, {3.796926606571512*^9, 
  3.79692660936616*^9}, {3.796932542201441*^9, 
  3.796932561977922*^9}},ExpressionUUID->"d5eeaf90-e7fb-4621-aa8e-\
f27f6135cd2a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"x0MinVal", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x0MaxVal", "=", "30"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"x0Val", "=", 
  RowBox[{"RandomReal", "[", 
   RowBox[{"{", 
    RowBox[{"x0MinVal", ",", "x0MaxVal"}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"x1Val", "=", 
  RowBox[{"RandomReal", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"x2Val", "=", 
  RowBox[{"RandomReal", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"x3Val", "=", 
  RowBox[{"RandomReal", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"x4Val", "=", 
  RowBox[{"RandomReal", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.7969265851578493`*^9, 3.796926651622409*^9}, {
  3.7969324850696917`*^9, 3.7969324856586533`*^9}, {3.796932566024177*^9, 
  3.796932574198258*^9}, {3.797410905134459*^9, 3.797410905933223*^9}, {
  3.799071253246426*^9, 3.799071273874688*^9}},
 CellLabel->
  "In[102]:=",ExpressionUUID->"06d12341-ef96-4712-9ebb-c85d74a1217e"],

Cell[CellGroupData[{

Cell["Crystal field Hamiltonian ", "Subsection",
 CellChangeTimes->{{3.796923783849966*^9, 3.796923797869154*^9}, {
  3.7969239115297403`*^9, 3.7969239219126368`*^9}, {3.7969259726549997`*^9, 
  3.7969259796325693`*^9}},ExpressionUUID->"6675d922-d7f1-4e04-a33a-\
bbfb65d3cd69"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PG", "=", 
   RowBox[{"GTInstallGroup", "[", 
    RowBox[{"D3h", ",", 
     RowBox[{"GOVerbose", "\[Rule]", "\"\<False\>\""}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.785269160622649*^9, {3.785269281480538*^9, 3.785269336414172*^9}, 
   3.786627168376821*^9, {3.796923821876587*^9, 3.796923822481081*^9}, {
   3.7986078392786283`*^9, 3.798607857913569*^9}, {3.7990774390198393`*^9, 
   3.799077440472958*^9}, {3.799477150444236*^9, 3.7994771505862923`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"92e61829-5656-4c9a-a7b7-defbb01814fe"],

Cell[BoxData[
 RowBox[{"vcr", "=", 
  RowBox[{"GTCrystalField", "[", 
   RowBox[{"PG", ",", "6"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.785269341649662*^9, 3.7852693624398003`*^9}, 
   3.796923935630218*^9, 3.797943202737104*^9, {3.798607844448896*^9, 
   3.798607852493536*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"99eaa392-cd03-4bb3-b792-50227372369b"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["Pr", 
      RowBox[{"3", "+"}]], " ", "has", " ", "ground", " ", "state", " ", 
     "term", " ", 
     SuperscriptBox[
      RowBox[{"symbol", " "}], "3"], 
     SubscriptBox["H", 
      RowBox[{"4", " "}]]}], 
    SuperscriptBox["=", 
     RowBox[{" ", 
      RowBox[{
       RowBox[{"2", "S"}], "+", "1"}]}]], 
    SubscriptBox["L", "J"]}], TraditionalForm]],ExpressionUUID->
  "8f5cb10e-8e47-44fd-acbe-335e7ac3d0d6"],
 " corresponding to S=1, L=5, J=4. The rare-earth ions in RMg2Cu9 compounds \
have ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["D", 
    RowBox[{"3", "h"}]], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "f3d33815-0e2a-4c68-b4f8-566cffd6fbd8"],
 " symmetry (see Kong thesis)."
}], "Text",
 CellChangeTimes->{{3.797091712406839*^9, 3.797091763734208*^9}, {
  3.797943739438446*^9, 3.797943774768508*^9}, {3.79947717837315*^9, 
  3.799477212217317*^9}},ExpressionUUID->"44e20855-5ec4-43bd-a466-\
659ef9d873d8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"JVal", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LVal", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SVal", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gJLS", "[", 
    RowBox[{"J_", ",", "L_", ",", "S_"}], "]"}], "=", 
   RowBox[{"1", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"J", "*", 
        RowBox[{"(", 
         RowBox[{"J", "+", "1"}], ")"}]}], "+", 
       RowBox[{"S", "*", 
        RowBox[{"(", 
         RowBox[{"S", "+", "1"}], ")"}]}], "-", 
       RowBox[{"L", "*", 
        RowBox[{"(", 
         RowBox[{"L", "+", "1"}], ")"}]}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"2", "*", "J", "*", 
       RowBox[{"(", 
        RowBox[{"J", "+", "1"}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gVal", "=", 
   RowBox[{"gJLS", "[", 
    RowBox[{"JVal", ",", "LVal", ",", "SVal"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.786640148438908*^9, 3.7866401487685127`*^9}, {
   3.7881950585497932`*^9, 3.788195058644024*^9}, {3.788195412637435*^9, 
   3.788195413708387*^9}, {3.788195886755945*^9, 3.78819588762637*^9}, {
   3.788196025865087*^9, 3.788196026015921*^9}, {3.796901445279166*^9, 
   3.7969014466723547`*^9}, 3.796901956860958*^9, {3.797091658869198*^9, 
   3.797091662472419*^9}, {3.7970917077388477`*^9, 3.797091710309637*^9}, {
   3.797096565075316*^9, 3.79709657248085*^9}, {3.799486370580567*^9, 
   3.799486397021027*^9}, 3.799486459052403*^9, {3.799486595218923*^9, 
   3.799486595547659*^9}, {3.799487029427882*^9, 3.799487030367547*^9}, {
   3.799487294205216*^9, 3.79948729504869*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"1775654f-7698-4d54-85b0-7bd87381c8f5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{
    RowBox[{"vcr", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Y", "[", 
        RowBox[{"ll_", ",", "mm_"}], "]"}], "\[RuleDelayed]", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "*", "ll"}], "+", "1"}], ")"}], "/", "4"}], "/", 
          "Pi"}], "]"}], "*", 
        RowBox[{"GTBSTOperator", "[", 
         RowBox[{"ll", ",", "mm", ",", "JVal"}], "]"}]}]}], "}"}]}], "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{"temp", "/.", 
    RowBox[{
     RowBox[{"A", "[", 
      RowBox[{"0", ",", "0"}], "]"}], "\[Rule]", "0"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matcrBST", "=", 
   RowBox[{"temp", "/.", 
    RowBox[{"{", 
     RowBox[{"r", "\[Rule]", "1"}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "MatrixForm"}], ";"}]}], "Input",
 CellChangeTimes->{{3.786627507720357*^9, 3.78662757792964*^9}, {
   3.7866277202481613`*^9, 3.786627735412421*^9}, {3.786627788623618*^9, 
   3.786627795672579*^9}, {3.786627923395748*^9, 3.786627953386715*^9}, {
   3.786628019298029*^9, 3.786628041536735*^9}, {3.786628426059493*^9, 
   3.786628461686534*^9}, {3.786628743577692*^9, 3.786628760372045*^9}, {
   3.7866400864895163`*^9, 3.78664015233587*^9}, {3.786640825633441*^9, 
   3.786640832701601*^9}, {3.786646996634104*^9, 3.786646999540801*^9}, {
   3.7866488342181587`*^9, 3.786648840252643*^9}, {3.7866491497723207`*^9, 
   3.786649155594781*^9}, {3.786649253814671*^9, 3.7866492654485893`*^9}, {
   3.7866494124688387`*^9, 3.786649414051375*^9}, {3.786649585012562*^9, 
   3.786649586039554*^9}, {3.78664990702824*^9, 3.786649915694008*^9}, {
   3.788195070645948*^9, 3.78819508183741*^9}, {3.7901104347783127`*^9, 
   3.7901104682891407`*^9}, {3.796657789537939*^9, 3.7966578185610228`*^9}, 
   3.7966578637771597`*^9, {3.796657927196455*^9, 3.796657936733631*^9}, {
   3.796658160029942*^9, 3.7966581781722927`*^9}, 3.796923929138701*^9, {
   3.7986079769773207`*^9, 3.798607989785933*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"be00cfc2-1d89-48f0-b649-48b4d3380bc0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"matA20", "=", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"matcrBST", ",", 
     RowBox[{"A", "[", 
      RowBox[{"2", ",", "0"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matA40", "=", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"matcrBST", ",", 
     RowBox[{"A", "[", 
      RowBox[{"4", ",", "0"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matA66", "=", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"matcrBST", ",", 
     RowBox[{"A", "[", 
      RowBox[{"6", ",", "6"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matA60", "=", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"matcrBST", ",", 
     RowBox[{"A", "[", 
      RowBox[{"6", ",", "0"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"A", "[", 
      RowBox[{"2", ",", "0"}], "]"}], "*", "matA20"}], "+", 
    RowBox[{
     RowBox[{"A", "[", 
      RowBox[{"4", ",", "0"}], "]"}], "*", "matA40"}], "+", 
    RowBox[{
     RowBox[{"A", "[", 
      RowBox[{"6", ",", "6"}], "]"}], "*", "matA66"}], "+", 
    RowBox[{
     RowBox[{"A", "[", 
      RowBox[{"6", ",", "0"}], "]"}], "*", "matA60"}], "+", 
    RowBox[{"-", "matcrBST"}]}], "//", "FullSimplify"}], ";"}]}], "Input",
 CellChangeTimes->{
  3.796658119511499*^9, {3.79665817602528*^9, 3.796658216521126*^9}, {
   3.796658250575593*^9, 3.7966583079603167`*^9}, {3.798607992815401*^9, 
   3.798608116468232*^9}, {3.799477232618101*^9, 3.799477287531905*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"935fb027-74eb-4d63-a42a-3765ca76e99e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"matA20", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matA40", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matA66", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matA60", "//", "MatrixForm"}], ";"}]}], "Input",
 CellChangeTimes->{{3.799071327183543*^9, 3.799071359761353*^9}, {
  3.7990715387787724`*^9, 3.7990715401599693`*^9}, {3.7994772927206163`*^9, 
  3.799477296147599*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"33e1a055-a1a2-41bb-9e0a-73550fc1ee28"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"matA20Av", "=", 
   RowBox[{
    RowBox[{"Norm", "[", 
     RowBox[{"Eigenvalues", "[", "matA20", "]"}], "]"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", "*", "JVal"}], "+", "1"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matA40Av", "=", 
   RowBox[{
    RowBox[{"Norm", "[", 
     RowBox[{"Eigenvalues", "[", "matA40", "]"}], "]"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", "*", "JVal"}], "+", "1"}], ")"}]}]}], ";", 
  RowBox[{"matA66Av", "=", 
   RowBox[{
    RowBox[{"Norm", "[", 
     RowBox[{"Eigenvalues", "[", "matA66", "]"}], "]"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", "*", "JVal"}], "+", "1"}], ")"}]}]}], ";", 
  RowBox[{"matA60Av", "=", 
   RowBox[{
    RowBox[{"Norm", "[", 
     RowBox[{"Eigenvalues", "[", "matA60", "]"}], "]"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", "*", "JVal"}], "+", "1"}], ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7966583111783867`*^9, 3.7966583147590723`*^9}, 
   3.796658356374555*^9, {3.796658433420876*^9, 3.7966584633918657`*^9}, {
   3.796658496436825*^9, 3.796658532089654*^9}, {3.796659172254266*^9, 
   3.796659339374614*^9}, {3.796659474082996*^9, 3.7966595613539248`*^9}, {
   3.796659600789694*^9, 3.796659662278084*^9}, {3.796659906477929*^9, 
   3.796659961441085*^9}, {3.7966600937494097`*^9, 3.796660134489295*^9}, {
   3.796660720624673*^9, 3.7966607296844482`*^9}, {3.796896789760777*^9, 
   3.7968968102344*^9}, {3.7968969371331*^9, 3.796896954700213*^9}, {
   3.79689925287754*^9, 3.79689927695789*^9}, {3.796923959503933*^9, 
   3.796923978059507*^9}, {3.798608126150509*^9, 3.798608173180851*^9}, {
   3.7986085965977907`*^9, 3.798608599104416*^9}, {3.799477300701129*^9, 
   3.799477306878825*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"0df3ed0b-3b40-43c5-b9bb-9384dbc5d32f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"matA20", "/", "matA20Av"}], "//", "MatrixForm"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"matA40", "/", "matA40Av"}], "//", "MatrixForm"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"matA66", "/", "matA66Av"}], "//", "MatrixForm"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"matA60", "/", "matA60Av"}], "//", "MatrixForm"}], ";"}]}], "Input",\

 CellChangeTimes->{{3.799071487248335*^9, 3.799071542875042*^9}, {
  3.7994773129313173`*^9, 3.799477319347587*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"334c506d-f6ca-4207-80cd-da93882d8a5a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ham", "[", 
    RowBox[{"x0_", ",", "x1_", ",", "x2_", ",", "x3_", ",", "x4_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"x0", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"x1", "*", 
        RowBox[{"matA20", "/", "matA20Av"}]}], "+", 
       RowBox[{"x2", "*", 
        RowBox[{"matA40", "/", "matA40Av"}]}], "+", 
       RowBox[{"x3", "*", 
        RowBox[{"matA66", "/", "matA66Av"}]}], "+", 
       RowBox[{
        RowBox[{"Sign", "[", "x4", "]"}], "*", 
        RowBox[{"Abs", "[", 
         RowBox[{"1", "-", 
          RowBox[{"Abs", "[", "x1", "]"}], "-", 
          RowBox[{"Abs", "[", "x2", "]"}], "-", 
          RowBox[{"Abs", "[", "x3", "]"}]}], "]"}], "*", 
        RowBox[{"matA60", "/", "matA60Av"}]}]}], ")"}]}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"esys", "[", 
    RowBox[{"x0_", ",", "x1_", ",", "x2_", ",", "x3_", ",", "x4_"}], "]"}], ":=", 
   RowBox[{"Eigensystem", "[", 
    RowBox[{"ham", "[", 
     RowBox[{"x0", ",", "x1", ",", "x2", ",", "x3", ",", "x4"}], "]"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.7966583263578873`*^9, {3.796660148329115*^9, 3.796660226315435*^9}, {
   3.79666074479909*^9, 3.796660745715601*^9}, {3.796661377716734*^9, 
   3.796661382701233*^9}, {3.79666142451544*^9, 3.796661432398801*^9}, {
   3.796662295430895*^9, 3.796662300213688*^9}, {3.796751985414648*^9, 
   3.796752008164106*^9}, 3.796901486293532*^9, {3.796924038670122*^9, 
   3.796924075190193*^9}, {3.79692411708181*^9, 3.7969241575137587`*^9}, {
   3.7970132179759903`*^9, 3.797013226320665*^9}, 3.79701326487462*^9, {
   3.797082603763859*^9, 3.797082630982724*^9}, 3.797096202274786*^9, {
   3.798608259030445*^9, 3.798608306414939*^9}, {3.7986085650850277`*^9, 
   3.7986085800692673`*^9}, {3.798608613474999*^9, 3.798608677887776*^9}, {
   3.798608720458528*^9, 3.798608787605392*^9}, {3.799477373781275*^9, 
   3.799477403868288*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"f0074d22-76e9-4bfc-baa4-1a35592007f1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ham", "[", 
   RowBox[{"1.", ",", "1", ",", "1", ",", "1", ",", "1"}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.797277952738563*^9, 3.797277964885384*^9}, 
   3.79735746132434*^9, {3.797861303191547*^9, 3.797861304822616*^9}, {
   3.798608793989986*^9, 3.79860879744168*^9}, {3.7990713061681147`*^9, 
   3.7990713181960487`*^9}, {3.799477407007435*^9, 3.799477414472446*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"22eb1b90-420a-4d42-b292-b910ab39646a"],

Cell["\<\
Define function that converts Mathematica expression into Python string\
\>", "Text",
 CellChangeTimes->{{3.7974109631463003`*^9, 
  3.7974109849172993`*^9}},ExpressionUUID->"d8b5ecfa-0b90-409f-8318-\
3331e596ce2b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ConvertToPyString", "[", "sstr_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"str", "=", "sstr"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"str", "=", 
      RowBox[{"Expand", "[", 
       RowBox[{"Simplify", "[", "str", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"str", "=", 
      RowBox[{"N", "[", "str", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"str", "=", 
      RowBox[{"ToString", "[", 
       RowBox[{"str", ",", "FortranForm"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"str", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"str", ",", 
        RowBox[{
         RowBox[{"Shortest", "[", 
          RowBox[{"\"\<Abs(\>\"", "~~", "i__", "~~", "\"\<)\>\""}], "]"}], 
         "\[Rule]", 
         RowBox[{"\"\<np.abs(\>\"", "~~", "i", "~~", "\"\<)\>\""}]}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"str", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"str", ",", 
        RowBox[{
         RowBox[{"Shortest", "[", 
          RowBox[{"\"\<Sqrt(\>\"", "~~", "i__", "~~", "\"\<)\>\""}], "]"}], 
         "\[Rule]", 
         RowBox[{"\"\<np.sqrt(\>\"", "~~", "i", "~~", "\"\<)\>\""}]}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"str", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"str", ",", 
        RowBox[{
         RowBox[{"Shortest", "[", 
          RowBox[{"\"\<Abs(\>\"", "~~", "i__", "~~", "\"\<)\>\""}], "]"}], 
         "\[Rule]", 
         RowBox[{"\"\<np.abs(\>\"", "~~", "i", "~~", "\"\<)\>\""}]}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"str", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"str", ",", 
        RowBox[{
         RowBox[{"Shortest", "[", 
          RowBox[{"\"\<Sign(\>\"", "~~", "i__", "~~", "\"\<)\>\""}], "]"}], 
         "\[Rule]", 
         RowBox[{"\"\<np.sign(\>\"", "~~", "i", "~~", "\"\<)\>\""}]}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", "str"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.797261935202834*^9, 3.797261982709478*^9}, {
   3.797262013965489*^9, 3.797262051348982*^9}, {3.797262335959133*^9, 
   3.7972623815014544`*^9}, 3.797262427221718*^9, {3.797266888096942*^9, 
   3.797267015952709*^9}, {3.7972671843860807`*^9, 3.797267196986126*^9}, {
   3.797270231651085*^9, 3.797270236074506*^9}, {3.797270292842783*^9, 
   3.797270580170759*^9}, {3.797272912045128*^9, 3.797272917523796*^9}, {
   3.7972729920677567`*^9, 3.79727318620399*^9}, 3.797273315333137*^9, {
   3.797273475335691*^9, 3.797273524621703*^9}, {3.797273559862084*^9, 
   3.797273569452402*^9}, {3.797273681508535*^9, 3.797273702828506*^9}, 
   3.7972739801683903`*^9, {3.797275761596661*^9, 3.797275780915831*^9}, {
   3.797275844940381*^9, 3.7972758450919313`*^9}, {3.797275941580229*^9, 
   3.7972759705243587`*^9}, {3.797276010244479*^9, 3.797276038684608*^9}, {
   3.7972762116527452`*^9, 3.797276229996397*^9}, {3.797276262476548*^9, 
   3.797276273428364*^9}, {3.797276486085189*^9, 3.797276495173934*^9}, 
   3.799477612010456*^9},
 CellLabel->"In[33]:=",ExpressionUUID->"56947352-3ee5-4a89-a652-ff6e86f2f219"],

Cell["\<\
Write python module file that sets up expression of crystal field matrix. Use \
OpenAppend if file exists already. In that case, comment out \
\[OpenCurlyDoubleQuote]import numpy as np\[CloseCurlyDoubleQuote] line below. \
\>", "Text",
 CellChangeTimes->{{3.797410989418001*^9, 3.797411025541195*^9}, {
  3.798650189925866*^9, 
  3.798650215682035*^9}},ExpressionUUID->"22e4e505-8a2d-48b9-b99f-\
563f5bf39e59"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"outdir", "=", 
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<Input_ham_cr/\>\""}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"strm", "=", 
     RowBox[{"OpenWrite", "[", 
      RowBox[{"outdir", "<>", "\"\<ham_cr.py\>\""}], "]"}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"strm", "=", 
    RowBox[{"OpenAppend", "[", 
     RowBox[{"outdir", "<>", "\"\<ham_cr.py\>\""}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"strm", ",", 
    RowBox[{"FormatType", "\[Rule]", "OutputForm"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetOptions", "[", 
    RowBox[{"strm", ",", 
     RowBox[{"PageWidth", "\[Rule]", "Infinity"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pointGroup", "=", "\"\<D3h\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"varsString", "=", 
    RowBox[{"{", 
     RowBox[{
     "\"\<x0\>\"", ",", "\"\<x1\>\"", ",", "\"\<x2\>\"", ",", "\"\<x3\>\"", 
      ",", "\"\<x4\>\""}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Write", "[", 
   RowBox[{"strm", ",", 
    RowBox[{
    "\"\<# Module creates crystal field Hamiltonian matrix for point group \
(PG) D3h and J = \>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{"N", "[", "JVal", "]"}], "]"}], "<>", 
     "\"\<.\\n# Number of crystal field variables is 4 (and sign of x4): {x0, \
x1, x2, x3, sign(x4)}.\>\""}]}], "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Write", "[", 
    RowBox[{"strm", ",", "\"\<import numpy as np\>\""}], "]"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Write", "[", 
  RowBox[{"strm", ",", " ", 
   RowBox[{
   "\"\<def ham_cr_PG_\>\"", "<>", "pointGroup", "<>", "\"\<_J_\>\"", "<>", 
    RowBox[{"StringReplace", "[", 
     RowBox[{
      RowBox[{"ToString", "[", 
       RowBox[{"N", "[", "JVal", "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"Shortest", "[", "\"\<.\>\"", "]"}], "\[Rule]", 
       "\"\<_\>\""}]}], "]"}], "<>", "\"\<(\>\"", "<>", 
    RowBox[{"varsString", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "<>", "\"\<, \>\"", "<>", 
    RowBox[{"varsString", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "<>", "\"\<, \>\"", "<>", 
    RowBox[{"varsString", "[", 
     RowBox[{"[", "3", "]"}], "]"}], "<>", "\"\<, \>\"", "<>", 
    RowBox[{"varsString", "[", 
     RowBox[{"[", "4", "]"}], "]"}], "<>", "\"\<, \>\"", "<>", 
    RowBox[{"varsString", "[", 
     RowBox[{"[", "5", "]"}], "]"}], "<>", "\"\<):\>\""}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Write", "[", 
   RowBox[{"strm", ",", 
    RowBox[{"\"\<\\t\>\"", "<>", "\"\<J = \>\"", "<>", " ", 
     RowBox[{"ToString", "[", 
      RowBox[{"N", "[", "JVal", "]"}], "]"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Write", "[", 
   RowBox[{"strm", ",", 
    RowBox[{"\"\<\\t\>\"", "<>", "\"\<dim = int(2*J+1)\>\""}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Write", "[", 
   RowBox[{"strm", ",", 
    RowBox[{
    "\"\<\\t\>\"", "<>", 
     "\"\<ham = np.arange(dim*dim, dtype=np.float)\>\""}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Write", "[", 
   RowBox[{"strm", ",", 
    RowBox[{"\"\<\\t\>\"", "<>", "\"\<ham = ham.reshape(dim,dim)\>\""}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"idx", "=", "0"}], ",", 
   RowBox[{"idx", "<", 
    RowBox[{"Length", "[", 
     RowBox[{"ham", "[", 
      RowBox[{"x0", ",", "x1", ",", "x2", ",", "x3", ",", "x4"}], "]"}], 
     "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"jdx", "=", "0"}], ",", 
      RowBox[{"jdx", "<", 
       RowBox[{"Length", "[", 
        RowBox[{"ham", "[", 
         RowBox[{"x0", ",", "x1", ",", "x2", ",", "x3", ",", "x4"}], "]"}], 
        "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tmp", "=", 
        RowBox[{"ConvertToPyString", "[", 
         RowBox[{
          RowBox[{"ham", "[", 
           RowBox[{"x0", ",", "x1", ",", "x2", ",", "x3", ",", "x4"}], "]"}], 
          "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"idx", "+", "1"}], ",", 
            RowBox[{"jdx", "+", "1"}]}], "]"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Write", "[", 
        RowBox[{"strm", ",", 
         RowBox[{"\"\<\\t\>\"", "<>", "\"\<ham[\>\"", "<>", 
          RowBox[{"ToString", "[", "idx", "]"}], "<>", "\"\<][\>\"", "<>", 
          RowBox[{"ToString", "[", "jdx", "]"}], "<>", "\"\<] = \>\"", "<>", 
          "tmp"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"jdx", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"idx", "++"}], ";"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Write", "[", 
    RowBox[{"strm", ",", 
     RowBox[{"\"\<\\t\>\"", "<>", "\"\<return ham\>\""}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", " ", "[", 
     RowBox[{
      RowBox[{"index", "=", "1"}], ",", 
      RowBox[{"index", "\[LessEqual]", 
       RowBox[{"Length", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{"ham", "[", "x", "]"}], "]"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"label", " ", "=", " ", 
        RowBox[{"\"\<# Element \>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"index", " ", "-", " ", "1"}], "]"}], " ", "<>", 
         "\"\<\\n\>\""}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{
         RowBox[{"ConvertToPyString", "[", 
          RowBox[{"W", "*", 
           RowBox[{"ham", "[", "x", "]"}]}], "]"}], "\"\<\\n\>\""}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Write", "[", 
        RowBox[{"strm", ",", " ", "label"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Write", "[", 
        RowBox[{"strm", ",", " ", "tmp"}], "]"}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"index", "++"}]}]}], "\[IndentingNewLine]", "]"}], ";"}], 
   "\[IndentingNewLine]", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Close", "[", "strm", "]"}]}], "Input",
 CellChangeTimes->{{3.797261935202834*^9, 3.797261982709478*^9}, {
   3.797262013965489*^9, 3.797262051348982*^9}, {3.797262335959133*^9, 
   3.7972623815014544`*^9}, 3.797262427221718*^9, {3.797266888096942*^9, 
   3.797267015952709*^9}, {3.7972671843860807`*^9, 3.797267196986126*^9}, {
   3.797270231651085*^9, 3.797270236074506*^9}, {3.797270292842783*^9, 
   3.797270580170759*^9}, {3.797272912045128*^9, 3.797272917523796*^9}, {
   3.7972729920677567`*^9, 3.79727318620399*^9}, 3.797273315333137*^9, {
   3.797273475335691*^9, 3.797273524621703*^9}, {3.797273559862084*^9, 
   3.797273569452402*^9}, {3.797273681508535*^9, 3.797273702828506*^9}, 
   3.7972739801683903`*^9, 3.7972740463108187`*^9, {3.797274082205628*^9, 
   3.797274124732308*^9}, {3.7972741647722883`*^9, 3.797274203885873*^9}, {
   3.797274283221828*^9, 3.7972743047964287`*^9}, {3.7972743678766317`*^9, 
   3.79727437209227*^9}, {3.797274502044259*^9, 3.797274765276348*^9}, {
   3.7972749534688063`*^9, 3.7972749750917997`*^9}, {3.7972751965084352`*^9, 
   3.797275262893379*^9}, {3.7972753702688007`*^9, 3.797275380468472*^9}, 
   3.797275755293952*^9, {3.797276355982937*^9, 3.797276396637413*^9}, {
   3.797276542686059*^9, 3.797276572213047*^9}, {3.797276979701881*^9, 
   3.797277077452806*^9}, {3.797277425470429*^9, 3.797277427708932*^9}, {
   3.797277531934023*^9, 3.797277577164948*^9}, {3.797277659094515*^9, 
   3.797277681141062*^9}, {3.79727781107787*^9, 3.7972778907410107`*^9}, {
   3.797278024198574*^9, 3.797278031765902*^9}, {3.797278091061487*^9, 
   3.7972780914453983`*^9}, {3.7974464682023087`*^9, 
   3.7974465001163473`*^9}, {3.797446545036593*^9, 3.797446545924204*^9}, {
   3.798621978910795*^9, 3.798621992611054*^9}, {3.798622062749778*^9, 
   3.798622126403528*^9}, {3.798650110542528*^9, 3.798650117234069*^9}, {
   3.79865018340699*^9, 3.798650185093807*^9}, {3.798904159319667*^9, 
   3.798904209649302*^9}, 3.798904552281777*^9, {3.7994774562576933`*^9, 
   3.799477495933638*^9}, 3.799477537125965*^9, {3.799484936474959*^9, 
   3.7994849809656477`*^9}, {3.7994873161455917`*^9, 3.799487337521514*^9}, {
   3.799487373968981*^9, 3.799487402419442*^9}, {3.799487451757962*^9, 
   3.799487465579049*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"7b8c870a-c198-48ab-a3ce-ceb01ba78dfc"],

Cell["\<\
Energy spectrum as a function of crystal field parameter x (setting W = 1).\
\>", "Text",
 CellChangeTimes->{{3.7974110323239393`*^9, 
  3.797411051605345*^9}},ExpressionUUID->"c4d37493-7c8e-4316-bb9f-\
631538fecb3e"],

Cell[BoxData[
 RowBox[{"plot1", "=", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"Sort", "[", 
     RowBox[{
      RowBox[{"esys", "[", 
       RowBox[{"1", ",", "0", ",", "0", ",", "0", ",", "x"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<E/x0\>\"", ",", "\"\<\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<x4\>\"", ",", "\"\<\>\""}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"Directive", "[", "Blue", "]"}]}], ",", " ", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"Thickness", "[", "0.0025", "]"}], ",", 
       RowBox[{"FontSize", "\[Rule]", "14"}], ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.796660288131609*^9, 3.796660308531536*^9}, {
  3.796660375760756*^9, 3.796660383352623*^9}, {3.7967502105470667`*^9, 
  3.7967502377208014`*^9}, {3.796750381125403*^9, 3.796750426440358*^9}, {
  3.7967504619482527`*^9, 3.7967505605332336`*^9}, {3.7967506415632267`*^9, 
  3.796750642344624*^9}, {3.796901500735393*^9, 3.796901502349043*^9}, {
  3.796923661767095*^9, 3.7969236636434717`*^9}, {3.796924078244068*^9, 
  3.796924092974341*^9}, {3.7990715570808563`*^9, 3.799071643162817*^9}, {
  3.799071837110753*^9, 3.799071847834877*^9}, {3.799072103100527*^9, 
  3.799072121665756*^9}},
 CellLabel->
  "In[170]:=",ExpressionUUID->"f98d7465-ed79-458a-b575-23a00580e29b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"10", "^", "4"}], ")"}], "^", 
   RowBox[{"(", 
    RowBox[{"1", "/", "5"}], ")"}]}], "//", "N"}]], "Input",
 CellChangeTimes->{{3.79907204101052*^9, 3.799072064684408*^9}},
 CellLabel->
  "In[168]:=",ExpressionUUID->"fcdec729-0da1-48cf-a419-cf2869b25580"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"Plot3D", "[", 
   RowBox[{
    RowBox[{"Sort", "[", 
     RowBox[{
      RowBox[{"esys", "[", 
       RowBox[{"1", ",", "0.2", ",", "x", ",", "0", ",", "y"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"y", ",", 
      RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
    RowBox[{"PlotPoints", "\[Rule]", "10"}], ",", 
    RowBox[{"Mesh", "\[Rule]", "All"}], ",", 
    RowBox[{"MaxRecursion", "\[Rule]", "0"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.799071657919037*^9, 3.799071693308012*^9}, {
  3.79907212798214*^9, 3.799072152427339*^9}, {3.7990723995984297`*^9, 
  3.79907242917094*^9}},
 CellLabel->
  "In[173]:=",ExpressionUUID->"997732cf-997c-4066-ac9a-4223aed9eced"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{
    "\"\<../Notes_Peter/Graphics/Energies-J_4-B_0-BST.pdf\>\"", ",", " ", 
     "plot1"}], "]"}]}], "\[IndentingNewLine]", "*)"}]], "Input",
 CellChangeTimes->{{3.797169660485691*^9, 
  3.797169733261634*^9}},ExpressionUUID->"5a5ea87a-4505-419c-9473-\
3448f41ad225"],

Cell["\<\
For a random choice of W and x we find the level spectrum and associated \
partition function (at B=0). Find numerical eigenvalues (with lowest one set \
to zero) and eigenstates for that W and x: called energies and evecs.\
\>", "Text",
 CellChangeTimes->{{3.7970827426845922`*^9, 3.797082783840917*^9}, {
  3.797082978577118*^9, 
  3.797083019581115*^9}},ExpressionUUID->"3dfb869a-e035-47d3-8cb1-\
0e1302d8308d"],

Cell[BoxData[{
 RowBox[{"WVal", "=", "4.25"}], "\[IndentingNewLine]", 
 RowBox[{"xVal", "=", 
  RowBox[{"-", "0.32", 
   RowBox[{"(*", 
    RowBox[{"-", "0.32"}], "*)"}]}]}]}], "Input",
 CellChangeTimes->{{3.797357491852181*^9, 3.7973574991633577`*^9}, {
  3.797357578731799*^9, 3.797357586611557*^9}, {3.797411058838107*^9, 
  3.797411061429859*^9}, {3.797439002077861*^9, 3.797439007365304*^9}, {
  3.797861328039669*^9, 3.797861331254691*^9}, {3.797861489911742*^9, 
  3.797861490782529*^9}, {3.797861524535771*^9, 3.7978615280465393`*^9}, {
  3.7978615591675158`*^9, 3.7978615829986134`*^9}, {3.797862430503572*^9, 
  3.797862510423088*^9}, {3.7978726615536633`*^9, 3.797872664207889*^9}, {
  3.797872887009087*^9, 3.797872896825186*^9}, {3.797872971769289*^9, 
  3.79787298718382*^9}, {3.797875873075204*^9, 3.79787587407414*^9}, {
  3.797878353266358*^9, 3.797878381384943*^9}, {3.797882434485785*^9, 
  3.797882439012787*^9}},
 CellLabel->
  "In[453]:=",ExpressionUUID->"99c5481a-dbb6-4e19-9adc-f28897e2c3a5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{"WVal", "*", 
    RowBox[{
     RowBox[{"esys", "[", "xVal", "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"energies", "=", 
   RowBox[{"temp", "-", 
    RowBox[{"Min", "[", "temp", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"evecs", "=", 
   RowBox[{
    RowBox[{"esys", "[", "xVal", "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Zcr", "[", "Temp_", "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"energies", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "/", "Temp"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "energies", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.797082819112352*^9, 3.79708281928535*^9}, {
   3.797082934987808*^9, 3.797082967965996*^9}, {3.797083051134324*^9, 
   3.797083055826861*^9}, 3.7970960250450373`*^9, {3.797096110974231*^9, 
   3.797096112653965*^9}},
 CellLabel->
  "In[455]:=",ExpressionUUID->"20e4c719-a135-4754-8d91-de1719576bd6"],

Cell[BoxData[
 RowBox[{"plot1", "=", 
  RowBox[{"ListPlot", "[", 
   RowBox[{
    RowBox[{"Sort", "[", "energies", "]"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "10"}], "}"}], ",", "Automatic"}], "}"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.796932106125465*^9, 3.7969321211145697`*^9}, {
  3.7969323689530487`*^9, 3.79693246184328*^9}, {3.797082708844481*^9, 
  3.797082715042218*^9}, {3.797169922681107*^9, 3.7971699233440723`*^9}},
 CellLabel->
  "In[459]:=",ExpressionUUID->"11c561ed-3c91-46b2-a58f-8d0e7ee1af85"],

Cell["Magnetic Jz expectation values of the different levels", "Text",
 CellChangeTimes->{{3.797096529184803*^9, 
  3.797096544645657*^9}},ExpressionUUID->"f4f5475d-82f2-42e8-91cc-\
a4de88636802"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"WVal", "*", 
    RowBox[{
     RowBox[{"esys", "[", "xVal", "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "-", 
   RowBox[{"Min", "[", 
    RowBox[{"WVal", "*", 
     RowBox[{
      RowBox[{"esys", "[", "xVal", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "//", 
  "Chop"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Conjugate", "[", 
      RowBox[{"Normalize", "[", 
       RowBox[{
        RowBox[{"esys", "[", "xVal", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "i"}], "]"}], "]"}], "]"}], "]"}], ".", "JzOp", 
     ".", 
     RowBox[{"Normalize", "[", 
      RowBox[{
       RowBox[{"esys", "[", "xVal", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "i"}], "]"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{
       RowBox[{"2", "*", "JVal"}], "+", "1"}]}], "}"}]}], "]"}], "//", 
  "Chop"}]}], "Input",
 CellChangeTimes->{{3.797093190611351*^9, 3.7970932180792503`*^9}, {
  3.797093253296327*^9, 3.797093316758301*^9}, {3.797096524906625*^9, 
  3.797096525653751*^9}, {3.7978613532720337`*^9, 3.7978613539831057`*^9}, {
  3.7978614174962378`*^9, 3.797861427199119*^9}, {3.797861597311604*^9, 
  3.79786159810277*^9}, {3.797861769928259*^9, 3.7978617744066133`*^9}, {
  3.797861854400024*^9, 3.797861867846881*^9}},
 CellLabel->
  "In[423]:=",ExpressionUUID->"71b46eca-90a2-4c34-82e9-ef705ea2c17f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"WVal", "*", 
    RowBox[{
     RowBox[{"esys", "[", "xVal", "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "-", 
   RowBox[{"Min", "[", 
    RowBox[{"WVal", "*", 
     RowBox[{
      RowBox[{"esys", "[", "xVal", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "//", 
  "Chop"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"esys", "[", "xVal", "]"}], "[", 
  RowBox[{"[", 
   RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.797861879543489*^9, 3.797861948254446*^9}},
 CellLabel->
  "In[217]:=",ExpressionUUID->"c6207131-c2cc-4c92-b6ea-7cc6fb2c7451"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Specific heat", "Subsection",
 CellChangeTimes->{
  3.7969240324035873`*^9, {3.796924410869841*^9, 3.7969244150530243`*^9}, {
   3.796925959211782*^9, 
   3.796925960854185*^9}},ExpressionUUID->"7601981e-3bcc-450b-8b5e-\
558e9acec95f"],

Cell["\<\
Specific heat cV/kB. Enter energies and Temperature (Temp) in Kelvin. \
\>", "Text",
 CellChangeTimes->{{3.7969311498218527`*^9, 
  3.796931198623749*^9}},ExpressionUUID->"252e3eb6-8575-4003-bfdc-\
58803c536f81"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"cVOverkB", "[", "Temp_", "]"}], ":=", 
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"Temp", "^", "2"}]}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"1", "/", 
        RowBox[{"Zcr", "[", "Temp", "]"}]}], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"energies", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "^", "2"}], "*", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"energies", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "/", "Temp"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "energies", "]"}]}], "}"}]}], "]"}]}], "-", 
      
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{"Zcr", "[", "Temp", "]"}]}], "*", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"energies", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "*", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"energies", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "/", "Temp"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "energies", "]"}]}], "}"}]}], "]"}]}], 
        ")"}], "^", "2"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.796926979792131*^9, 3.7969271048098993`*^9}, 
   3.796931147117601*^9, {3.7969311823582697`*^9, 3.7969311824794207`*^9}, {
   3.7969312126058826`*^9, 3.7969312172307367`*^9}, {3.796931258023196*^9, 
   3.7969313150286703`*^9}, {3.7969329721765747`*^9, 3.79693298676687*^9}, {
   3.797026627954834*^9, 3.7970266291532927`*^9}, {3.797082599131392*^9, 
   3.7970826000070353`*^9}, {3.7970828249944696`*^9, 3.7970828303844757`*^9}, 
   3.797096038077091*^9},
 CellLabel->
  "In[460]:=",ExpressionUUID->"6185d732-94ba-4779-8c81-14d7ddf5177f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Quiet", "[", 
   RowBox[{"maxy", "=", 
    RowBox[{
     RowBox[{"FindMaxValue", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"cVOverkB", "[", "Temp", "]"}], ",", 
         RowBox[{
          RowBox[{"Temp", ">", "0"}], "&&", 
          RowBox[{"Temp", "<", "300"}]}]}], "}"}], ",", 
       RowBox[{"{", "Temp", "}"}]}], "]"}], "*", "1.1"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GapAboveGSVal", "=", 
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Sort", "[", "energies", "]"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "-", 
         RowBox[{
          RowBox[{"Sort", "[", "energies", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{
           RowBox[{"Length", "[", "energies", "]"}], "-", "1"}]}], "}"}]}], 
       "]"}], ",", 
      RowBox[{
       RowBox[{"#", ">", "0"}], "&"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lineGapAboveGS", "=", 
   RowBox[{"Line", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"GapAboveGSVal", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"GapAboveGSVal", ",", "maxy"}], "}"}]}], "}"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.79706244662847*^9, 3.7970625220042973`*^9}, {
   3.797062558115399*^9, 3.7970625824583797`*^9}, 3.797062798717841*^9, {
   3.797062834719076*^9, 3.797062942118616*^9}, 3.797082837003025*^9},
 CellLabel->
  "In[461]:=",ExpressionUUID->"92680b13-80b0-4675-900f-51d0d8bb48d0"],

Cell[BoxData[
 RowBox[{"plot1", "=", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"cVOverkB", "[", "Temp", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"Temp", ",", "1", ",", "300"}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(c\), \(V\)]\)/\!\(\*SubscriptBox[\(k\), \(B\
\)]\) (dimensionless)\>\"", ",", "\"\<\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<T (Kelvin)\>\"", ",", "\"\<\>\""}], "}"}]}], "}"}]}], 
    ",", 
    RowBox[{"Epilog", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{"Dashed", ",", " ", "Red"}], "]"}], ",", "lineGapAboveGS"}], 
      "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"Thickness", "[", "0.0025", "]"}], ",", 
       RowBox[{"FontSize", "\[Rule]", "14"}], ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.796931219243614*^9, 3.796931228437479*^9}, {
  3.796931770546015*^9, 3.796931802507873*^9}, {3.7969330051706953`*^9, 
  3.796933009185679*^9}, {3.797026633860376*^9, 3.797026664080826*^9}, {
  3.79702670858775*^9, 3.797026717364566*^9}, {3.797062588394966*^9, 
  3.797062659604664*^9}, {3.797062945438847*^9, 3.797062956104608*^9}, {
  3.797062986583458*^9, 3.797062994271462*^9}, {3.797169876368163*^9, 
  3.797169876806964*^9}, {3.7971747331118717`*^9, 3.79717473876569*^9}, {
  3.797174773160492*^9, 3.797174773989563*^9}, {3.79717499330341*^9, 
  3.797175038902234*^9}, {3.797175308007824*^9, 3.79717531383041*^9}},
 CellLabel->
  "In[464]:=",ExpressionUUID->"f71f6f19-ab50-453c-be4f-403914bc44c6"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"\"\<../Notes_Peter/Graphics/cV-J_4-W_\>\"", "~~", 
      RowBox[{"ToString", "[", "WVal", "]"}], "~~", "\"\<-x_\>\"", "~~", 
      RowBox[{"ToString", "[", "xVal", "]"}], "~~", "\"\<.pdf\>\""}], ",", 
     " ", "plot1"}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.7971697910121307`*^9, 3.797169844877747*^9}, 
   3.7971698870628843`*^9, {3.797357639316393*^9, 
   3.797357641047388*^9}},ExpressionUUID->"f4474e09-4e15-4c46-b530-\
e29b4f2e2b86"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Magnetization in finite magnetic field and magnetic susceptibility\
\>", "Subsection",
 CellChangeTimes->{{3.79709104619378*^9, 3.797091063478002*^9}, {
  3.797102375276865*^9, 
  3.797102396139666*^9}},ExpressionUUID->"17985349-c36e-45fa-b81c-\
eaea354ccd70"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Entity", "[", 
    RowBox[{"\"\<PhysicalConstant\>\"", ",", "\"\<BoltzmannConstant\>\""}], 
    "]"}], "[", "\"\<Value\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Entity", "[", 
    RowBox[{"\"\<PhysicalConstant\>\"", ",", "\"\<BohrMagneton\>\""}], "]"}], 
   "[", "\"\<Value\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/", "%%"}], ";"}]}], "Input",
 CellChangeTimes->{
  3.797091130674865*^9, {3.79709150239548*^9, 3.797091584189026*^9}, {
   3.79709181325438*^9, 3.797091817539772*^9}, {3.797092026755538*^9, 
   3.797092032995563*^9}, {3.797169753667864*^9, 3.7971697573468933`*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"4cec8178-08ac-40d8-afb4-8a5e36674cbf"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"263", "/", "6.51"}]}]], "Input",
 CellChangeTimes->{{3.797101918185444*^9, 3.7971019417999773`*^9}, 
   3.7971020149791813`*^9},
 CellLabel->
  "In[141]:=",ExpressionUUID->"36805b9f-eb95-4e0c-b2b9-ec095dbc1f79"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"kBVal", "=", 
     FractionBox["1380649", "100000000000000000000000000000"]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "\[Mu]BVal", "=", 
     "9.2740100783000004424165405042207403`9.219079536512577*^-24"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"\[Mu]BVal", "/", "kBVal"}]}]}]], "Input",
 CellChangeTimes->{{3.797092038757635*^9, 3.7970920615092897`*^9}},
 CellLabel->
  "In[219]:=",ExpressionUUID->"3ce37320-038d-49a9-839c-324f17d82daa"],

Cell[CellGroupData[{

Cell["Magnetic field along z", "Subsubsection",
 CellChangeTimes->{{3.797091867319274*^9, 
  3.797091881074354*^9}},ExpressionUUID->"7ae801fe-8bad-4226-bad9-\
ac0c966dda5d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"hamB", "[", 
    RowBox[{"Bfield_", ",", "W_", ",", "x_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"W", "*", 
      RowBox[{"ham", "[", "x", "]"}]}], "-", 
     RowBox[{
      RowBox[{"gJLS", "[", 
       RowBox[{"JVal", ",", "LVal", ",", "SVal"}], "]"}], "*", 
      RowBox[{"\[Mu]BVal", "/", "kBVal"}], "*", "JzOp", "*", "Bfield"}]}], "//",
     "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "MatrixForm"}], ";"}]}], "Input",
 CellChangeTimes->{{3.797091064331895*^9, 3.797091128686928*^9}, {
   3.797091779730118*^9, 3.7970917978472*^9}, {3.797091844726115*^9, 
   3.797091903384541*^9}, {3.797092070896071*^9, 3.797092117997636*^9}, 
   3.797092233665975*^9, 3.797092273944283*^9, 3.797092316377521*^9, {
   3.7970925655526667`*^9, 3.797092576402527*^9}, 3.7970960542870407`*^9},
 CellLabel->
  "In[233]:=",ExpressionUUID->"7ee311c3-6b4b-4eda-98c8-e46c6cda0086"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"esysB", "[", 
     RowBox[{"Bfield_", ",", "W_", ",", "x_"}], "]"}], ":=", 
    RowBox[{"Eigensystem", "[", 
     RowBox[{"hamB", "[", 
      RowBox[{"Bfield", ",", "W", ",", "x"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ZB", "[", 
    RowBox[{"Bfield_", ",", "Temp_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"esysB", "[", 
            RowBox[{"Bfield", ",", "WVal", ",", "xVal"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "i"}], "]"}], "]"}], "-", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{"esysB", "[", 
             RowBox[{"Bfield", ",", "WVal", ",", "xVal"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ")"}]}], "/", "Temp"}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{
        RowBox[{"2", "*", "JVal"}], "+", "1"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.797092303909333*^9, 3.7970924393080797`*^9}, {
   3.797092510287903*^9, 3.797092643733098*^9}, {3.797092711299571*^9, 
   3.797092721618252*^9}, {3.797093510139996*^9, 3.797093511284247*^9}, {
   3.7970955196946783`*^9, 3.7970955204649343`*^9}, 3.797096060624319*^9},
 CellLabel->
  "In[224]:=",ExpressionUUID->"9299c293-da8e-425b-b28d-f906f19e0a4c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"gJLS", "[", 
     RowBox[{"JVal", ",", "LVal", ",", "SVal"}], "]"}], "*", 
    RowBox[{"\[Mu]BVal", "/", "kBVal"}], "*", "JzOp", "*", "1"}], "//", 
   "MatrixForm"}], ";"}]], "Input",
 CellChangeTimes->{{3.797093677185074*^9, 3.797093697849971*^9}, 
   3.797096074448151*^9},
 CellLabel->
  "In[226]:=",ExpressionUUID->"11093c38-88ca-4ddb-a59e-5ec22e81a9ae"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"esysB", "[", 
   RowBox[{"1", ",", "1", ",", 
    RowBox[{"-", "0.32"}]}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Sort", "[", 
  RowBox[{"%", "-", 
   RowBox[{"Min", "[", "%", "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.797358213520982*^9, 3.797358242883663*^9}, {
  3.7973583081013737`*^9, 3.797358330355772*^9}},
 CellLabel->
  "In[227]:=",ExpressionUUID->"acb33703-378f-484f-be96-df058d02538b"],

Cell[BoxData[
 RowBox[{"plot1", "=", 
  RowBox[{"ListPlot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Sort", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"esysB", "[", 
          RowBox[{"0", ",", "WVal", ",", "xVal"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"esysB", "[", 
           RowBox[{"0", ",", "WVal", ",", "xVal"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"Sort", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"esysB", "[", 
          RowBox[{"2", ",", "WVal", ",", "xVal"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"esysB", "[", 
           RowBox[{"2", ",", "WVal", ",", "xVal"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"Sort", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"esysB", "[", 
          RowBox[{"10", ",", "WVal", ",", "xVal"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"esysB", "[", 
           RowBox[{"10", ",", "WVal", ",", "xVal"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(E\), \(i\)]\)(B)-\!\(\*SubscriptBox[\(E\), \
\(GS\)]\)(B)  (K)\>\"", ",", "\"\<\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<Eigenstate index i\>\"", ",", "\"\<\>\""}], "}"}]}], 
      "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"Thickness", "[", "0.0025", "]"}], ",", 
       RowBox[{"FontSize", "\[Rule]", "14"}], ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "10"}], "}"}], ",", "Automatic"}], "}"}]}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"Placed", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<B=0\>\"", ",", " ", "\"\<B=2T\>\"", ",", " ", "\"\<B=10T\>\""}], 
        "}"}], ",", "Above"}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.796932106125465*^9, 3.7969321211145697`*^9}, {
  3.7969323689530487`*^9, 3.79693246184328*^9}, {3.797082708844481*^9, 
  3.797082715042218*^9}, {3.797093396870356*^9, 3.797093485958498*^9}, {
  3.7970935339539137`*^9, 3.7970935359882793`*^9}, {3.797093579643457*^9, 
  3.7970936548623457`*^9}, {3.797169953529686*^9, 3.797169955241962*^9}, {
  3.797174143877552*^9, 3.797174266324847*^9}, {3.797174337222294*^9, 
  3.797174408549038*^9}, {3.7971747544643507`*^9, 3.797174755661996*^9}, {
  3.797174889948656*^9, 3.7971749084621964`*^9}, {3.7971752315373096`*^9, 
  3.797175271894486*^9}},
 CellLabel->
  "In[229]:=",ExpressionUUID->"167f6514-dc57-47bc-8c26-d657d5170df5"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"\"\<../Notes_Peter/Graphics/Spectrum_Vs_B-J_4-W_\>\"", "~~", 
      RowBox[{"ToString", "[", "WVal", "]"}], "~~", "\"\<-x_\>\"", "~~", 
      RowBox[{"ToString", "[", "xVal", "]"}], "~~", "\"\<.pdf\>\""}], ",", 
     " ", "plot1"}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.797174417004724*^9, 3.797174418884845*^9}, {
  3.797358205004739*^9, 
  3.797358210637102*^9}},ExpressionUUID->"dc9466e4-9f09-4ce1-a8ae-\
fd68424dd7c6"],

Cell[BoxData[{
 RowBox[{"WVal", "=", "4.25"}], "\[IndentingNewLine]", 
 RowBox[{"xVal", "=", "1"}], "\[IndentingNewLine]", 
 RowBox[{"BminVal", "=", "0.001"}]}], "Input",
 CellChangeTimes->{{3.797864800474155*^9, 3.797864804280871*^9}, {
   3.797864858257777*^9, 3.797864947744698*^9}, 3.79787236808969*^9},
 CellLabel->
  "In[356]:=",ExpressionUUID->"b4f5a855-139e-4fbb-a95a-4f71cb15d969"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"esysB", "[", 
   RowBox[{"BminVal", ",", "WVal", ",", "xVal"}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Conjugate", "[", 
     RowBox[{
      RowBox[{"esysB", "[", 
       RowBox[{"BminVal", ",", "WVal", ",", "xVal"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "i"}], "]"}], "]"}], "]"}], ".", "JzOp", ".", 
    RowBox[{
     RowBox[{"esysB", "[", 
      RowBox[{"BminVal", ",", "WVal", ",", "xVal"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", "i"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{
      RowBox[{"2", "*", "JVal"}], "+", "1"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7978723789213257`*^9, 3.797872382392186*^9}},
 CellLabel->
  "In[359]:=",ExpressionUUID->"5701bd90-c29c-447b-9a2b-bcdd5dd252a4"],

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Conjugate", "[", 
     RowBox[{
      RowBox[{"esys", "[", "xVal", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "i"}], "]"}], "]"}], "]"}], ".", "JzOp", ".", 
    RowBox[{
     RowBox[{"esys", "[", "xVal", "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"2", ",", "i"}], "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", 
     RowBox[{
      RowBox[{"2", "*", "JVal"}], "+", "1"}]}], "}"}]}], "]"}]], "Input",
 CellLabel->
  "In[313]:=",ExpressionUUID->"94a5096a-de84-4450-92d0-181aabf27329"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"WVal", "*", 
   RowBox[{
    RowBox[{"esys", "[", "xVal", "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"ListPlot", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Chop", "[", 
         RowBox[{
          RowBox[{"Conjugate", "[", 
           RowBox[{
            RowBox[{"esys", "[", "xVal", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "i"}], "]"}], "]"}], "]"}], ".", "JzOp", ".", 
          RowBox[{
           RowBox[{"esys", "[", "xVal", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "i"}], "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{
           RowBox[{"2", "*", "JVal"}], "+", "1"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"xVal", ",", 
        RowBox[{"-", "1"}], ",", "1", ",", "0.01"}], "}"}]}], "]"}], "]"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"plot", "=", 
  RowBox[{"ListPlot", "[", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{
           RowBox[{"esysB", "[", 
            RowBox[{"BminVal", ",", "WVal", ",", "xVal"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"2", ",", "i"}], "]"}], "]"}], "]"}], ".", "JzOp", ".", 
         RowBox[{
          RowBox[{"esysB", "[", 
           RowBox[{"BminVal", ",", "WVal", ",", "xVal"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "i"}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{
           RowBox[{"2", "*", "JVal"}], "+", "1"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"xVal", ",", 
        RowBox[{"-", "1"}], ",", "1", ",", "0.01"}], "}"}]}], "]"}], ",", " ", 
    RowBox[{"Epilog", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{"Dashed", ",", "Red"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "2.5"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"9", ",", 
            RowBox[{"-", "2.5"}]}], "}"}]}], "}"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "2.5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"9", ",", "2.5"}], "}"}]}], "}"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "0.5"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"9", ",", 
            RowBox[{"-", "0.5"}]}], "}"}]}], "}"}], "]"}], ",", 
       RowBox[{"Line", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0.5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"9", ",", "0.5"}], "}"}]}], "}"}], "]"}]}], "}"}]}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}]}], 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.797093190611351*^9, 3.7970932180792503`*^9}, {
   3.797093253296327*^9, 3.797093316758301*^9}, {3.7970935596895037`*^9, 
   3.7970935609004803`*^9}, {3.797864831361746*^9, 3.797864879125102*^9}, {
   3.797864952970232*^9, 3.797865085201283*^9}, 3.7978718337777348`*^9, {
   3.797871899715857*^9, 3.797871909344805*^9}, {3.797871993242395*^9, 
   3.797872296576542*^9}},
 CellLabel->
  "In[353]:=",ExpressionUUID->"9e1c11e1-ba67-4d59-98af-4b1570fe6934"],

Cell["Magnetization in finite field", "Text",
 CellChangeTimes->{{3.79709245886586*^9, 3.7970924678399563`*^9}, {
  3.797097004106513*^9, 3.797097006350685*^9}, {3.797102404987516*^9, 
  3.79710240569556*^9}},
 Background->GrayLevel[
  0.85],ExpressionUUID->"61209051-5876-4f63-b6ac-fd9ad9076438"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"magZ", "[", 
    RowBox[{"Bfield_", ",", "Temp_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"ZB", "[", 
      RowBox[{"Bfield", ",", "Temp"}], "]"}]}], "*", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Conjugate", "[", 
         RowBox[{
          RowBox[{"esysB", "[", 
           RowBox[{"Bfield", ",", "WVal", ",", "xVal"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "i"}], "]"}], "]"}], "]"}], ".", "JzOp", ".", 
        RowBox[{
         RowBox[{"esysB", "[", 
          RowBox[{"Bfield", ",", "WVal", ",", "xVal"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "i"}], "]"}], "]"}]}], " ", "*", 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"esysB", "[", 
              RowBox[{"Bfield", ",", "WVal", ",", "xVal"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "i"}], "]"}], "]"}], "-", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"esysB", "[", 
               RowBox[{"Bfield", ",", "WVal", ",", "xVal"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ")"}]}], "/", "Temp"}],
         "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{
         RowBox[{"2", "*", "JVal"}], "+", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.797092468495714*^9, 3.79709250035081*^9}, {
   3.797092651331514*^9, 3.7970927961129827`*^9}, {3.797095445201747*^9, 
   3.797095449037384*^9}, {3.7970958842573023`*^9, 3.797095891615671*^9}, 
   3.797095978403713*^9, 3.7970972689182568`*^9},
 CellLabel->
  "In[185]:=",ExpressionUUID->"13cdbedd-c5ab-4046-9aa9-9c8523550978"],

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"esysB", "[", 
         RowBox[{"1", ",", "WVal", ",", "xVal"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "i"}], "]"}], "]"}], "]"}], ".", "JzOp", ".", 
      RowBox[{
       RowBox[{"esysB", "[", 
        RowBox[{"1", ",", "WVal", ",", "xVal"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "i"}], "]"}], "]"}]}], "*", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"esysB", "[", 
            RowBox[{"1", ",", "WVal", ",", "xVal"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "i"}], "]"}], "]"}], "-", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{"esysB", "[", 
             RowBox[{"1", ",", "WVal", ",", "xVal"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ")"}]}], " ", "/", "1"}],
       "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{
       RowBox[{"2", "*", "JVal"}], "+", "1"}]}], "}"}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.79735838047291*^9, 3.797358401845393*^9}, {
   3.797358477214653*^9, 3.797358481676236*^9}, {3.797359168126816*^9, 
   3.797359253676956*^9}, 3.797439164550324*^9},
 CellLabel->
  "In[170]:=",ExpressionUUID->"9812be83-5a37-49a4-b675-31acba5fa08a"],

Cell[BoxData[
 RowBox[{"plot1", "=", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"magZ", "[", 
       RowBox[{"B", ",", "1"}], "]"}], ",", 
      RowBox[{"magZ", "[", 
       RowBox[{"B", ",", "6.69"}], "]"}], ",", 
      RowBox[{"magZ", "[", 
       RowBox[{"B", ",", "44.8"}], "]"}], ",", 
      RowBox[{"magZ", "[", 
       RowBox[{"B", ",", "300"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"B", ",", "0", ",", "10"}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(M\), \
\(z\)]\)/(\!\(\*SubscriptBox[\(\[Mu]\), \(B\)]\)\!\(\*SubscriptBox[\(g\), \(J\
\)]\))\>\"", ",", "\"\<\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<B (T)\>\"", ",", "\"\<\>\""}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"Placed", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<T=1K\>\"", ",", "\"\<T=50K\>\"", ",", "\"\<T=100K\>\"", ",", 
         "\"\<T=300K\>\""}], "}"}], ",", "Above"}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.79709279725414*^9, 3.79709283037326*^9}, {
   3.797092895029755*^9, 3.797092895446526*^9}, 3.7970937485300703`*^9, {
   3.797097011149433*^9, 3.797097025966505*^9}, {3.797097104784625*^9, 
   3.797097120523793*^9}, {3.797097153877613*^9, 3.797097162955976*^9}, {
   3.797097216753148*^9, 3.7970972202747927`*^9}, {3.797097279270802*^9, 
   3.797097283677964*^9}, {3.797097540282523*^9, 3.797097575449111*^9}, {
   3.797175376143649*^9, 3.797175425518318*^9}, {3.797175473535611*^9, 
   3.797175476043096*^9}, {3.797361538734376*^9, 3.797361546877021*^9}},
 CellLabel->
  "In[171]:=",ExpressionUUID->"598e78aa-e05c-4c3b-b7b6-03d1d6d4e561"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"SetDirectory", "[", 
     RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"\"\<../Notes_Peter/Graphics/MagnetizationZ_Vs_B-J_4-W_\>\"", "~~", 
       RowBox[{"ToString", "[", "WVal", "]"}], "~~", "\"\<-x_\>\"", "~~", 
       RowBox[{"ToString", "[", "xVal", "]"}], "~~", "\"\<.pdf\>\""}], ",", 
      " ", "plot1"}], "]"}]}], "*)"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.797175431938917*^9, 3.797175447492741*^9}, 
   3.79717568021587*^9, {3.797439168565961*^9, 
   3.797439170637067*^9}},ExpressionUUID->"a666e7d9-04e8-4327-89de-\
72c18cf18ea9"],

Cell[BoxData[
 RowBox[{"plot1", "=", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"magZ", "[", 
      RowBox[{"B", ",", "1"}], "]"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"B", ",", "0", ",", "50"}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(M\), \(z\)]\)/\!\(\*SubscriptBox[\(\[Mu]\), \
\(B\)]\)\!\(\*SubscriptBox[\(g\), \(J\)]\)\>\"", ",", "\"\<\>\""}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"\"\<B (T)\>\"", ",", "\"\<\>\""}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", "\"\<Expressions\>\""}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.797102240765374*^9, 3.7971022487091293`*^9}, {
  3.797102326203043*^9, 3.797102327118113*^9}, {3.7971756571273203`*^9, 
  3.797175657766761*^9}, {3.79717606172987*^9, 3.79717606178377*^9}},
 CellLabel->
  "In[142]:=",ExpressionUUID->"8007f107-334a-47ed-9663-f7aaab4cea28"],

Cell[BoxData[{
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{
   "\"\<../Notes_Peter/Graphics/MagnetizationZ_Vs_B-Larger_B-J_4-W_\>\"", "~~", 
    RowBox[{"ToString", "[", "WVal", "]"}], "~~", "\"\<-x_\>\"", "~~", 
    RowBox[{"ToString", "[", "xVal", "]"}], "~~", "\"\<.pdf\>\""}], ",", " ", 
   "plot1"}], "]"}]}], "Input",
 CellChangeTimes->{{3.797176072064929*^9, 3.797176080263286*^9}},
 CellLabel->
  "In[143]:=",ExpressionUUID->"9366b3aa-6463-4a00-be34-bfb37a877740"],

Cell["Susceptibility", "Text",
 CellChangeTimes->{{3.7971023556973143`*^9, 3.797102363156039*^9}},
 Background->GrayLevel[
  0.85],ExpressionUUID->"270a8732-3e41-4c08-b905-139c0891b165"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BfieldVal", "=", "0.001"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"chiZ", "[", "Temp_", "]"}], ":=", 
   RowBox[{"gVal", "*", "\[Mu]BVal", "*", 
    RowBox[{
     RowBox[{"magZ", "[", 
      RowBox[{"BfieldVal", ",", "Temp"}], "]"}], "/", "BfieldVal"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.797097222219215*^9, 3.7970972662744427`*^9}, 
   3.7970973201114397`*^9, {3.7970975959393806`*^9, 3.79709765000082*^9}, {
   3.797100860125086*^9, 3.797100864221684*^9}},
 CellLabel->
  "In[176]:=",ExpressionUUID->"99b56381-e5a0-433e-91ba-585c55fc9d7b"],

Cell[BoxData[
 RowBox[{"plot2", "=", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"chiZ", "[", "Temp", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"Temp", ",", "1", ",", "300"}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(\[Chi]\), \(z\)]\) for single ion (dimless)\
\>\"", ",", "\"\<\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<T (K)\>\"", ",", "\"\<\>\""}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.797097324961033*^9, 3.7970973499365063`*^9}, {
  3.7970977000898647`*^9, 3.797097720238015*^9}, {3.797102200890143*^9, 
  3.7971022180246077`*^9}, {3.797175717647236*^9, 3.797175746798649*^9}, {
  3.797175780248435*^9, 3.797175805534971*^9}},
 CellLabel->
  "In[178]:=",ExpressionUUID->"6da352e1-11a7-4ed2-ad83-ea7b003d1aeb"],

Cell[BoxData[
 RowBox[{"plot2", "=", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"chiZ", "[", "Temp", "]"}], "/", "gVal"}], "/", "\[Mu]BVal"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"Temp", ",", "1", ",", "300"}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(\[Chi]\), \(z\)]\)/(\!\(\*SubscriptBox[\(\
\[Mu]\), \(B\)]\)*\!\(\*SubscriptBox[\(g\), \(JLS\)]\)) for single ion \
(dimless)\>\"", ",", "\"\<\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<T (K)\>\"", ",", "\"\<\>\""}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7974395800298443`*^9, 3.797439600717285*^9}},
 CellLabel->
  "In[189]:=",ExpressionUUID->"2ac7330c-eae7-4a23-96fc-1245de69ccb6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"chiZ", "[", "15", "]"}], "/", "gVal"}], "/", 
  "\[Mu]BVal"}]], "Input",
 CellChangeTimes->{{3.797439044169868*^9, 3.797439050957301*^9}, 
   3.797439177797879*^9, {3.7974395592225723`*^9, 3.797439565965206*^9}},
 CellLabel->
  "In[182]:=",ExpressionUUID->"9934e28c-f69a-46b4-8138-d0ddab0ffb18"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"\"\<../Notes_Peter/Graphics/SusceptibilityZ_Vs_T-J_4-W_\>\"", "~~", 
      RowBox[{"ToString", "[", "WVal", "]"}], "~~", "\"\<-x_\>\"", "~~", 
      RowBox[{"ToString", "[", "xVal", "]"}], "~~", "\"\<.pdf\>\""}], ",", 
     " ", "plot2"}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.797175668046732*^9, 3.797175675846446*^9}, {
  3.797175740806499*^9, 3.797175740870315*^9}, {3.797175795871879*^9, 
  3.7971758018805428`*^9}, {3.7974390396532516`*^9, 
  3.7974390420978317`*^9}},ExpressionUUID->"b4716068-842d-4021-845a-\
79788515e0e7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Mu]BVal", "^", "2"}], "*", 
  RowBox[{
   RowBox[{"gVal", "^", "2"}], "/", "kBVal"}], "*", "JVal", "*", 
  RowBox[{"(", 
   RowBox[{"JVal", "+", "1"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.797101238532258*^9, 3.797101276417392*^9}},
 CellLabel->
  "In[136]:=",ExpressionUUID->"c57099e0-53d3-4bb4-8aba-faabebf266af"],

Cell[BoxData[
 RowBox[{"6", "*", 
  RowBox[{"10", "^", "23"}], "*", "40", "*", "5", "*", 
  RowBox[{"10", "^", 
   RowBox[{"(", 
    RowBox[{"-", "25"}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.797102178150481*^9, 3.7971021915664873`*^9}, 
   3.797102345961636*^9},ExpressionUUID->"a50ac638-3532-4d3b-88c5-\
88ead18eb789"],

Cell["\<\
Check that I am getting the correct van-Vleck susceptibility in the low \
temperature limit. Important: this requires that the GS be the singlet and I \
need to use the energy splitting to the triplet with dipole moment 1/2. This \
depends on the choice of W and x and since these are randomly drawn, the two \
cells below may not work if the ground state is different or the triplet is \
not the first excited state (this occurs for x=-0.380623, for which I have \
checked my calculation). \
\>", "Text",
 CellChangeTimes->{{3.7970968647143*^9, 
  3.7970969933233213`*^9}},ExpressionUUID->"b902bdda-0274-42b5-8ea1-\
1acb7641f95c"],

Cell[BoxData["xVal"], "Input",
 CellChangeTimes->{{3.79709697446278*^9, 
  3.797096998594058*^9}},ExpressionUUID->"0f199227-31d5-4a81-b44e-\
18e8de3c1ef9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"kBVal", "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"gJLS", "[", 
      RowBox[{"JVal", ",", "LVal", ",", "SVal"}], "]"}], "*", "\[Mu]BVal"}], 
    ")"}]}], "*", 
  RowBox[{
   RowBox[{"magZ", "[", 
    RowBox[{"0.01", ",", "1"}], "]"}], "/", "0.01"}]}]], "Input",
 CellChangeTimes->{{3.797094020834476*^9, 3.797094048870845*^9}, {
   3.797094322261258*^9, 3.797094330128172*^9}, {3.797095454047832*^9, 
   3.797095460074473*^9}, {3.797095814642474*^9, 3.79709582333989*^9}, {
   3.7970960994682703`*^9, 3.797096101943779*^9}, {3.797096670767456*^9, 
   3.79709667394707*^9}, {3.7970967728621683`*^9, 3.797096783757464*^9}, {
   3.7970968329987707`*^9, 3.7970968382661257`*^9}, 3.7970974055264177`*^9},
 CellLabel->
  "In[123]:=",ExpressionUUID->"20ce53c4-ae8c-4b7e-9ea3-2dec145b2167"],

Cell[BoxData[
 RowBox[{
  RowBox[{"40", "/", "3"}], "/", 
  RowBox[{
   RowBox[{"Sort", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"esysB", "[", 
       RowBox[{"0", ",", "WVal", ",", "xVal"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "-", 
     RowBox[{"Min", "[", 
      RowBox[{
       RowBox[{"esysB", "[", 
        RowBox[{"0", ",", "WVal", ",", "xVal"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], "[", 
   RowBox[{"[", "2", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7970939979411287`*^9, 3.797094012980019*^9}, {
  3.797094075908804*^9, 3.7970940981513977`*^9}, {3.797095057281535*^9, 
  3.797095068934136*^9}, {3.797096117629939*^9, 3.797096142761301*^9}, {
  3.797096651072448*^9, 3.797096653110276*^9}},
 CellLabel->
  "In[107]:=",ExpressionUUID->"b29294fb-4daa-4e5e-a0cd-74ee57ca22fa"],

Cell[BoxData[{
 RowBox[{"kBVal", "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"gJLS", "[", 
     RowBox[{"JVal", ",", "LVal", ",", "SVal"}], "]"}], "*", "\[Mu]BVal"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gJLS", "[", 
   RowBox[{"JVal", ",", "LVal", ",", "SVal"}], "]"}], "*", 
  "\[Mu]BVal"}]}], "Input",
 CellChangeTimes->{{3.797097448334342*^9, 3.7970974485314617`*^9}},
 CellLabel->
  "In[125]:=",ExpressionUUID->"0a5631d5-38b6-442e-b6f1-617ef4323a2f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Magnetic field along x", "Subsubsection",
 CellChangeTimes->{{3.797091867319274*^9, 3.797091881074354*^9}, {
  3.797185074070167*^9, 
  3.797185074144825*^9}},ExpressionUUID->"14cd162a-1100-4965-a8c3-\
b7f740d24a3d"],

Cell[BoxData[{"WVal", "\[IndentingNewLine]", "xVal"}], "Input",
 CellChangeTimes->{{3.7971866120877447`*^9, 3.7971866150453167`*^9}},
 CellLabel->
  "In[248]:=",ExpressionUUID->"3c8a3cd2-fce8-4bc1-a181-a1f0d82fb2fe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"hamBX", "[", 
    RowBox[{"Bfield_", ",", "W_", ",", "x_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"W", "*", 
      RowBox[{"ham", "[", "x", "]"}]}], "-", 
     RowBox[{
      RowBox[{"gJLS", "[", 
       RowBox[{"JVal", ",", "LVal", ",", "SVal"}], "]"}], "*", 
      RowBox[{"\[Mu]BVal", "/", "kBVal"}], "*", "JxOp", "*", "Bfield"}]}], "//",
     "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "MatrixForm"}], ";"}]}], "Input",
 CellChangeTimes->{{3.797091064331895*^9, 3.797091128686928*^9}, {
   3.797091779730118*^9, 3.7970917978472*^9}, {3.797091844726115*^9, 
   3.797091903384541*^9}, {3.797092070896071*^9, 3.797092117997636*^9}, 
   3.797092233665975*^9, 3.797092273944283*^9, 3.797092316377521*^9, {
   3.7970925655526667`*^9, 3.797092576402527*^9}, 3.7970960542870407`*^9, {
   3.797185082118867*^9, 3.79718508495817*^9}, {3.79718662375134*^9, 
   3.797186648269558*^9}, {3.797186686390986*^9, 3.797186690149913*^9}},
 CellLabel->
  "In[250]:=",ExpressionUUID->"4adc92c5-397c-434e-ae7d-b051d24a0b71"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"esysB", "[", 
     RowBox[{"Bfield_", ",", "W_", ",", "x_"}], "]"}], ":=", 
    RowBox[{"Eigensystem", "[", 
     RowBox[{"hamBX", "[", 
      RowBox[{"Bfield", ",", "W", ",", "x"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ZB", "[", 
    RowBox[{"Bfield_", ",", "Temp_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"esysB", "[", 
            RowBox[{"Bfield", ",", "WVal", ",", "xVal"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "i"}], "]"}], "]"}], "-", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{"esysB", "[", 
             RowBox[{"Bfield", ",", "WVal", ",", "xVal"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ")"}]}], "/", "Temp"}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{
        RowBox[{"2", "*", "JVal"}], "+", "1"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.797092303909333*^9, 3.7970924393080797`*^9}, {
   3.797092510287903*^9, 3.797092643733098*^9}, {3.797092711299571*^9, 
   3.797092721618252*^9}, {3.797093510139996*^9, 3.797093511284247*^9}, {
   3.7970955196946783`*^9, 3.7970955204649343`*^9}, 3.797096060624319*^9, 
   3.79718509215942*^9},
 CellLabel->
  "In[252]:=",ExpressionUUID->"04f30a5e-43ef-4ba1-ae73-83fc3862e26d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"gJLS", "[", 
     RowBox[{"JVal", ",", "LVal", ",", "SVal"}], "]"}], "*", 
    RowBox[{"\[Mu]BVal", "/", "kBVal"}], "*", "JzOp", "*", "1"}], "//", 
   "MatrixForm"}], ";"}]], "Input",
 CellChangeTimes->{{3.797093677185074*^9, 3.797093697849971*^9}, 
   3.797096074448151*^9},
 CellLabel->
  "In[254]:=",ExpressionUUID->"7ffb2721-c356-4dbb-9d66-579798b61ebc"],

Cell[BoxData[
 RowBox[{"plot2", "=", 
  RowBox[{"ListPlot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Sort", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"esysB", "[", 
          RowBox[{"0", ",", "WVal", ",", "xVal"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"esysB", "[", 
           RowBox[{"0", ",", "WVal", ",", "xVal"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"Sort", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"esysB", "[", 
          RowBox[{"2", ",", "WVal", ",", "xVal"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"esysB", "[", 
           RowBox[{"2", ",", "WVal", ",", "xVal"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"Sort", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"esysB", "[", 
          RowBox[{"10", ",", "WVal", ",", "xVal"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"esysB", "[", 
           RowBox[{"10", ",", "WVal", ",", "xVal"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(E\), \(i\)]\)(B)-\!\(\*SubscriptBox[\(E\), \
\(GS\)]\)(B)  (K)\>\"", ",", "\"\<\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<Eigenstate index i\>\"", ",", "\"\<\>\""}], "}"}]}], 
      "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"Thickness", "[", "0.0025", "]"}], ",", 
       RowBox[{"FontSize", "\[Rule]", "14"}], ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "10"}], "}"}], ",", "Automatic"}], "}"}]}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"Placed", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<B=0\>\"", ",", " ", "\"\<B=2T\>\"", ",", " ", "\"\<B=10T\>\""}], 
        "}"}], ",", "Above"}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.796932106125465*^9, 3.7969321211145697`*^9}, {
  3.7969323689530487`*^9, 3.79693246184328*^9}, {3.797082708844481*^9, 
  3.797082715042218*^9}, {3.797093396870356*^9, 3.797093485958498*^9}, {
  3.7970935339539137`*^9, 3.7970935359882793`*^9}, {3.797093579643457*^9, 
  3.7970936548623457`*^9}, {3.797169953529686*^9, 3.797169955241962*^9}, {
  3.797174143877552*^9, 3.797174266324847*^9}, {3.797174337222294*^9, 
  3.797174408549038*^9}, {3.7971747544643507`*^9, 3.797174755661996*^9}, {
  3.797174889948656*^9, 3.7971749084621964`*^9}, {3.7971752315373096`*^9, 
  3.797175271894486*^9}, {3.7971867368688593`*^9, 3.797186736926545*^9}},
 CellLabel->
  "In[255]:=",ExpressionUUID->"782b3a94-7a08-48b8-8a60-cbe7712c86ca"],

Cell[BoxData[{
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"\"\<../Notes_Peter/Graphics/Spectrum_Vs_BX-J_4-W_\>\"", "~~", 
    RowBox[{"ToString", "[", "WVal", "]"}], "~~", "\"\<-x_\>\"", "~~", 
    RowBox[{"ToString", "[", "xVal", "]"}], "~~", "\"\<.pdf\>\""}], ",", " ", 
   "plot1"}], "]"}]}], "Input",
 CellChangeTimes->{{3.797174417004724*^9, 3.797174418884845*^9}, 
   3.797185135503376*^9},
 CellLabel->
  "In[151]:=",ExpressionUUID->"d63445b9-ae41-4f38-b857-7f2b7b0c0af5"],

Cell[BoxData[{
 RowBox[{"WVal", "*", 
  RowBox[{
   RowBox[{"esys", "[", "xVal", "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Conjugate", "[", 
      RowBox[{
       RowBox[{"esys", "[", "xVal", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "i"}], "]"}], "]"}], "]"}], ".", "JzOp", ".", 
     RowBox[{
      RowBox[{"esys", "[", "xVal", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "i"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{
       RowBox[{"2", "*", "JVal"}], "+", "1"}]}], "}"}]}], "]"}], "//", 
  "Chop"}]}], "Input",
 CellChangeTimes->{{3.797093190611351*^9, 3.7970932180792503`*^9}, {
  3.797093253296327*^9, 3.797093316758301*^9}, {3.7970935596895037`*^9, 
  3.7970935609004803`*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"7ae0aceb-323e-4c2a-b7c0-770ccd4ce8d9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"esys", "[", "xVal", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "i"}], "]"}], "]"}], ".", "JzOp", ".", 
     RowBox[{
      RowBox[{"esys", "[", "xVal", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{
       RowBox[{"2", "*", "JVal"}], "+", "1"}]}], "}"}]}], "]"}], "//", 
  "Chop"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sqrt", "[", 
   RowBox[{"20", "/", "3"}], "]"}], "//", "N"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"energies", "[", 
   RowBox[{"[", "5", "]"}], "]"}], "-", 
  RowBox[{"energies", "[", 
   RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"40", "/", "3"}], "/", "%"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.797095088111053*^9, 3.797095183295354*^9}, {
  3.797095282764439*^9, 3.7970953628113117`*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"9b2028ab-aa36-491b-a29a-8447f9bd4dee"],

Cell["Magnetization in finite field", "Text",
 CellChangeTimes->{{3.79709245886586*^9, 3.7970924678399563`*^9}, {
  3.797097004106513*^9, 3.797097006350685*^9}, {3.797102404987516*^9, 
  3.79710240569556*^9}},
 Background->GrayLevel[
  0.85],ExpressionUUID->"748fbd33-a5fa-481b-8c23-be5ff061c56e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"magX", "[", 
    RowBox[{"Bfield_", ",", "Temp_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"ZB", "[", 
      RowBox[{"Bfield", ",", "Temp"}], "]"}]}], "*", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Conjugate", "[", 
         RowBox[{
          RowBox[{"esysB", "[", 
           RowBox[{"Bfield", ",", "WVal", ",", "xVal"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "i"}], "]"}], "]"}], "]"}], ".", "JxOp", ".", 
        RowBox[{
         RowBox[{"esysB", "[", 
          RowBox[{"Bfield", ",", "WVal", ",", "xVal"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "i"}], "]"}], "]"}]}], " ", "*", 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"esysB", "[", 
              RowBox[{"Bfield", ",", "WVal", ",", "xVal"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "i"}], "]"}], "]"}], "-", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"esysB", "[", 
               RowBox[{"Bfield", ",", "WVal", ",", "xVal"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ")"}]}], "/", "Temp"}],
         "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{
         RowBox[{"2", "*", "JVal"}], "+", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.797092468495714*^9, 3.79709250035081*^9}, {
   3.797092651331514*^9, 3.7970927961129827`*^9}, {3.797095445201747*^9, 
   3.797095449037384*^9}, {3.7970958842573023`*^9, 3.797095891615671*^9}, 
   3.797095978403713*^9, 3.7970972689182568`*^9, {3.797185147207944*^9, 
   3.79718514739859*^9}, {3.7971852408480387`*^9, 3.797185241006818*^9}},
 CellLabel->
  "In[257]:=",ExpressionUUID->"54591601-c93d-411e-a855-94f963dfbeca"],

Cell[BoxData[
 RowBox[{"plot1", "=", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"magX", "[", 
       RowBox[{"B", ",", "1"}], "]"}], ",", 
      RowBox[{"magX", "[", 
       RowBox[{"B", ",", "50"}], "]"}], ",", 
      RowBox[{"magX", "[", 
       RowBox[{"B", ",", "100"}], "]"}], ",", 
      RowBox[{"magX", "[", 
       RowBox[{"B", ",", "300"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"B", ",", "0", ",", "10"}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(M\), \
\(x\)]\)/(\!\(\*SubscriptBox[\(\[Mu]\), \(B\)]\)\!\(\*SubscriptBox[\(g\), \(J\
\)]\))\>\"", ",", "\"\<\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<B (T)\>\"", ",", "\"\<\>\""}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"Placed", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<T=1K\>\"", ",", "\"\<T=50K\>\"", ",", "\"\<T=100K\>\"", ",", 
         "\"\<T=300K\>\""}], "}"}], ",", "Above"}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.79709279725414*^9, 3.79709283037326*^9}, {
   3.797092895029755*^9, 3.797092895446526*^9}, 3.7970937485300703`*^9, {
   3.797097011149433*^9, 3.797097025966505*^9}, {3.797097104784625*^9, 
   3.797097120523793*^9}, {3.797097153877613*^9, 3.797097162955976*^9}, {
   3.797097216753148*^9, 3.7970972202747927`*^9}, {3.797097279270802*^9, 
   3.797097283677964*^9}, {3.797097540282523*^9, 3.797097575449111*^9}, {
   3.797175376143649*^9, 3.797175425518318*^9}, {3.797175473535611*^9, 
   3.797175476043096*^9}, {3.797185149688875*^9, 3.797185155846217*^9}, {
   3.7971852332791233`*^9, 3.797185237918827*^9}},
 CellLabel->
  "In[258]:=",ExpressionUUID->"a6a0aa5f-08b1-4e04-bdde-4d996193b927"],

Cell[BoxData[{
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"\"\<../Notes_Peter/Graphics/MagnetizationX_Vs_B-J_4-W_\>\"", "~~", 
    RowBox[{"ToString", "[", "WVal", "]"}], "~~", "\"\<-x_\>\"", "~~", 
    RowBox[{"ToString", "[", "xVal", "]"}], "~~", "\"\<.pdf\>\""}], ",", " ", 
   "plot1"}], "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.797175431938917*^9, 3.797175447492741*^9}, 
   3.79717568021587*^9, {3.7971852547672586`*^9, 
   3.7971852549743967`*^9}},ExpressionUUID->"17b811f0-b72e-4a13-bfa7-\
e86356fd9b19"],

Cell[BoxData[
 RowBox[{"plot1", "=", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"magX", "[", 
      RowBox[{"B", ",", "1"}], "]"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"B", ",", "0", ",", "50"}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(M\), \(x\)]\)/\!\(\*SubscriptBox[\(\[Mu]\), \
\(B\)]\)\!\(\*SubscriptBox[\(g\), \(J\)]\)\>\"", ",", "\"\<\>\""}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"\"\<B (T)\>\"", ",", "\"\<\>\""}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", "\"\<Expressions\>\""}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.797102240765374*^9, 3.7971022487091293`*^9}, {
  3.797102326203043*^9, 3.797102327118113*^9}, {3.7971756571273203`*^9, 
  3.797175657766761*^9}, {3.79717606172987*^9, 3.79717606178377*^9}, {
  3.7971852616157084`*^9, 
  3.797185264606319*^9}},ExpressionUUID->"8dfbb335-5e47-4af8-9571-\
a2a6a75c629c"],

Cell[BoxData[{
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{
   "\"\<../Notes_Peter/Graphics/MagnetizationX_Vs_B-Larger_B-J_4-W_\>\"", "~~", 
    RowBox[{"ToString", "[", "WVal", "]"}], "~~", "\"\<-x_\>\"", "~~", 
    RowBox[{"ToString", "[", "xVal", "]"}], "~~", "\"\<.pdf\>\""}], ",", " ", 
   "plot1"}], "]"}]}], "Input",
 CellChangeTimes->{{3.797176072064929*^9, 3.797176080263286*^9}, 
   3.797185269319586*^9},ExpressionUUID->"e3674587-0af9-44a1-90be-\
9b478f79613b"],

Cell["Susceptibility", "Text",
 CellChangeTimes->{{3.7971023556973143`*^9, 3.797102363156039*^9}},
 Background->GrayLevel[
  0.85],ExpressionUUID->"779d77f6-a578-434b-968a-5742f4367f2a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BfieldVal", "=", "0.001"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"chiX", "[", "Temp_", "]"}], ":=", 
   RowBox[{"gVal", "*", "\[Mu]BVal", "*", 
    RowBox[{
     RowBox[{"magX", "[", 
      RowBox[{"BfieldVal", ",", "Temp"}], "]"}], "/", "BfieldVal"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.797097222219215*^9, 3.7970972662744427`*^9}, 
   3.7970973201114397`*^9, {3.7970975959393806`*^9, 3.79709765000082*^9}, {
   3.797100860125086*^9, 3.797100864221684*^9}, {3.797185275007655*^9, 
   3.797185277334392*^9}},ExpressionUUID->"c226a74a-6db4-4896-965b-\
efac485c3a5c"],

Cell[BoxData[
 RowBox[{"plot2", "=", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"chiX", "[", "Temp", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"Temp", ",", "1", ",", "300"}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(\[Chi]\), \(x\)]\) for single ion (dimless)\
\>\"", ",", "\"\<\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<T (K)\>\"", ",", "\"\<\>\""}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.797097324961033*^9, 3.7970973499365063`*^9}, {
  3.7970977000898647`*^9, 3.797097720238015*^9}, {3.797102200890143*^9, 
  3.7971022180246077`*^9}, {3.797175717647236*^9, 3.797175746798649*^9}, {
  3.797175780248435*^9, 3.797175805534971*^9}, {3.797185279358679*^9, 
  3.797185283190592*^9}},ExpressionUUID->"1d589973-b745-4abe-b04e-\
43e6c3aa4189"],

Cell[BoxData[{
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"\"\<../Notes_Peter/Graphics/SusceptibilityX_Vs_T-J_4-W_\>\"", "~~", 
    RowBox[{"ToString", "[", "WVal", "]"}], "~~", "\"\<-x_\>\"", "~~", 
    RowBox[{"ToString", "[", "xVal", "]"}], "~~", "\"\<.pdf\>\""}], ",", " ", 
   "plot2"}], "]"}]}], "Input",
 CellChangeTimes->{{3.797175668046732*^9, 3.797175675846446*^9}, {
  3.797175740806499*^9, 3.797175740870315*^9}, {3.797175795871879*^9, 
  3.7971758018805428`*^9}, {3.79718528729462*^9, 
  3.797185287462672*^9}},ExpressionUUID->"f59f78e8-fad4-4bde-9fd5-\
f2a915649850"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Mu]BVal", "^", "2"}], "*", 
  RowBox[{
   RowBox[{"gVal", "^", "2"}], "/", "kBVal"}], "*", "JVal", "*", 
  RowBox[{"(", 
   RowBox[{"JVal", "+", "1"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.797101238532258*^9, 3.797101276417392*^9}},
 CellLabel->
  "In[136]:=",ExpressionUUID->"307301d3-e44b-446c-8e4d-49cdda8b5912"],

Cell[BoxData[
 RowBox[{"6", "*", 
  RowBox[{"10", "^", "23"}], "*", "40", "*", "5", "*", 
  RowBox[{"10", "^", 
   RowBox[{"(", 
    RowBox[{"-", "25"}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.797102178150481*^9, 3.7971021915664873`*^9}, 
   3.797102345961636*^9},ExpressionUUID->"75642e31-a7ac-49d3-be14-\
5e9e45d6f971"],

Cell["\<\
Check that I am getting the correct van-Vleck susceptibility in the low \
temperature limit. Important: this requires that the GS be the singlet and I \
need to use the energy splitting to the triplet with dipole moment 1/2. This \
depends on the choice of W and x and since these are randomly drawn, the two \
cells below may not work if the ground state is different or the triplet is \
not the first excited state (this occurs for x=-0.380623, for which I have \
checked my calculation). \
\>", "Text",
 CellChangeTimes->{{3.7970968647143*^9, 
  3.7970969933233213`*^9}},ExpressionUUID->"6d1167ca-d7f7-4c44-883e-\
bb74c289a0b4"],

Cell[BoxData["xVal"], "Input",
 CellChangeTimes->{{3.79709697446278*^9, 
  3.797096998594058*^9}},ExpressionUUID->"eeead360-fbe6-46d0-951c-\
7b8876bef1ec"],

Cell[BoxData[
 RowBox[{
  RowBox[{"kBVal", "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"gJLS", "[", 
      RowBox[{"JVal", ",", "LVal", ",", "SVal"}], "]"}], "*", "\[Mu]BVal"}], 
    ")"}]}], "*", 
  RowBox[{
   RowBox[{"magZ", "[", 
    RowBox[{"0.01", ",", "1"}], "]"}], "/", "0.01"}]}]], "Input",
 CellChangeTimes->{{3.797094020834476*^9, 3.797094048870845*^9}, {
   3.797094322261258*^9, 3.797094330128172*^9}, {3.797095454047832*^9, 
   3.797095460074473*^9}, {3.797095814642474*^9, 3.79709582333989*^9}, {
   3.7970960994682703`*^9, 3.797096101943779*^9}, {3.797096670767456*^9, 
   3.79709667394707*^9}, {3.7970967728621683`*^9, 3.797096783757464*^9}, {
   3.7970968329987707`*^9, 3.7970968382661257`*^9}, 3.7970974055264177`*^9},
 CellLabel->
  "In[123]:=",ExpressionUUID->"86192fa8-519c-494e-ba9a-4adbd02af4f7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"40", "/", "3"}], "/", 
  RowBox[{
   RowBox[{"Sort", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"esysB", "[", 
       RowBox[{"0", ",", "WVal", ",", "xVal"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "-", 
     RowBox[{"Min", "[", 
      RowBox[{
       RowBox[{"esysB", "[", 
        RowBox[{"0", ",", "WVal", ",", "xVal"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], "[", 
   RowBox[{"[", "2", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7970939979411287`*^9, 3.797094012980019*^9}, {
  3.797094075908804*^9, 3.7970940981513977`*^9}, {3.797095057281535*^9, 
  3.797095068934136*^9}, {3.797096117629939*^9, 3.797096142761301*^9}, {
  3.797096651072448*^9, 3.797096653110276*^9}},
 CellLabel->
  "In[107]:=",ExpressionUUID->"a2a9afe3-4e6f-4bdc-a0a1-f43f2f4f15ca"],

Cell[BoxData[{
 RowBox[{"kBVal", "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"gJLS", "[", 
     RowBox[{"JVal", ",", "LVal", ",", "SVal"}], "]"}], "*", "\[Mu]BVal"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gJLS", "[", 
   RowBox[{"JVal", ",", "LVal", ",", "SVal"}], "]"}], "*", 
  "\[Mu]BVal"}]}], "Input",
 CellChangeTimes->{{3.797097448334342*^9, 3.7970974485314617`*^9}},
 CellLabel->
  "In[125]:=",ExpressionUUID->"e10a2e10-582e-405a-bdef-de47c379569c"]
}, Closed]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1263, 802},
WindowMargins->{{-4, Automatic}, {Automatic, 0}},
Magnification:>1.25 Inherited,
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 247, 4, 37, "Input",ExpressionUUID->"b6889cbf-092d-4631-b0b0-83a81301ce86"],
Cell[CellGroupData[{
Cell[830, 28, 404, 11, 85, "Section",ExpressionUUID->"a9bf1534-f8b6-4fd8-961f-1ae775dca244"],
Cell[1237, 41, 391, 10, 37, "Input",ExpressionUUID->"2470a8b0-ea07-49ea-8b21-5dd21cc2a654"],
Cell[1631, 53, 268, 5, 37, "Input",ExpressionUUID->"396db1b6-ec94-486b-a29f-b3144caca921"],
Cell[CellGroupData[{
Cell[1924, 62, 205, 3, 67, "Subsection",ExpressionUUID->"78f1aeb3-4212-42f4-9f21-c29dbe185c99"],
Cell[2132, 67, 668, 17, 105, "Text",ExpressionUUID->"eca34ae6-895b-4e8e-ae54-e257409d1a43"],
Cell[2803, 86, 483, 10, 90, "Input",ExpressionUUID->"2f78e5f5-c5a5-4096-b88d-9f5604609452"],
Cell[3289, 98, 604, 10, 37, "Input",ExpressionUUID->"12083657-6ffa-4efc-a749-b212db2ef916"],
Cell[3896, 110, 536, 14, 37, "Input",ExpressionUUID->"18a60e99-f3ee-40fb-b8e3-34047c0c6a99"],
Cell[4435, 126, 701, 20, 37, "Input",ExpressionUUID->"383d0bba-95b6-4743-8145-f4376bc054b4"],
Cell[5139, 148, 613, 14, 142, "Input",ExpressionUUID->"faa33a26-6d45-4bca-9019-bbba1ac77858"],
Cell[5755, 164, 376, 7, 58, "Input",ExpressionUUID->"abf59614-5503-48b4-9a3a-00726c900e47"]
}, Closed]],
Cell[CellGroupData[{
Cell[6168, 176, 273, 6, 46, "Subsection",ExpressionUUID->"e39a8fd0-b244-4e32-b758-b7c5bd66e8b9"],
Cell[6444, 184, 331, 7, 93, "Text",ExpressionUUID->"1db26ad8-394b-445e-b180-af76e4a63258"],
Cell[6778, 193, 507, 10, 90, "Input",ExpressionUUID->"4851e210-e511-40e2-85bf-6c93821ac2b4"],
Cell[7288, 205, 1793, 53, 168, "Input",ExpressionUUID->"c721a359-c6e6-4c3d-95fc-086410efe36d"],
Cell[9084, 260, 383, 8, 73, "Text",ExpressionUUID->"85ec11e7-a484-4688-81fe-0810ec4d12e3"],
Cell[9470, 270, 1775, 47, 142, "Input",ExpressionUUID->"df6a1337-8777-4083-af04-a43c1c3f9621"],
Cell[11248, 319, 347, 7, 37, "Input",ExpressionUUID->"fd74fb8c-a046-4640-8808-c34dbf028d2f"],
Cell[11598, 328, 339, 7, 44, "Text",ExpressionUUID->"45e7827b-9760-4f7f-8a0d-e47b74838b75"],
Cell[11940, 337, 551, 13, 64, "Input",ExpressionUUID->"55c58caf-8e15-4b78-9d5b-e957ada6a72b"],
Cell[12494, 352, 715, 12, 102, "Text",ExpressionUUID->"cfd8cee3-1c14-4ca9-840f-6067ddb0b019"],
Cell[13212, 366, 1054, 30, 90, "Input",ExpressionUUID->"837c2359-fd69-4b0e-a80b-a5fc29e1799d"],
Cell[14269, 398, 847, 15, 131, "Text",ExpressionUUID->"590f09c2-238d-4b7e-875b-5eb04d45ed0f"],
Cell[15119, 415, 233, 5, 37, "Input",ExpressionUUID->"c61dff08-a760-41c2-b529-f7002dec7a3c"],
Cell[15355, 422, 1959, 58, 130, "Text",ExpressionUUID->"3073a13e-b68b-49ea-8733-dc7cb6706652"],
Cell[17317, 482, 3394, 99, 220, "Input",ExpressionUUID->"a40fcd0c-cadc-476c-bb48-84905773cac6"],
Cell[20714, 583, 376, 9, 37, "Input",ExpressionUUID->"a8110a6b-b666-429f-b2b5-f31f73e9ce9b"],
Cell[21093, 594, 426, 9, 116, "Input",ExpressionUUID->"a100a6a7-a295-427f-a971-7069b3cf8260"],
Cell[21522, 605, 1336, 33, 116, "Input",ExpressionUUID->"55e8b138-4db9-4593-8e6d-0b979711a784"],
Cell[22861, 640, 596, 10, 102, "Text",ExpressionUUID->"7fde4379-68e9-460d-a95a-266c400787eb"],
Cell[23460, 652, 662, 15, 90, "Input",ExpressionUUID->"42ed261e-dcc6-4563-8bb0-529dadeff9db"],
Cell[24125, 669, 651, 16, 116, "Input",ExpressionUUID->"76f27a93-c841-4aa2-af7e-ef4540034b08"],
Cell[24779, 687, 308, 7, 73, "Text",ExpressionUUID->"ea2561a0-f991-427e-b849-efe728360e78"],
Cell[25090, 696, 3507, 103, 220, "Input",ExpressionUUID->"83dd25c2-9136-4679-9b76-e9e8a41bd96d"],
Cell[28600, 801, 840, 14, 131, "Text",ExpressionUUID->"2fc83329-0f64-4e71-ae90-91a59644c6c2"],
Cell[29443, 817, 1822, 48, 168, "Input",ExpressionUUID->"dbf2346c-eb06-4307-afd7-3e13b05b7417"]
}, Closed]],
Cell[CellGroupData[{
Cell[31302, 870, 262, 4, 46, "Subsection",ExpressionUUID->"3bcc91e8-5c47-4d37-a073-123fd4eedd5c"],
Cell[31567, 876, 488, 8, 37, "Input",ExpressionUUID->"3c71171a-6771-4655-a1f1-69b4df9d23ba"],
Cell[CellGroupData[{
Cell[32080, 888, 286, 6, 56, "Subsubsection",ExpressionUUID->"c61ff541-c6d2-4279-9687-2b592c633c46"],
Cell[32369, 896, 175, 3, 44, "Text",ExpressionUUID->"483999b9-f0fa-42cb-84c8-b1d66236d60b"],
Cell[32547, 901, 2397, 64, 168, "Input",ExpressionUUID->"e6f4001b-631e-455f-835e-da77c27e06d3"],
Cell[34947, 967, 437, 10, 37, "Input",ExpressionUUID->"5ec537de-fa30-414a-8d24-52a99acc3e8e"],
Cell[35387, 979, 247, 4, 44, "Text",ExpressionUUID->"0965468b-f227-4876-bc28-aabe7b4d12ca"],
Cell[35637, 985, 1248, 29, 64, "Input",ExpressionUUID->"28c76200-b54d-4dd3-aa3c-fcc0ef7db570"],
Cell[36888, 1016, 629, 14, 90, "Input",ExpressionUUID->"f44afcea-a7a9-41c4-bf2e-812848adcbd4"],
Cell[37520, 1032, 307, 7, 44, "Text",ExpressionUUID->"a517d524-78b4-4d22-934a-06a871ec2b72"],
Cell[37830, 1041, 995, 24, 90, "Input",ExpressionUUID->"e9180422-2dd7-4e31-b120-c849635d2c3f"],
Cell[38828, 1067, 173, 2, 37, "Input",ExpressionUUID->"09fdfc84-b9fa-4bce-8cb4-56add991d900"],
Cell[39004, 1071, 999, 16, 188, "Text",ExpressionUUID->"acfe5f00-43c9-401f-af7d-b012f7c866da"],
Cell[40006, 1089, 443, 8, 37, "Input",ExpressionUUID->"2af1a664-9088-4a3a-91f7-442263963528"],
Cell[40452, 1099, 1622, 49, 220, "Input",ExpressionUUID->"da0b62aa-79b3-48c5-b8b6-bc29b0de1b53"],
Cell[42077, 1150, 592, 16, 37, "Input",ExpressionUUID->"cba7878b-ba1e-4e70-9452-5e56f6c87994"],
Cell[42672, 1168, 495, 11, 37, "Input",ExpressionUUID->"f90de261-ec60-4e83-abe9-fab3c95790dd"],
Cell[43170, 1181, 829, 19, 64, "Input",ExpressionUUID->"39092391-3ec3-45e3-9e23-dca1961ba91b"],
Cell[44002, 1202, 274, 4, 37, "Input",ExpressionUUID->"ee0d5c09-e3dc-49a6-90f0-512d3412b65d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44313, 1211, 218, 4, 56, "Subsubsection",ExpressionUUID->"fb181d3d-1003-4a7d-b1bd-e4a844e0bedf"],
Cell[44534, 1217, 1205, 33, 142, "Input",ExpressionUUID->"709c17e3-fe44-4ba6-bb73-aeed8dfedfb8"],
Cell[45742, 1252, 166, 2, 64, "Input",ExpressionUUID->"f67574d1-7b9b-4d10-9fc9-abeace37b21e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45945, 1259, 502, 12, 57, "Subsubsection",ExpressionUUID->"a32fda8e-ab15-48b0-80b4-d37b91b2f0b8"],
Cell[46450, 1273, 570, 13, 73, "Text",ExpressionUUID->"fdf51dde-b84b-426c-85a8-e1d6b5278bd7"],
Cell[47023, 1288, 108, 1, 37, "Input",ExpressionUUID->"3a7a1e1e-e1b5-43b8-8b08-0ce6e74065c5"],
Cell[47134, 1291, 2484, 58, 142, "Input",ExpressionUUID->"bef15d7b-dc02-4239-b32a-cb9093cc7403"],
Cell[49621, 1351, 1305, 33, 90, "Input",ExpressionUUID->"f4f8bb26-429e-4542-ad5b-3e9b5b8083e9"],
Cell[50929, 1386, 516, 11, 90, "Input",ExpressionUUID->"442690f6-2454-4601-9495-97a7aeef30b0"],
Cell[51448, 1399, 565, 10, 102, "Text",ExpressionUUID->"55867764-e697-4a4d-9465-08dd15478763"],
Cell[52016, 1411, 694, 18, 90, "Input",ExpressionUUID->"8784ba65-d682-46d8-b4f1-85a9534332e4"],
Cell[52713, 1431, 4867, 138, 376, "Input",ExpressionUUID->"5e780ecb-51a7-4f56-87bd-96b0cefe1520"],
Cell[57583, 1571, 4649, 138, 402, "Input",ExpressionUUID->"35513c7d-c419-414e-a241-f6949af47912"],
Cell[62235, 1711, 1083, 28, 64, "Input",ExpressionUUID->"86f66e92-9726-4a72-99c3-a402a13ed8a5"],
Cell[63321, 1741, 1396, 32, 64, "Input",ExpressionUUID->"d91792ff-d688-44c2-b21c-ea2fb13d9511"],
Cell[64720, 1775, 587, 12, 64, "Input",ExpressionUUID->"5216f837-c289-4f89-a021-23ed05120aa1"],
Cell[65310, 1789, 2542, 70, 194, "Input",ExpressionUUID->"02b5ccab-d826-4c25-9715-799b4950e905"],
Cell[67855, 1861, 2647, 88, 324, "Input",ExpressionUUID->"ddb1dedc-3ddc-4f84-b582-165c1049b110"],
Cell[70505, 1951, 453, 8, 73, "Text",ExpressionUUID->"09ca0625-0482-49ae-9f85-e9b4b1a99bcc"],
Cell[70961, 1961, 381, 11, 37, "Input",ExpressionUUID->"0ab12f6b-1528-4eb2-84a3-2594faae88c4"],
Cell[71345, 1974, 2933, 79, 194, "Input",ExpressionUUID->"242a30e4-11a6-4cf0-b301-75b21155017f"],
Cell[74281, 2055, 577, 13, 90, "Input",ExpressionUUID->"a7ef5b45-b265-46b8-9b5f-0fd58b55199a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[74895, 2073, 199, 3, 56, "Subsubsection",ExpressionUUID->"32864a20-a379-4b59-aaa3-613288c98379"],
Cell[75097, 2078, 373, 8, 73, "Text",ExpressionUUID->"ae086a8b-b81f-40f0-a613-69ae6de3af84"],
Cell[75473, 2088, 1152, 36, 90, "Input",ExpressionUUID->"f903e549-e6d5-4adb-b603-16d8f5b327e5"],
Cell[76628, 2126, 412, 8, 67, "Text",ExpressionUUID->"f2ded8f6-52cf-4733-b25a-2c93f56ae18f"],
Cell[77043, 2136, 287, 7, 37, "Input",ExpressionUUID->"84a6fea8-79e4-479c-a690-843c6422308c"],
Cell[77333, 2145, 553, 13, 31, "Input",ExpressionUUID->"ec512b74-b1de-4423-97e0-a8a7b8b3795f"],
Cell[77889, 2160, 735, 19, 37, "Input",ExpressionUUID->"06db0f84-c1da-4013-849f-54ba42c0f41a"],
Cell[78627, 2181, 149, 3, 64, "Input",ExpressionUUID->"eb1c0d09-4942-4a44-b04c-543fe8161f3e"],
Cell[78779, 2186, 1271, 25, 37, "Input",ExpressionUUID->"ee882c64-9da0-4ca2-a7af-6ada4bc7eae2"],
Cell[80053, 2213, 326, 8, 102, "Text",ExpressionUUID->"44223311-3a23-4bdf-bec0-45b787cb3ad4"],
Cell[80382, 2223, 339, 7, 37, "Input",ExpressionUUID->"3d724e9d-5d01-467c-9b47-4558963b8f05"],
Cell[80724, 2232, 197, 3, 44, "Text",ExpressionUUID->"46ad4d26-d9cd-497b-b08c-13229acf8029"],
Cell[80924, 2237, 283, 7, 37, "Input",ExpressionUUID->"6c78a36d-489d-433a-82f3-1e4d92faf908"],
Cell[81210, 2246, 479, 9, 73, "Text",ExpressionUUID->"8d847b42-d0a4-4881-a4fe-46d3aa345b27"],
Cell[81692, 2257, 1377, 35, 168, "Input",ExpressionUUID->"241418ca-1882-4cf6-a702-683e3d005bc3"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[83130, 2299, 526, 15, 66, "Section",ExpressionUUID->"86f40345-9a84-4b0c-b55a-eed63958a67a"],
Cell[83659, 2316, 694, 12, 102, "Text",ExpressionUUID->"30f55759-10c3-4a8b-8e65-30e4b02f008c"],
Cell[84356, 2330, 764, 19, 116, "Input",ExpressionUUID->"b67349fc-ade4-4baf-8b8f-762bd88f85ac"],
Cell[CellGroupData[{
Cell[85145, 2353, 277, 4, 67, "Subsection",ExpressionUUID->"24eb721b-e39b-41e3-aab5-a754030f7e28"],
Cell[85425, 2359, 442, 11, 37, "Input",ExpressionUUID->"2e57baf6-f970-4ad0-8f71-d868068ab8a3"],
Cell[85870, 2372, 321, 7, 37, "Input",ExpressionUUID->"04b14a7b-1876-442a-8a30-c3ed730bcadb"],
Cell[86194, 2381, 1097, 34, 73, "Text",ExpressionUUID->"850b6140-30c9-4406-b9bd-124362fdc1b1"],
Cell[87294, 2417, 1855, 46, 142, "Input",ExpressionUUID->"47f0162e-7eac-4b39-97b7-3515ad0a5914"],
Cell[89152, 2465, 2578, 61, 142, "Input",ExpressionUUID->"2eb8093b-d183-47e7-b0c3-ec0923aebcd0"],
Cell[91733, 2528, 748, 20, 90, "Input",ExpressionUUID->"6d6eb012-3e61-4378-aecd-1d8475aa514e"],
Cell[92484, 2550, 1329, 29, 64, "Input",ExpressionUUID->"71cc245c-35c2-43bb-87a0-16ebfe0ab91d"],
Cell[93816, 2581, 1390, 33, 90, "Input",ExpressionUUID->"4018c797-0f0e-41ed-b5b0-1e6f2c73f1c9"],
Cell[95209, 2616, 310, 6, 37, "Input",ExpressionUUID->"df212735-f391-461d-943e-26c4b2df4626"],
Cell[95522, 2624, 433, 13, 47, "Text",ExpressionUUID->"be023d4b-db9b-4cfa-8d54-4ce11da5f624"],
Cell[95958, 2639, 4306, 115, 324, "Input",ExpressionUUID->"85e3d053-5979-4abf-85d6-aa5501cdf7d0"],
Cell[100267, 2756, 859, 23, 73, "Text",ExpressionUUID->"95ab0dd5-0639-439e-95bf-2cc13d73c305"],
Cell[101129, 2781, 2296, 62, 220, "Input",ExpressionUUID->"26ddbd90-7f55-43a3-bbd2-33a5d953db37"],
Cell[103428, 2845, 466, 10, 37, "Input",ExpressionUUID->"7727067c-1360-485c-b9f2-790a8b8e1a4b"],
Cell[103897, 2857, 225, 5, 44, "Text",ExpressionUUID->"09d435c6-bf67-4797-98ed-e5bc1d38c012"],
Cell[104125, 2864, 2487, 51, 220, "Input",ExpressionUUID->"e50cca83-c1b7-4285-a08f-55a87b80e864"],
Cell[106615, 2917, 222, 5, 44, "Text",ExpressionUUID->"f23043ab-4569-4b66-a489-c56d42c53d3b"],
Cell[106840, 2924, 8085, 194, 1026, "Input",ExpressionUUID->"83516c46-f2b5-4d93-b875-6628579d1543"],
Cell[114928, 3120, 227, 5, 44, "Text",ExpressionUUID->"24a0df4a-bb3f-436a-adf8-fb315d303b15"],
Cell[115158, 3127, 1534, 36, 64, "Input",ExpressionUUID->"dd3efdaf-7d7c-4cdd-b8a7-b7321f6e44eb"],
Cell[116695, 3165, 479, 11, 90, "Input",ExpressionUUID->"1efeba03-4185-4ba0-9516-da3f6acc4ce5"],
Cell[117177, 3178, 424, 8, 73, "Text",ExpressionUUID->"29d8fce6-b9ea-44d7-b2ee-ad28ced3e224"],
Cell[117604, 3188, 1016, 18, 64, "Input",ExpressionUUID->"63ec70f2-7af0-4d8c-9f6e-b5f2d6a04fc6"],
Cell[118623, 3208, 1241, 35, 116, "Input",ExpressionUUID->"6122f8b9-408b-4a3f-a98c-5e140ad66e76"],
Cell[119867, 3245, 660, 16, 37, "Input",ExpressionUUID->"7f5a2018-3955-40e9-af99-57d14b491eae"],
Cell[120530, 3263, 196, 3, 44, "Text",ExpressionUUID->"36cb6760-da0b-4efe-b90b-82fec91ad3e2"],
Cell[120729, 3268, 1505, 41, 90, "Input",ExpressionUUID->"de0ea3f8-2690-44f3-9a4b-461cc2e35c40"],
Cell[122237, 3311, 641, 19, 64, "Input",ExpressionUUID->"71cb9c34-8801-4571-84ab-f2bdb01e8a43"]
}, Open  ]],
Cell[CellGroupData[{
Cell[122915, 3335, 241, 5, 67, "Subsection",ExpressionUUID->"101b3432-38c6-4cf5-81ab-5fc6ddb28077"],
Cell[123159, 3342, 222, 5, 44, "Text",ExpressionUUID->"b583c3fd-698c-42ac-996a-6190aae6004f"],
Cell[123384, 3349, 2063, 54, 90, "Input",ExpressionUUID->"3018019f-471c-432b-b260-97364df61dbb"],
Cell[125450, 3405, 1757, 51, 90, "Input",ExpressionUUID->"23e1b422-6204-452e-bf35-5e0cbc225054"],
Cell[127210, 3458, 1872, 42, 116, "Input",ExpressionUUID->"0d576976-de2e-4fe5-8326-551add2d64b0"],
Cell[129085, 3502, 677, 14, 64, "Input",ExpressionUUID->"d1d6f116-d5ab-4ed6-80d9-585ba0d14d48"]
}, Closed]],
Cell[CellGroupData[{
Cell[129799, 3521, 270, 6, 46, "Subsection",ExpressionUUID->"bde64d0f-869b-4c7c-b40d-eb16a1d992b7"],
Cell[130072, 3529, 776, 18, 90, "Input",ExpressionUUID->"e1f86394-44e1-492d-bc06-8f88ba4eaef8"],
Cell[130851, 3549, 269, 6, 64, "Input",ExpressionUUID->"9276c180-8308-48c9-8330-ac940e6aa914"],
Cell[131123, 3557, 554, 15, 139, "Input",ExpressionUUID->"4368b146-7dd0-411d-a617-49f229e812b7"],
Cell[CellGroupData[{
Cell[131702, 3576, 173, 3, 56, "Subsubsection",ExpressionUUID->"314ab424-b2f6-4ffe-80c1-cd11939d9bbe"],
Cell[131878, 3581, 959, 22, 64, "Input",ExpressionUUID->"0b23a4e9-30c1-42a1-9dbf-65f1a8472b9e"],
Cell[132840, 3605, 1546, 42, 116, "Input",ExpressionUUID->"f940bede-a450-47ad-9493-fe20a168ea1b"],
Cell[134389, 3649, 418, 11, 37, "Input",ExpressionUUID->"49ef8df6-970a-4d8e-aa55-9452873cfc71"],
Cell[134810, 3662, 480, 12, 64, "Input",ExpressionUUID->"ee85ae95-a2c5-43c9-9d3c-7631c756c257"],
Cell[135293, 3676, 3165, 78, 168, "Input",ExpressionUUID->"cdb329fe-cc1d-4977-82e8-3ae58d7a12ad"],
Cell[138461, 3756, 661, 14, 64, "Input",ExpressionUUID->"6bddb1e8-fccc-4cba-b47a-d22d28446824"],
Cell[139125, 3772, 390, 7, 90, "Input",ExpressionUUID->"20341e1d-8ee5-4fec-bbf3-7f6c6bc89de6"],
Cell[139518, 3781, 919, 25, 90, "Input",ExpressionUUID->"8483d177-416f-4304-a572-788950211242"],
Cell[140440, 3808, 598, 18, 37, "Input",ExpressionUUID->"6f9adf8d-a87b-4c74-ae56-ae9e8ca00b03"],
Cell[141041, 3828, 3743, 103, 246, "Input",ExpressionUUID->"d2c83489-d14f-4d11-932d-9464d3b5c8dc"],
Cell[144787, 3933, 297, 5, 64, "Text",ExpressionUUID->"5a6c9c81-7b43-41cc-a21c-36023417a57d"],
Cell[145087, 3940, 1864, 50, 116, "Input",ExpressionUUID->"337c198a-6e33-4377-907f-f5d72d5413ee"],
Cell[146954, 3992, 1502, 42, 64, "Input",ExpressionUUID->"723bab12-a5c3-4bdb-a3a2-7d01ed45ac35"],
Cell[148459, 4036, 1849, 44, 90, "Input",ExpressionUUID->"8051bd3d-bdd4-4a96-bbdf-b1938f000fd9"],
Cell[150311, 4082, 712, 15, 116, "Input",ExpressionUUID->"0a19fa64-25b0-4252-9eb1-2bacd63fdbfe"],
Cell[151026, 4099, 1048, 26, 64, "Input",ExpressionUUID->"17025b33-13d6-470e-952b-6ae0f1dfbfd0"],
Cell[152077, 4127, 580, 12, 90, "Input",ExpressionUUID->"2de6bd23-8707-400d-81ad-3e9257ec89d5"],
Cell[152660, 4141, 186, 3, 64, "Text",ExpressionUUID->"a8f800f6-75a4-40f9-adae-92994f5f0da2"],
Cell[152849, 4146, 615, 15, 64, "Input",ExpressionUUID->"2fab7b7d-d09f-4bfc-b151-ba29ecdbab06"],
Cell[153467, 4163, 982, 23, 64, "Input",ExpressionUUID->"edc405fa-1d89-4769-863e-2187c8f2b13a"],
Cell[154452, 4188, 934, 24, 64, "Input",ExpressionUUID->"a07c0519-6b82-424a-b5fd-f35f62a1a079"],
Cell[155389, 4214, 342, 8, 37, "Input",ExpressionUUID->"531d8889-781f-489e-9837-5833951a31e3"],
Cell[155734, 4224, 746, 15, 90, "Input",ExpressionUUID->"4e6b3ca3-7307-4d3c-8bf9-373db779e589"],
Cell[156483, 4241, 356, 9, 37, "Input",ExpressionUUID->"92c99646-2fc7-41be-a66d-ac56a83fdb34"],
Cell[156842, 4252, 325, 8, 37, "Input",ExpressionUUID->"95569e5b-4ab1-4bcc-ba84-13b25922780f"],
Cell[157170, 4262, 641, 11, 131, "Text",ExpressionUUID->"9014e7ef-24c2-4a7c-9156-b797b7b5ef0d"],
Cell[157814, 4275, 155, 3, 37, "Input",ExpressionUUID->"88d63097-8e84-41c6-82ed-98b78e630779"],
Cell[157972, 4280, 825, 18, 37, "Input",ExpressionUUID->"f223bc5a-653c-4ec4-858d-3745fbfd248f"],
Cell[158800, 4300, 841, 21, 37, "Input",ExpressionUUID->"5c960c4d-edd7-447b-b3ea-a1e3a445cd47"],
Cell[159644, 4323, 478, 13, 64, "Input",ExpressionUUID->"e03ac346-7c29-4410-b608-a3ddc7099ada"]
}, Closed]],
Cell[CellGroupData[{
Cell[160159, 4341, 222, 4, 45, "Subsubsection",ExpressionUUID->"4e39fea5-6c85-44dc-abdb-0e3ba1fa5598"],
Cell[160384, 4347, 216, 3, 64, "Input",ExpressionUUID->"4fef8d79-6593-47bf-9413-c2cdcd9ef909"],
Cell[160603, 4352, 1104, 24, 64, "Input",ExpressionUUID->"3a502131-a3e5-4106-8e85-82eb8507ce48"],
Cell[161710, 4378, 1572, 43, 116, "Input",ExpressionUUID->"1b82662d-05b5-47bb-96b6-d2dafd279e40"],
Cell[163285, 4423, 418, 11, 37, "Input",ExpressionUUID->"c2fb3aec-e425-4441-8d42-287f683c43ac"],
Cell[163706, 4436, 3213, 78, 168, "Input",ExpressionUUID->"6d1fba2a-136b-4968-a034-10e0ab57621a"],
Cell[166922, 4516, 588, 12, 90, "Input",ExpressionUUID->"b980efd1-41ca-4fa9-871b-908de7981c76"],
Cell[167513, 4530, 951, 26, 64, "Input",ExpressionUUID->"7a9168cb-5f66-4936-b7d2-4e01a3ddfe98"],
Cell[168467, 4558, 1087, 30, 142, "Input",ExpressionUUID->"4f89cfce-3337-46a5-b4e5-ec537ae6f9ca"],
Cell[169557, 4590, 297, 5, 64, "Text",ExpressionUUID->"74aba51d-9146-4fdd-9baf-cdd5161044f5"],
Cell[169857, 4597, 1961, 51, 116, "Input",ExpressionUUID->"1e105a6a-f581-4f70-bdd7-0064e6ed05ff"],
Cell[171821, 4650, 1898, 45, 90, "Input",ExpressionUUID->"07874b93-2c9b-4f12-8e2b-ef4209e5e507"],
Cell[173722, 4697, 643, 12, 116, "Input",ExpressionUUID->"3ad3e312-dd34-4654-ba20-6f378b9c7aec"],
Cell[174368, 4711, 1076, 27, 64, "Input",ExpressionUUID->"d959e63f-2707-4004-baf0-b249bc1d6e2a"],
Cell[175447, 4740, 580, 12, 90, "Input",ExpressionUUID->"f0257d01-0fb2-4288-96dd-a1cfb0b76d19"],
Cell[176030, 4754, 186, 3, 64, "Text",ExpressionUUID->"3ae9dfda-8b74-4de3-8829-7c484b1458b1"],
Cell[176219, 4759, 639, 15, 64, "Input",ExpressionUUID->"9a8a9628-9b30-4676-8f6f-afd5c5e72d49"],
Cell[176861, 4776, 1005, 23, 64, "Input",ExpressionUUID->"a9b4b730-436a-413a-91cd-abc3fa0ecf62"],
Cell[177869, 4801, 690, 13, 90, "Input",ExpressionUUID->"b5081da6-f3b6-4414-9e47-88a94173a17f"],
Cell[178562, 4816, 356, 9, 37, "Input",ExpressionUUID->"77083307-a522-45cf-b6f1-99b3cb243294"],
Cell[178921, 4827, 325, 8, 37, "Input",ExpressionUUID->"4f41b6f3-2649-4c28-baf0-13b376647f93"],
Cell[179249, 4837, 641, 11, 131, "Text",ExpressionUUID->"fc3dc837-9c39-4a67-985d-92e6b9b0a764"],
Cell[179893, 4850, 155, 3, 37, "Input",ExpressionUUID->"8846210a-18d7-4b7e-92ab-40e259e68319"],
Cell[180051, 4855, 825, 18, 37, "Input",ExpressionUUID->"428e06d1-7b52-4928-ace8-8e7de2c7545f"],
Cell[180879, 4875, 841, 21, 37, "Input",ExpressionUUID->"c8ed82f0-f205-485c-b869-3795a5f80565"],
Cell[181723, 4898, 478, 13, 64, "Input",ExpressionUUID->"2c4a00c3-ad3c-4501-b962-b8c5a6dde77b"]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[182262, 4918, 472, 13, 66, "Section",ExpressionUUID->"9b2e5264-fe89-46b4-bb0f-1071b0db6680"],
Cell[182737, 4933, 694, 12, 102, "Text",ExpressionUUID->"93eb1a45-cafd-4c0a-a1a7-ccdc27e272d2"],
Cell[183434, 4947, 1302, 35, 194, "Input",ExpressionUUID->"f194fe0b-71b4-4a94-81ac-1fed2ce384da"],
Cell[CellGroupData[{
Cell[184761, 4986, 277, 4, 67, "Subsection",ExpressionUUID->"5aeb1d11-47b6-4e0d-aaa3-6748c658e77a"],
Cell[185041, 4992, 490, 12, 37, "Input",ExpressionUUID->"a511142c-96f2-4522-884c-5e6bf87b37af"],
Cell[185534, 5006, 366, 8, 37, "Input",ExpressionUUID->"bc3fc034-1d75-4b4e-a1c2-1eb63b7e782d"],
Cell[185903, 5016, 1097, 34, 73, "Text",ExpressionUUID->"4fdc99b2-d0e3-47e9-b364-9ccd2f7a8b08"],
Cell[187003, 5052, 1863, 46, 142, "Input",ExpressionUUID->"1c5f7f3c-1dcd-46cc-8270-51ecfb594a28"],
Cell[188869, 5100, 2348, 53, 142, "Input",ExpressionUUID->"684a869f-2ff6-47b2-bec4-ffdcd314dcf8"],
Cell[191220, 5155, 1897, 55, 168, "Input",ExpressionUUID->"37b16397-174b-4d4b-a0af-b0b03417658c"],
Cell[193120, 5212, 618, 14, 142, "Input",ExpressionUUID->"ffcbaa2d-6fcf-4d24-8d90-f81d3ef8577a"],
Cell[193741, 5228, 2095, 53, 142, "Input",ExpressionUUID->"f228490f-f721-400f-bce6-c4a6789850a6"],
Cell[195839, 5283, 832, 25, 142, "Input",ExpressionUUID->"07fd5560-ae0d-4f34-8eb2-0262e62c32c0"],
Cell[196674, 5310, 2484, 57, 142, "Input",ExpressionUUID->"2ebb34f7-0668-4a49-b01d-f55749d94b7e"],
Cell[199161, 5369, 593, 11, 37, "Input",ExpressionUUID->"74fb22f4-c107-43ba-b6a1-974f691d12b4"],
Cell[199757, 5382, 225, 5, 44, "Text",ExpressionUUID->"ac9b3058-746b-488d-aaf7-e8b491f31bdf"],
Cell[199985, 5389, 3309, 72, 272, "Input",ExpressionUUID->"4e5e0dfc-49c6-47f9-a34c-be1c19cb32bd"],
Cell[203297, 5463, 420, 8, 73, "Text",ExpressionUUID->"414eac6c-e016-46d3-a263-511d3c12a90a"],
Cell[203720, 5473, 9063, 214, 1078, "Input",ExpressionUUID->"39f09912-8e2b-41ce-b895-c4e3595bb652"],
Cell[212786, 5689, 227, 5, 44, "Text",ExpressionUUID->"50e7e180-bf6d-4ead-b0b6-c8355f64d4e9"],
Cell[213016, 5696, 1926, 42, 90, "Input",ExpressionUUID->"d4afdea5-aeeb-4e1e-b7d5-2c81750e4d5e"],
Cell[214945, 5740, 320, 9, 37, "Input",ExpressionUUID->"824237e9-073c-4faa-ae92-8315245077bb"],
Cell[215268, 5751, 877, 22, 64, "Input",ExpressionUUID->"e2979ea0-3207-407b-8f7c-868d4db03d19"],
Cell[216148, 5775, 456, 11, 90, "Input",ExpressionUUID->"e56768df-2302-4602-9a0f-0315112710a8"],
Cell[216607, 5788, 424, 8, 73, "Text",ExpressionUUID->"05313c9a-c033-4f8d-a5ed-548940947b0c"],
Cell[217034, 5798, 1016, 18, 64, "Input",ExpressionUUID->"677dd59d-98f6-462a-a8f5-2926bebbf43d"],
Cell[218053, 5818, 1241, 35, 116, "Input",ExpressionUUID->"de23ec7e-998d-436f-bcbc-6f7cfb3edba0"],
Cell[219297, 5855, 660, 16, 37, "Input",ExpressionUUID->"8dbdd770-6520-474b-a4a2-eefd3d6bce3e"],
Cell[219960, 5873, 196, 3, 44, "Text",ExpressionUUID->"89d11009-a713-42a8-ae0e-7d7ba60d3a84"],
Cell[220159, 5878, 1505, 41, 90, "Input",ExpressionUUID->"bc7eb4c8-c6b4-4285-aa5a-e7d0caaca755"],
Cell[221667, 5921, 641, 19, 64, "Input",ExpressionUUID->"65f41ba2-c9c9-4e24-a79b-62e70bd5933a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[222345, 5945, 241, 5, 67, "Subsection",ExpressionUUID->"06860581-da56-4aea-aee3-70e6d4e4f284"],
Cell[222589, 5952, 222, 5, 44, "Text",ExpressionUUID->"76099d19-4838-4310-97b3-43d07b372029"],
Cell[222814, 5959, 2063, 54, 90, "Input",ExpressionUUID->"f1a79c07-11ef-46c9-964c-1d58b52f2919"],
Cell[224880, 6015, 1757, 51, 90, "Input",ExpressionUUID->"948d88c3-0a66-4c8a-91d3-ab5267e33e0b"],
Cell[226640, 6068, 1872, 42, 116, "Input",ExpressionUUID->"0ba11338-6f72-426c-bf1d-eff804895058"],
Cell[228515, 6112, 655, 14, 64, "Input",ExpressionUUID->"9bb7c9e6-bc4a-41f2-aecf-6fe26c876941"]
}, Closed]],
Cell[CellGroupData[{
Cell[229207, 6131, 270, 6, 46, "Subsection",ExpressionUUID->"1ede7757-ae35-463e-bd31-1ff8f72dfc91"],
Cell[229480, 6139, 772, 17, 90, "Input",ExpressionUUID->"2e2b1749-301b-47bf-af19-69a0a2af3f17"],
Cell[230255, 6158, 269, 6, 64, "Input",ExpressionUUID->"81d3a329-6d96-46db-9af0-26f617db6cc2"],
Cell[230527, 6166, 554, 15, 139, "Input",ExpressionUUID->"144ad3bd-a10c-4a58-adff-d482027be62c"],
Cell[CellGroupData[{
Cell[231106, 6185, 173, 3, 56, "Subsubsection",ExpressionUUID->"ff893d72-0187-4490-b99e-e6c815041ad0"],
Cell[231282, 6190, 959, 22, 64, "Input",ExpressionUUID->"c912519f-ff15-439a-b182-fbd6c6107aba"],
Cell[232244, 6214, 1546, 42, 116, "Input",ExpressionUUID->"35cc76a4-e51b-4cbe-a70c-60bce70c4c70"],
Cell[233793, 6258, 418, 11, 37, "Input",ExpressionUUID->"4556d91f-e6db-4aef-8708-54a17648cf7c"],
Cell[234214, 6271, 480, 12, 64, "Input",ExpressionUUID->"5e105eb2-94dc-412f-a6b1-8e7fa6d5cc79"],
Cell[234697, 6285, 3165, 78, 168, "Input",ExpressionUUID->"346a7552-1b0b-4b25-8b86-fda3e65f4dba"],
Cell[237865, 6365, 638, 14, 64, "Input",ExpressionUUID->"8b787401-bc63-4096-b6bc-b1ae54c70585"],
Cell[238506, 6381, 390, 7, 90, "Input",ExpressionUUID->"ba2f4c2f-8244-4d9e-8935-fe8f0faeeeb8"],
Cell[238899, 6390, 919, 25, 90, "Input",ExpressionUUID->"c2682267-2fa3-40d1-b3b4-7701871ac07c"],
Cell[239821, 6417, 598, 18, 37, "Input",ExpressionUUID->"159bd0af-b731-432f-af3f-7bba990888e3"],
Cell[240422, 6437, 3743, 103, 246, "Input",ExpressionUUID->"734fc895-9863-44f5-af29-f4bbef22e57e"],
Cell[244168, 6542, 297, 5, 64, "Text",ExpressionUUID->"cf354d25-31dd-4436-af10-cf35055a9f68"],
Cell[244468, 6549, 1864, 50, 116, "Input",ExpressionUUID->"e0c1a2ab-400c-48a4-8436-9d12005c28f7"],
Cell[246335, 6601, 1502, 42, 64, "Input",ExpressionUUID->"02b19725-73d9-48cf-b356-17f29f181128"],
Cell[247840, 6645, 1849, 44, 90, "Input",ExpressionUUID->"b7edd98f-7e78-4967-a4c5-400fd9ea1b12"],
Cell[249692, 6691, 712, 15, 116, "Input",ExpressionUUID->"ebc4e241-70b4-4d92-b795-557efbebf93d"],
Cell[250407, 6708, 1048, 26, 64, "Input",ExpressionUUID->"34077929-1b8c-4cf7-b5ac-83a17e1ca879"],
Cell[251458, 6736, 580, 12, 90, "Input",ExpressionUUID->"03ca9e7b-9c81-4ebe-93c3-77bc26f06225"],
Cell[252041, 6750, 186, 3, 64, "Text",ExpressionUUID->"bb0d8127-896d-4b02-aed3-a7e79e37542b"],
Cell[252230, 6755, 615, 15, 64, "Input",ExpressionUUID->"7bff04ec-4d38-47ab-b42f-23380aab8520"],
Cell[252848, 6772, 982, 23, 64, "Input",ExpressionUUID->"8b6a6dd1-d65f-4d89-8859-814427466d16"],
Cell[253833, 6797, 934, 24, 64, "Input",ExpressionUUID->"882d33dd-54ea-4c62-8a7b-a273309caff1"],
Cell[254770, 6823, 342, 8, 37, "Input",ExpressionUUID->"46f2eb91-23dc-4a3c-aed3-b4efc97019ee"],
Cell[255115, 6833, 746, 15, 90, "Input",ExpressionUUID->"a47f8f71-61fc-4b77-bb7e-e92487af2e7f"],
Cell[255864, 6850, 356, 9, 37, "Input",ExpressionUUID->"0a37809f-5836-4683-b583-d30d28dbe925"],
Cell[256223, 6861, 325, 8, 37, "Input",ExpressionUUID->"997545e5-c8ee-4c2d-83fa-e3f2945faee4"],
Cell[256551, 6871, 641, 11, 131, "Text",ExpressionUUID->"034e29e3-ef41-4f92-b6f7-c247211537b1"],
Cell[257195, 6884, 155, 3, 37, "Input",ExpressionUUID->"5ec6be1c-bc83-48a3-9957-bdf4a048d64a"],
Cell[257353, 6889, 825, 18, 37, "Input",ExpressionUUID->"5eddfc5b-9155-4a81-a49c-16ceadc24271"],
Cell[258181, 6909, 841, 21, 37, "Input",ExpressionUUID->"1bac5a65-2da4-4d5f-ac54-6dd3dc8e0378"],
Cell[259025, 6932, 478, 13, 64, "Input",ExpressionUUID->"d42837e5-fade-4045-9dd6-7c3468d79ee8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[259540, 6950, 222, 4, 56, "Subsubsection",ExpressionUUID->"34b28dc7-1161-4e63-9c89-ba6e6fd217e1"],
Cell[259765, 6956, 216, 3, 64, "Input",ExpressionUUID->"b3567c3e-4a05-47fe-9c53-d6c0a701a8cf"],
Cell[259984, 6961, 1104, 24, 64, "Input",ExpressionUUID->"7a7f7822-04ab-425c-998c-173dd85f6d70"],
Cell[261091, 6987, 1572, 43, 116, "Input",ExpressionUUID->"e52bd640-030d-415a-bcc4-0a0e09f9a172"],
Cell[262666, 7032, 418, 11, 37, "Input",ExpressionUUID->"5ed5baf7-e6ad-4db5-bff8-fba54eb722bb"],
Cell[263087, 7045, 3213, 78, 168, "Input",ExpressionUUID->"a73950a5-610b-4923-9214-7e7d22e58908"],
Cell[266303, 7125, 588, 12, 90, "Input",ExpressionUUID->"c78caa70-1521-4b63-8e33-4519f4609274"],
Cell[266894, 7139, 951, 26, 64, "Input",ExpressionUUID->"13eeddb8-4ce5-48ad-87c6-893320599124"],
Cell[267848, 7167, 1087, 30, 142, "Input",ExpressionUUID->"6ff25cc1-338f-4415-9b55-34a056486aea"],
Cell[268938, 7199, 297, 5, 64, "Text",ExpressionUUID->"6647bf51-373f-4044-84ee-64d04c39bf02"],
Cell[269238, 7206, 1961, 51, 116, "Input",ExpressionUUID->"b9177ed6-6edd-4a1a-bf55-e5aa703bf89f"],
Cell[271202, 7259, 1898, 45, 90, "Input",ExpressionUUID->"7188d7b6-b445-4505-ad8b-24528cbd0740"],
Cell[273103, 7306, 643, 12, 116, "Input",ExpressionUUID->"db53fecd-8a03-44fd-8648-39de6e087834"],
Cell[273749, 7320, 1076, 27, 64, "Input",ExpressionUUID->"927d8808-feb6-456a-a10f-ce9a3c9a891d"],
Cell[274828, 7349, 580, 12, 90, "Input",ExpressionUUID->"80285532-9ea0-4b57-99cf-e1850840351e"],
Cell[275411, 7363, 186, 3, 64, "Text",ExpressionUUID->"cf8e0122-8790-40c9-bc74-2f9484a4d204"],
Cell[275600, 7368, 639, 15, 64, "Input",ExpressionUUID->"3e58c8cb-3de4-478f-a754-0abe725acac7"],
Cell[276242, 7385, 1005, 23, 64, "Input",ExpressionUUID->"796767f5-49a7-4ebe-be02-a010dcc53630"],
Cell[277250, 7410, 690, 13, 90, "Input",ExpressionUUID->"5cacc7cc-e915-417e-9cc0-5b8eb56d5162"],
Cell[277943, 7425, 356, 9, 37, "Input",ExpressionUUID->"ad151e83-9aaf-4014-8c49-42ba3de228bb"],
Cell[278302, 7436, 325, 8, 37, "Input",ExpressionUUID->"0a727bbc-9378-4876-84d4-1f3889b20c38"],
Cell[278630, 7446, 641, 11, 131, "Text",ExpressionUUID->"da3c5765-e7d7-4d76-8c96-ccef7b9186f8"],
Cell[279274, 7459, 155, 3, 37, "Input",ExpressionUUID->"afc47944-ed5b-4d40-92f6-8ed70f7232b2"],
Cell[279432, 7464, 825, 18, 37, "Input",ExpressionUUID->"70a57235-9781-49fb-8257-eab35c1e14b7"],
Cell[280260, 7484, 841, 21, 37, "Input",ExpressionUUID->"39f779e0-b870-4909-b051-f9d5d4c29ca1"],
Cell[281104, 7507, 478, 13, 64, "Input",ExpressionUUID->"3e8ff3a5-d8b1-4b8a-8103-bc2ae42c999e"]
}, Closed]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[281643, 7527, 566, 14, 66, "Section",ExpressionUUID->"08d981c7-55c2-433b-9662-7a95f88bc061"],
Cell[282212, 7543, 694, 12, 102, "Text",ExpressionUUID->"d5eeaf90-e7fb-4621-aa8e-f27f6135cd2a"],
Cell[282909, 7557, 1302, 35, 194, "Input",ExpressionUUID->"06d12341-ef96-4712-9ebb-c85d74a1217e"],
Cell[CellGroupData[{
Cell[284236, 7596, 277, 4, 67, "Subsection",ExpressionUUID->"6675d922-d7f1-4e04-a33a-bbfb65d3cd69"],
Cell[284516, 7602, 585, 12, 37, "Input",ExpressionUUID->"92e61829-5656-4c9a-a7b7-defbb01814fe"],
Cell[285104, 7616, 361, 7, 37, "Input",ExpressionUUID->"99eaa392-cd03-4bb3-b792-50227372369b"],
Cell[285468, 7625, 1043, 31, 73, "Text",ExpressionUUID->"44e20855-5ec4-43bd-a466-659ef9d873d8"],
Cell[286514, 7658, 1776, 43, 142, "Input",ExpressionUUID->"1775654f-7698-4d54-85b0-7bd87381c8f5"],
Cell[288293, 7703, 2343, 52, 142, "Input",ExpressionUUID->"be00cfc2-1d89-48f0-b649-48b4d3380bc0"],
Cell[290639, 7757, 1639, 45, 142, "Input",ExpressionUUID->"935fb027-74eb-4d63-a42a-3765ca76e99e"],
Cell[292281, 7804, 582, 12, 116, "Input",ExpressionUUID->"33e1a055-a1a2-41bb-9e0a-73550fc1ee28"],
Cell[292866, 7818, 1879, 44, 116, "Input",ExpressionUUID->"0df3ed0b-3b40-43c5-b9bb-9384dbc5d32f"],
Cell[294748, 7864, 664, 19, 116, "Input",ExpressionUUID->"334c506d-f6ca-4207-80cd-da93882d8a5a"],
Cell[295415, 7885, 2143, 47, 142, "Input",ExpressionUUID->"f0074d22-76e9-4bfc-baa4-1a35592007f1"],
Cell[297561, 7934, 512, 9, 37, "Input",ExpressionUUID->"22eb1b90-420a-4d42-b292-b910ab39646a"],
Cell[298076, 7945, 225, 5, 44, "Text",ExpressionUUID->"d8b5ecfa-0b90-409f-8318-3331e596ce2b"],
Cell[298304, 7952, 3231, 70, 272, "Input",ExpressionUUID->"56947352-3ee5-4a89-a652-ff6e86f2f219"],
Cell[301538, 8024, 420, 8, 73, "Text",ExpressionUUID->"22e4e505-8a2d-48b9-b99f-563f5bf39e59"],
Cell[301961, 8034, 8768, 207, 1052, "Input",ExpressionUUID->"7b8c870a-c198-48ab-a3ce-ceb01ba78dfc"],
Cell[310732, 8243, 227, 5, 44, "Text",ExpressionUUID->"c4d37493-7c8e-4316-bb9f-631538fecb3e"],
Cell[310962, 8250, 1740, 39, 64, "Input",ExpressionUUID->"f98d7465-ed79-458a-b575-23a00580e29b"],
Cell[312705, 8291, 320, 9, 37, "Input",ExpressionUUID->"fcdec729-0da1-48cf-a419-cf2869b25580"],
Cell[313028, 8302, 877, 22, 64, "Input",ExpressionUUID->"997732cf-997c-4066-ac9a-4223aed9eced"],
Cell[313908, 8326, 456, 11, 90, "Input",ExpressionUUID->"5a5ea87a-4505-419c-9473-3448f41ad225"],
Cell[314367, 8339, 424, 8, 73, "Text",ExpressionUUID->"3dfb869a-e035-47d3-8cb1-0e1302d8308d"],
Cell[314794, 8349, 1016, 18, 64, "Input",ExpressionUUID->"99c5481a-dbb6-4e19-9adc-f28897e2c3a5"],
Cell[315813, 8369, 1241, 35, 116, "Input",ExpressionUUID->"20e4c719-a135-4754-8d91-de1719576bd6"],
Cell[317057, 8406, 660, 16, 37, "Input",ExpressionUUID->"11c561ed-3c91-46b2-a58f-8d0e7ee1af85"],
Cell[317720, 8424, 196, 3, 44, "Text",ExpressionUUID->"f4f5475d-82f2-42e8-91cc-a4de88636802"],
Cell[317919, 8429, 1505, 41, 90, "Input",ExpressionUUID->"71b46eca-90a2-4c34-82e9-ef705ea2c17f"],
Cell[319427, 8472, 641, 19, 64, "Input",ExpressionUUID->"c6207131-c2cc-4c92-b6ea-7cc6fb2c7451"]
}, Open  ]],
Cell[CellGroupData[{
Cell[320105, 8496, 241, 5, 67, "Subsection",ExpressionUUID->"7601981e-3bcc-450b-8b5e-558e9acec95f"],
Cell[320349, 8503, 222, 5, 44, "Text",ExpressionUUID->"252e3eb6-8575-4003-bfdc-58803c536f81"],
Cell[320574, 8510, 2063, 54, 90, "Input",ExpressionUUID->"6185d732-94ba-4779-8c81-14d7ddf5177f"],
Cell[322640, 8566, 1757, 51, 90, "Input",ExpressionUUID->"92680b13-80b0-4675-900f-51d0d8bb48d0"],
Cell[324400, 8619, 1872, 42, 116, "Input",ExpressionUUID->"f71f6f19-ab50-453c-be4f-403914bc44c6"],
Cell[326275, 8663, 655, 14, 64, "Input",ExpressionUUID->"f4474e09-4e15-4c46-b530-e29b4f2e2b86"]
}, Closed]],
Cell[CellGroupData[{
Cell[326967, 8682, 270, 6, 46, "Subsection",ExpressionUUID->"17985349-c36e-45fa-b81c-eaea354ccd70"],
Cell[327240, 8690, 772, 17, 90, "Input",ExpressionUUID->"4cec8178-08ac-40d8-afb4-8a5e36674cbf"],
Cell[328015, 8709, 269, 6, 64, "Input",ExpressionUUID->"36805b9f-eb95-4e0c-b2b9-ec095dbc1f79"],
Cell[328287, 8717, 554, 15, 139, "Input",ExpressionUUID->"3ce37320-038d-49a9-839c-324f17d82daa"],
Cell[CellGroupData[{
Cell[328866, 8736, 173, 3, 56, "Subsubsection",ExpressionUUID->"7ae801fe-8bad-4226-bad9-ac0c966dda5d"],
Cell[329042, 8741, 959, 22, 64, "Input",ExpressionUUID->"7ee311c3-6b4b-4eda-98c8-e46c6cda0086"],
Cell[330004, 8765, 1546, 42, 116, "Input",ExpressionUUID->"9299c293-da8e-425b-b28d-f906f19e0a4c"],
Cell[331553, 8809, 418, 11, 37, "Input",ExpressionUUID->"11093c38-88ca-4ddb-a59e-5ec22e81a9ae"],
Cell[331974, 8822, 480, 12, 64, "Input",ExpressionUUID->"acb33703-378f-484f-be96-df058d02538b"],
Cell[332457, 8836, 3165, 78, 168, "Input",ExpressionUUID->"167f6514-dc57-47bc-8c26-d657d5170df5"],
Cell[335625, 8916, 638, 14, 64, "Input",ExpressionUUID->"dc9466e4-9f09-4ce1-a8ae-fd68424dd7c6"],
Cell[336266, 8932, 390, 7, 90, "Input",ExpressionUUID->"b4f5a855-139e-4fbb-a95a-4f71cb15d969"],
Cell[336659, 8941, 919, 25, 90, "Input",ExpressionUUID->"5701bd90-c29c-447b-9a2b-bcdd5dd252a4"],
Cell[337581, 8968, 598, 18, 37, "Input",ExpressionUUID->"94a5096a-de84-4450-92d0-181aabf27329"],
Cell[338182, 8988, 3743, 103, 246, "Input",ExpressionUUID->"9e1c11e1-ba67-4d59-98af-4b1570fe6934"],
Cell[341928, 9093, 297, 5, 64, "Text",ExpressionUUID->"61209051-5876-4f63-b6ac-fd9ad9076438"],
Cell[342228, 9100, 1864, 50, 116, "Input",ExpressionUUID->"13cdbedd-c5ab-4046-9aa9-9c8523550978"],
Cell[344095, 9152, 1502, 42, 64, "Input",ExpressionUUID->"9812be83-5a37-49a4-b675-31acba5fa08a"],
Cell[345600, 9196, 1849, 44, 90, "Input",ExpressionUUID->"598e78aa-e05c-4c3b-b7b6-03d1d6d4e561"],
Cell[347452, 9242, 712, 15, 116, "Input",ExpressionUUID->"a666e7d9-04e8-4327-89de-72c18cf18ea9"],
Cell[348167, 9259, 1048, 26, 64, "Input",ExpressionUUID->"8007f107-334a-47ed-9663-f7aaab4cea28"],
Cell[349218, 9287, 580, 12, 90, "Input",ExpressionUUID->"9366b3aa-6463-4a00-be34-bfb37a877740"],
Cell[349801, 9301, 186, 3, 64, "Text",ExpressionUUID->"270a8732-3e41-4c08-b905-139c0891b165"],
Cell[349990, 9306, 615, 15, 64, "Input",ExpressionUUID->"99b56381-e5a0-433e-91ba-585c55fc9d7b"],
Cell[350608, 9323, 982, 23, 64, "Input",ExpressionUUID->"6da352e1-11a7-4ed2-ad83-ea7b003d1aeb"],
Cell[351593, 9348, 934, 24, 64, "Input",ExpressionUUID->"2ac7330c-eae7-4a23-96fc-1245de69ccb6"],
Cell[352530, 9374, 342, 8, 37, "Input",ExpressionUUID->"9934e28c-f69a-46b4-8138-d0ddab0ffb18"],
Cell[352875, 9384, 746, 15, 90, "Input",ExpressionUUID->"b4716068-842d-4021-845a-79788515e0e7"],
Cell[353624, 9401, 356, 9, 37, "Input",ExpressionUUID->"c57099e0-53d3-4bb4-8aba-faabebf266af"],
Cell[353983, 9412, 325, 8, 37, "Input",ExpressionUUID->"a50ac638-3532-4d3b-88c5-88ead18eb789"],
Cell[354311, 9422, 641, 11, 131, "Text",ExpressionUUID->"b902bdda-0274-42b5-8ea1-1acb7641f95c"],
Cell[354955, 9435, 155, 3, 37, "Input",ExpressionUUID->"0f199227-31d5-4a81-b44e-18e8de3c1ef9"],
Cell[355113, 9440, 825, 18, 37, "Input",ExpressionUUID->"20ce53c4-ae8c-4b7e-9ea3-2dec145b2167"],
Cell[355941, 9460, 841, 21, 37, "Input",ExpressionUUID->"b29294fb-4daa-4e5e-a0cd-74ee57ca22fa"],
Cell[356785, 9483, 478, 13, 64, "Input",ExpressionUUID->"0a5631d5-38b6-442e-b6f1-617ef4323a2f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[357300, 9501, 222, 4, 56, "Subsubsection",ExpressionUUID->"14cd162a-1100-4965-a8c3-b7f740d24a3d"],
Cell[357525, 9507, 216, 3, 64, "Input",ExpressionUUID->"3c8a3cd2-fce8-4bc1-a181-a1f0d82fb2fe"],
Cell[357744, 9512, 1104, 24, 64, "Input",ExpressionUUID->"4adc92c5-397c-434e-ae7d-b051d24a0b71"],
Cell[358851, 9538, 1572, 43, 116, "Input",ExpressionUUID->"04f30a5e-43ef-4ba1-ae73-83fc3862e26d"],
Cell[360426, 9583, 418, 11, 37, "Input",ExpressionUUID->"7ffb2721-c356-4dbb-9d66-579798b61ebc"],
Cell[360847, 9596, 3213, 78, 168, "Input",ExpressionUUID->"782b3a94-7a08-48b8-8a60-cbe7712c86ca"],
Cell[364063, 9676, 588, 12, 90, "Input",ExpressionUUID->"d63445b9-ae41-4f38-b857-7f2b7b0c0af5"],
Cell[364654, 9690, 951, 26, 64, "Input",ExpressionUUID->"7ae0aceb-323e-4c2a-b7c0-770ccd4ce8d9"],
Cell[365608, 9718, 1087, 30, 142, "Input",ExpressionUUID->"9b2028ab-aa36-491b-a29a-8447f9bd4dee"],
Cell[366698, 9750, 297, 5, 64, "Text",ExpressionUUID->"748fbd33-a5fa-481b-8c23-be5ff061c56e"],
Cell[366998, 9757, 1961, 51, 116, "Input",ExpressionUUID->"54591601-c93d-411e-a855-94f963dfbeca"],
Cell[368962, 9810, 1898, 45, 90, "Input",ExpressionUUID->"a6a0aa5f-08b1-4e04-bdde-4d996193b927"],
Cell[370863, 9857, 643, 12, 116, "Input",ExpressionUUID->"17b811f0-b72e-4a13-bfa7-e86356fd9b19"],
Cell[371509, 9871, 1076, 27, 64, "Input",ExpressionUUID->"8dfbb335-5e47-4af8-9571-a2a6a75c629c"],
Cell[372588, 9900, 580, 12, 90, "Input",ExpressionUUID->"e3674587-0af9-44a1-90be-9b478f79613b"],
Cell[373171, 9914, 186, 3, 64, "Text",ExpressionUUID->"779d77f6-a578-434b-968a-5742f4367f2a"],
Cell[373360, 9919, 639, 15, 64, "Input",ExpressionUUID->"c226a74a-6db4-4896-965b-efac485c3a5c"],
Cell[374002, 9936, 1005, 23, 64, "Input",ExpressionUUID->"1d589973-b745-4abe-b04e-43e6c3aa4189"],
Cell[375010, 9961, 690, 13, 90, "Input",ExpressionUUID->"f59f78e8-fad4-4bde-9fd5-f2a915649850"],
Cell[375703, 9976, 356, 9, 37, "Input",ExpressionUUID->"307301d3-e44b-446c-8e4d-49cdda8b5912"],
Cell[376062, 9987, 325, 8, 37, "Input",ExpressionUUID->"75642e31-a7ac-49d3-be14-5e9e45d6f971"],
Cell[376390, 9997, 641, 11, 131, "Text",ExpressionUUID->"6d1167ca-d7f7-4c44-883e-bb74c289a0b4"],
Cell[377034, 10010, 155, 3, 37, "Input",ExpressionUUID->"eeead360-fbe6-46d0-951c-7b8876bef1ec"],
Cell[377192, 10015, 825, 18, 37, "Input",ExpressionUUID->"86192fa8-519c-494e-ba9a-4adbd02af4f7"],
Cell[378020, 10035, 841, 21, 37, "Input",ExpressionUUID->"a2a9afe3-4e6f-4bdc-a0a1-f43f2f4f15ca"],
Cell[378864, 10058, 478, 13, 64, "Input",ExpressionUUID->"e10a2e10-582e-405a-bdef-de47c379569c"]
}, Closed]]
}, Open  ]]
}, Open  ]]
}
]
*)

