(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    192912,       4956]
NotebookOptionsPosition[    174074,       4727]
NotebookOutlinePosition[    174443,       4743]
CellTagsIndexPosition[    174400,       4740]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<GroupTheory`\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.785268326473967*^9, 3.785268338931836*^9}, 
   3.785269081490608*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"b6889cbf-092d-4631-b0b0-83a81301ce86"],

Cell[CellGroupData[{

Cell[TextData[{
 "Crystal field expansion for cubic group ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["O", 
    RowBox[{"h", "\[NonBreakingSpace]"}]], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "fbe749cb-2602-44ac-81da-cef2c1beca5b"]
}], "Section",
 CellChangeTimes->{{3.7866271144117737`*^9, 
  3.786627142962842*^9}},ExpressionUUID->"a9bf1534-f8b6-4fd8-961f-\
1ae775dca244"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Ohgroup", "=", 
   RowBox[{"GTInstallGroup", "[", 
    RowBox[{"Oh", ",", 
     RowBox[{"GOVerbose", "\[Rule]", "\"\<False\>\""}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.785269160622649*^9, {3.785269281480538*^9, 3.785269336414172*^9}, 
   3.786627168376821*^9},
 CellLabel->"In[4]:=",ExpressionUUID->"2470a8b0-ea07-49ea-8b21-5dd21cc2a654"],

Cell[BoxData[
 RowBox[{"vcr", "=", 
  RowBox[{"GTCrystalField", "[", 
   RowBox[{"Ohgroup", ",", "6"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.785269341649662*^9, 3.7852693624398003`*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"396db1b6-ec94-486b-a29f-b3144caca921"],

Cell[CellGroupData[{

Cell["Test some things and get familiar with the GT operators", "Subsection",
 CellChangeTimes->{{3.7866500970420427`*^9, 
  3.786650126803135*^9}},ExpressionUUID->"78f1aeb3-4212-42f4-9f21-\
c29dbe185c99"],

Cell[TextData[{
 "Test that the BST operators (Buckmaster-Smith-Thornley) correspond to the \
",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    RowBox[{"(", 
     SuperscriptBox["C", 
      RowBox[{"(", "l", ")"}]], ")"}], "m"], TraditionalForm]],ExpressionUUID->
  "54173f3f-fad3-41d5-ab88-c7fe53a5439b"],
 " operators of the more recent review of Kuzmin and Tishin (2008). \
\[LineSeparator]We compare matrix elements of the BST operators to Equations \
() in the review. "
}], "Text",
 CellChangeTimes->{{3.786627172007189*^9, 3.7866272705571413`*^9}, {
  3.7885393290198107`*^9, 
  3.7885393566524763`*^9}},ExpressionUUID->"eca34ae6-895b-4e8e-ae54-\
e257409d1a43"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"jVal", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mVal", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mValp", "=", "3"}], ";"}]}], "Input",
 CellChangeTimes->{{3.786618120685358*^9, 3.786618191197185*^9}, {
   3.786618282438496*^9, 3.786618361535932*^9}, 3.786627170997086*^9, {
   3.7866274218339643`*^9, 3.786627421999659*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"2f78e5f5-c5a5-4096-b88d-9f5604609452"],

Cell[BoxData[
 RowBox[{"GTBSTOperatorElement", "[", 
  RowBox[{"2", ",", "1", ",", "jVal", ",", "mValp", ",", "mVal"}], 
  "]"}]], "Input",
 CellChangeTimes->{
  3.786617614458799*^9, {3.7866177549344*^9, 3.786617764425037*^9}, {
   3.786618001729369*^9, 3.786618074809917*^9}, {3.786618131007825*^9, 
   3.7866181370058737`*^9}, {3.7866181674920883`*^9, 3.786618192993208*^9}, {
   3.786618235637969*^9, 3.786618239563653*^9}, {3.786618296557832*^9, 
   3.786618296619371*^9}, {3.7866183562920094`*^9, 3.786618357685767*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"12083657-6ffa-4efc-a749-b212db2ef916"],

Cell[BoxData[
 RowBox[{
  RowBox[{"1", "/", "2"}], "*", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"3", "*", 
     RowBox[{"mVal", "^", "2"}]}], "-", 
    RowBox[{"jVal", "*", 
     RowBox[{"(", 
      RowBox[{"jVal", "+", "1"}], ")"}]}]}], ")"}], "*", 
  RowBox[{"KroneckerDelta", "[", 
   RowBox[{"mVal", ",", "mValp"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.786618080303924*^9, 3.7866181162352953`*^9}, {
  3.786618207609448*^9, 3.7866182219444113`*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"18a60e99-f3ee-40fb-b8e3-34047c0c6a99"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"(", 
    RowBox[{"mVal", "+", "mValp"}], ")"}]}], "*", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"3", "/", "8"}], "*", 
     RowBox[{"(", 
      RowBox[{"jVal", "+", "mValp"}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{"jVal", "-", "mVal"}], ")"}]}], ")"}], "^", 
   RowBox[{"(", 
    RowBox[{"1", "/", "2"}], ")"}]}], "*", 
  RowBox[{"KroneckerDelta", "[", 
   RowBox[{"mValp", ",", 
    RowBox[{"mVal", "+", "1"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7866181723397512`*^9, 3.786618182180396*^9}, {
  3.786618242226227*^9, 3.786618278850041*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"383d0bba-95b6-4743-8145-f4376bc054b4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"GTBSTOperator", "[", 
   RowBox[{"0", ",", "0", ",", "4"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "MatrixForm"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GTBSTOperator", "[", 
   RowBox[{"4", ",", 
    RowBox[{"-", "4"}], ",", "4"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.786627374307395*^9, 3.786627395946248*^9}, {
  3.7866274355905867`*^9, 3.78662746836504*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"faa33a26-6d45-4bca-9019-bbba1ac77858"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"GTBSTOperator", "[", 
   RowBox[{"2", ",", "2", ",", "2"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.7885393205478897`*^9, 3.788539322555574*^9}, {
  3.788539474640334*^9, 3.788539477656055*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"abf59614-5503-48b4-9a3a-00726c900e47"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Crystal field expansion in terms of BST or Stevens operators, starting from \
the expression in terms of the Y[l,m]\
\>", "Subsection",
 CellChangeTimes->{{3.7901043634663353`*^9, 
  3.790104395340146*^9}},ExpressionUUID->"e39a8fd0-b244-4e32-b758-\
b7c5bd66e8b9"],

Cell["\<\
Let\[CloseCurlyQuote]s go from BST to Stevens operators using equations on \
page 25 of Danielsen and Lindgard paper. 
Choose J=4, m=2 for concreteness. \
\>", "Text",
 CellChangeTimes->{{3.789926188699148*^9, 3.789926241666974*^9}},
 Background->GrayLevel[
  0.85],ExpressionUUID->"1db26ad8-394b-445e-b180-af76e4a63258"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"JVal", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lVal", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mVal", "=", "2"}], ";"}]}], "Input",
 CellChangeTimes->{{3.790078810972621*^9, 3.7900788193879747`*^9}, {
  3.790078984029347*^9, 3.790078984332408*^9}, {3.790079404966804*^9, 
  3.790079405053184*^9}, {3.7968048816115217`*^9, 3.796804882234777*^9}},
 CellLabel->
  "In[698]:=",ExpressionUUID->"4851e210-e511-40e2-85bf-6c93821ac2b4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"KCoeff", "[", 
    RowBox[{"2", ",", "2"}], "]"}], "=", 
   RowBox[{
    RowBox[{"1", "/", "4"}], "*", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"15", "/", "Pi"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KCoeff", "[", 
    RowBox[{"2", ",", "0"}], "]"}], "=", 
   RowBox[{
    RowBox[{"1", "/", "4"}], "*", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"5", "/", "Pi"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KCoeff", "[", 
    RowBox[{"4", ",", "4"}], "]"}], "=", 
   RowBox[{
    RowBox[{"3", "/", "16"}], "*", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"35", "/", "Pi"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KCoeff", "[", 
    RowBox[{"4", ",", "0"}], "]"}], "=", 
   RowBox[{
    RowBox[{"1", "/", "16"}], "*", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"9", "/", "Pi"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KCoeff", "[", 
    RowBox[{"6", ",", "4"}], "]"}], "=", 
   RowBox[{
    RowBox[{"3", "/", "32"}], "*", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"91", "/", "Pi"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KCoeff", "[", 
    RowBox[{"6", ",", "0"}], "]"}], "=", 
   RowBox[{
    RowBox[{"1", "/", "32"}], "*", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"13", "/", "Pi"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.790078693400251*^9, 3.79007871265171*^9}, {
   3.790078823411934*^9, 3.790078869189183*^9}, {3.7900789755327673`*^9, 
   3.790078993228772*^9}, {3.7901035930834208`*^9, 3.790103615874633*^9}, {
   3.7901036945311403`*^9, 3.790103733147262*^9}, 
   3.796837773291008*^9},ExpressionUUID->"c721a359-c6e6-4c3d-95fc-\
086410efe36d"],

Cell["\<\
The DL transformation (5.1) on page 25 (with K[l,m] = normalizing \
coefficients in the tesseral harmonic from page DL 52) relates \
GTBSTOperator[l,m,J] to GTStevensOperator[l,m,J]:\
\>", "Text",
 CellChangeTimes->{{3.796468879212973*^9, 3.796468946838995*^9}, {
  3.7964689881296062`*^9, 
  3.796469020162962*^9}},ExpressionUUID->"85ec11e7-a484-4688-81fe-\
0810ec4d12e3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"temp1", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"mVal", "\[Equal]", "0"}], ",", 
     RowBox[{
      RowBox[{"1", "/", 
       RowBox[{"KCoeff", "[", 
        RowBox[{"lVal", ",", "mVal"}], "]"}]}], "*", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "*", "lVal"}], "+", "1"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"4", "*", "Pi"}], ")"}]}], "]"}], "*", 
      RowBox[{"GTBSTOperator", "[", 
       RowBox[{"lVal", ",", "0", ",", "JVal"}], "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"1", "/", 
       RowBox[{"KCoeff", "[", 
        RowBox[{"lVal", ",", "mVal"}], "]"}]}], "*", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "*", "lVal"}], "+", "1"}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"4", "*", "Pi"}], ")"}]}], "/", "2"}], "]"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"GTBSTOperator", "[", 
         RowBox[{"lVal", ",", 
          RowBox[{"-", "mVal"}], ",", "JVal"}], "]"}], "+", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"-", "1"}], ")"}], "^", "mVal"}], "*", 
         RowBox[{"GTBSTOperator", "[", 
          RowBox[{"lVal", ",", "mVal", ",", "JVal"}], "]"}]}]}], ")"}]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "MatrixForm"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.790078676635631*^9, 3.790078806916066*^9}, {
  3.790078874805773*^9, 3.790078879396216*^9}, {3.790078923349698*^9, 
  3.790078944996416*^9}, {3.790079008317325*^9, 3.790079066468602*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"df6a1337-8777-4083-af04-a43c1c3f9621"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GTStevensOperator", "[", 
   RowBox[{"lVal", ",", "mVal", ",", "JVal"}], "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.790078883190517*^9, 3.7900789037882032`*^9}, {
  3.7900790689257307`*^9, 3.790079103644629*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"fd74fb8c-a046-4640-8808-c34dbf028d2f"],

Cell["\<\
Stevens operators defined via BST operators in Eq.5.1 on page 25 in Danielsen \
and Lindgard and  GTStevensOperator[l,m,J] are identical. \
\>", "Text",
 CellChangeTimes->{{3.790079146562079*^9, 3.790079318221053*^9}, {
  3.796469039161775*^9, 
  3.7964690467825327`*^9}},ExpressionUUID->"45e7827b-9760-4f7f-8a0d-\
e47b74838b75"],

Cell[BoxData[{
 RowBox[{"temp1", "-", 
  RowBox[{"GTStevensOperator", "[", 
   RowBox[{"lVal", ",", "mVal", ",", "JVal"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", 
  RowBox[{
   RowBox[{"Total", "[", 
    RowBox[{
     RowBox[{"Abs", "[", "#", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "&"}]}]}], "Input",
 CellChangeTimes->{{3.790079074401162*^9, 3.790079141108595*^9}, {
  3.7900792389505253`*^9, 3.790079252140975*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"55c58caf-8e15-4b78-9d5b-e957ada6a72b"],

Cell["\<\
What about the difference operators O[l,m](s) in Danielsen and Lindgard. It \
contains I and is antisymmetric. \[LineSeparator]I am not sure I need these \
for the expansion of the crystal field Hamiltonian. Let\[CloseCurlyQuote]s \
assume for now that this is done only in terms of the c combination above (as \
it agrees with GTStevensOperator that may be correct). \
\>", "Text",
 CellChangeTimes->{{3.7900790557935534`*^9, 3.79007907356444*^9}, {
  3.790079322308949*^9, 3.790079343781026*^9}, {3.79010239583383*^9, 
  3.790102407544022*^9}, {3.790102646376623*^9, 3.7901027152807693`*^9}, {
  3.7964690560275393`*^9, 
  3.796469070218313*^9}},ExpressionUUID->"cfd8cee3-1c14-4ca9-840f-\
6067ddb0b019"],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"1", "/", 
      RowBox[{"KCoeff", "[", 
       RowBox[{"lVal", ",", "mVal"}], "]"}]}], "*", "I", "*", 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "*", "lVal"}], "+", "1"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"4", "*", "Pi"}], ")"}]}], "/", "2"}], "]"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"GTBSTOperator", "[", 
        RowBox[{"lVal", ",", 
         RowBox[{"-", "mVal"}], ",", "JVal"}], "]"}], "-", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], "^", "mVal"}], "*", 
        RowBox[{"GTBSTOperator", "[", 
         RowBox[{"lVal", ",", "mVal", ",", "JVal"}], "]"}]}]}], ")"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"%", "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.790079350381518*^9, 3.790079364717042*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"837c2359-fd69-4b0e-a80b-a5fc29e1799d"],

Cell["\<\
Compare to Stevens operators defined in Lea, Leask and Wolf paper, focusing \
on J=4 for concreteness. 
From the comparison of the spectrum, we know that O[l,m] in their paper are \
identical to GTStevensOperator[l,m,J=4]. \
\[LineSeparator]Let\[CloseCurlyQuote]s see whether we obtain the same \
expansion of the crystal field Hamiltonian with factors F[4] = 60 and F[6] = \
1260 as well as the relative factors in O[4]=O[4,0] + 5.0*O[4,4] and O[6] = \
O[6,0] - 21.0*O[6,4].\
\>", "Text",
 CellChangeTimes->{{3.790102719153681*^9, 3.79010274829648*^9}, {
   3.790102888376937*^9, 3.7901030048974543`*^9}, {3.790104436652525*^9, 
   3.7901044442204657`*^9}, {3.796461677147457*^9, 3.796461677693122*^9}, {
   3.796461844067828*^9, 3.796461849303443*^9}, 
   3.796469314245987*^9},ExpressionUUID->"590f09c2-238d-4b7e-875b-\
5eb04d45ed0f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"JVal", "=", "4"}], ";"}]], "Input",
 CellChangeTimes->{{3.790103106374609*^9, 3.790103108585248*^9}, 
   3.790104431917801*^9},ExpressionUUID->"c61dff08-a760-41c2-b529-\
f7002dec7a3c"],

Cell[TextData[{
 "Expand the crystal field for ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["O", "h"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "f632f90c-8f99-4126-89f2-3ddfbfb0ad39"],
 " in ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["Y", "lm"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "e4ff6f41-49b6-4857-b159-f5776c8a9d9c"],
 ". Then replace ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["Y", "lm"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "9bb7fca0-d5ba-46e7-b860-3e2884417c2f"],
 "by Wybourne operators ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["C", "lm"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "ebe35707-20b9-45f5-bc2f-341ef5f728f2"],
 " using that ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["Y", "lm"], "\[Rule]", 
    RowBox[{
     SqrtBox[
      FractionBox[
       RowBox[{
        RowBox[{"2", "l"}], "+", "1"}], 
       RowBox[{"4", "\[Pi]"}]]], 
     SubscriptBox["C", "lm"]}]}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "ff7025b6-07d9-4071-933e-a7656b95ad9d"],
 ". Then replace the ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["C", "lm"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "37d12fda-634e-44b7-a76f-c4b89d153c7e"],
 " by the combination of Stevens\[CloseCurlyQuote] operators given in \
Danielsen and Lindgard (DL), which includes the ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["K", "lm"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "5f8b488e-3574-435f-abc3-a84492c288f5"],
 " coefficients given on p.56 in DL. The resulting Hamiltonian is identical \
to Lea et al. To show this, one can factor out the greatest common divisor of \
all the matrix elements as shown below. "
}], "Text",
 CellChangeTimes->{{3.796461917965706*^9, 
  3.7964623403476562`*^9}},ExpressionUUID->"3073a13e-b68b-49ea-8733-\
dc7cb6706652"],

Cell[BoxData[{
 RowBox[{"vcr", "=", 
  RowBox[{
   RowBox[{"GTCrystalField", "[", 
    RowBox[{"Ohgroup", ",", "6"}], "]"}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{"vcr", "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Y", "[", 
       RowBox[{"ll_", ",", "mm_"}], "]"}], "\[Rule]", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "*", "ll"}], "+", "1"}], ")"}], "/", "4"}], "/", 
         "Pi"}], "]"}], "*", 
       RowBox[{"YY", "[", 
        RowBox[{"ll", ",", "mm"}], "]"}]}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{"temp", "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"YY", "[", 
       RowBox[{"ll_", ",", "mm_"}], "]"}], "\[Rule]", 
      RowBox[{"Y", "[", 
       RowBox[{"ll", ",", "mm"}], "]"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"vcrSt", "=", 
  RowBox[{
   RowBox[{"temp", "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"r", "\[Rule]", "1"}], ",", 
      RowBox[{
       RowBox[{"Y", "[", 
        RowBox[{"4", ",", 
         RowBox[{"-", "4"}]}], "]"}], "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"KCoeff", "[", 
          RowBox[{"4", ",", "4"}], "]"}], "*", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"8", "*", 
           RowBox[{"Pi", "/", "9"}]}], "]"}], "*", 
         RowBox[{"OSt", "[", 
          RowBox[{"4", ",", "4"}], "]"}]}], "-", 
        RowBox[{"Y", "[", 
         RowBox[{"4", ",", "4"}], "]"}]}]}], ",", 
      RowBox[{
       RowBox[{"Y", "[", 
        RowBox[{"4", ",", "0"}], "]"}], "\[Rule]", 
       RowBox[{
        RowBox[{"KCoeff", "[", 
         RowBox[{"4", ",", "0"}], "]"}], "*", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"4", "*", 
          RowBox[{"Pi", "/", "9"}]}], "]"}], "*", 
        RowBox[{"OSt", "[", 
         RowBox[{"4", ",", "0"}], "]"}]}]}], ",", 
      RowBox[{
       RowBox[{"Y", "[", 
        RowBox[{"6", ",", 
         RowBox[{"-", "4"}]}], "]"}], "\[Rule]", 
       RowBox[{
        RowBox[{
         RowBox[{"KCoeff", "[", 
          RowBox[{"6", ",", "4"}], "]"}], "*", 
         RowBox[{"Sqrt", "[", 
          RowBox[{"8", "*", 
           RowBox[{"Pi", "/", "13"}]}], "]"}], "*", 
         RowBox[{"OSt", "[", 
          RowBox[{"6", ",", "4"}], "]"}]}], "-", 
        RowBox[{"Y", "[", 
         RowBox[{"6", ",", "4"}], "]"}]}]}], ",", 
      RowBox[{
       RowBox[{"Y", "[", 
        RowBox[{"6", ",", "0"}], "]"}], "\[Rule]", 
       RowBox[{
        RowBox[{"KCoeff", "[", 
         RowBox[{"6", ",", "0"}], "]"}], "*", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"4", "*", 
          RowBox[{"Pi", "/", "13"}]}], "]"}], "*", 
        RowBox[{"OSt", "[", 
         RowBox[{"6", ",", "0"}], "]"}]}]}]}], "}"}]}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.790103006136746*^9, 3.7901030398095503`*^9}, {
  3.790103093065908*^9, 3.7901031727777987`*^9}, {3.790103240215016*^9, 
  3.790103245235113*^9}, {3.79010329720328*^9, 3.790103299290131*^9}, {
  3.790103336371759*^9, 3.7901035878671227`*^9}, {3.790110687219729*^9, 
  3.79011080028188*^9}, {3.7968048709901237`*^9, 3.7968048726470222`*^9}},
 CellLabel->
  "In[747]:=",ExpressionUUID->"a40fcd0c-cadc-476c-bb48-84905773cac6"],

Cell[BoxData[
 RowBox[{"42", "*", 
  RowBox[{"Sqrt", "[", "70", "]"}], "*", 
  RowBox[{
   RowBox[{
    RowBox[{"60", "/", "5"}], "/", 
    RowBox[{"Sqrt", "[", "182", "]"}]}], "/", "1260"}]}]], "Input",
 CellChangeTimes->{{3.7968360774504633`*^9, 3.796836143180084*^9}, 
   3.796836328000437*^9},
 CellLabel->
  "In[751]:=",ExpressionUUID->"a8110a6b-b666-429f-b2b5-f31f73e9ce9b"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"GTStevensTheta", "[", 
    RowBox[{"\"\<Pr\>\"", ",", "4"}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"GTStevensTheta", "[", 
    RowBox[{"\"\<Pr\>\"", ",", "6"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.79683639344508*^9, 3.796836442144084*^9}},
 CellLabel->
  "In[754]:=",ExpressionUUID->"a100a6a7-a295-427f-a971-7069b3cf8260"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"GTStevensTheta", "[", 
      RowBox[{"\"\<Pr\>\"", ",", "4"}], "]"}], "*", 
     RowBox[{"Sqrt", "[", 
      RowBox[{"4", "*", 
       RowBox[{"Pi", "/", "9"}]}], "]"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"KCoeff", "[", 
         RowBox[{"4", ",", "0"}], "]"}], "*", 
        RowBox[{"A", "[", 
         RowBox[{"4", ",", "4"}], "]"}], "*", 
        RowBox[{"GTStevensOperator", "[", 
         RowBox[{"4", ",", "0", ",", "JVal"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"KCoeff", "[", 
         RowBox[{"4", ",", "4"}], "]"}], "*", 
        RowBox[{"A", "[", 
         RowBox[{"4", ",", "4"}], "]"}], "*", 
        RowBox[{"GTStevensOperator", "[", 
         RowBox[{"4", ",", "4", ",", "JVal"}], "]"}]}]}], ")"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"%", "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.796836451864003*^9, 3.7968365074733353`*^9}, {
  3.796836620703352*^9, 3.796836698293068*^9}, {3.796836989544627*^9, 
  3.796836989678858*^9}, {3.796837043082181*^9, 3.796837084875671*^9}, {
  3.79683746419944*^9, 3.796837480719427*^9}, {3.7968375126629868`*^9, 
  3.796837532513829*^9}},
 CellLabel->
  "In[771]:=",ExpressionUUID->"55e8b138-4db9-4593-8e6d-0b979711a784"],

Cell["\<\
The relative numbers between OSt[4,0] and OSt[4,4] as well as between \
OSt[6,0] and OSt[6,4] are correct. The common factors F[4] and F[6] follow \
immediately from just looking at the matrices of O[4] and O[6] and dividing \
by the largest common factor of all (diagonal ) entries in the matrix. \
\>", "Text",
 CellChangeTimes->{{3.790103831018794*^9, 3.7901038785790854`*^9}, {
  3.790104093291892*^9, 3.790104138595586*^9}, {3.7901081664520617`*^9, 
  3.790108170116023*^9}, {3.796461687966905*^9, 
  3.796461688864135*^9}},ExpressionUUID->"7fde4379-68e9-460d-a95a-\
266c400787eb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{
    RowBox[{"GTStevensOperator", "[", 
     RowBox[{"4", ",", "0", ",", "JVal"}], "]"}], "+", 
    RowBox[{"5", "*", 
     RowBox[{"GTStevensOperator", "[", 
      RowBox[{"4", ",", "4", ",", "JVal"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%%", "/", "60"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.790103996480076*^9, 3.7901040744765244`*^9}, 
   3.7901041899889708`*^9, {3.790105237135083*^9, 3.790105250646049*^9}},
 CellLabel->
  "In[148]:=",ExpressionUUID->"42ed261e-dcc6-4563-8bb0-529dadeff9db"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"GTStevensOperator", "[", 
      RowBox[{"6", ",", "0", ",", "JVal"}], "]"}], "-", 
     RowBox[{"21", "*", 
      RowBox[{"GTStevensOperator", "[", 
       RowBox[{"6", ",", "4", ",", "JVal"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"%", "//", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"%%", "/", "1260"}], "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{
  3.7901040550120907`*^9, {3.790104148636875*^9, 3.790104188101099*^9}},
 CellLabel->
  "In[114]:=",ExpressionUUID->"76f27a93-c841-4aa2-af7e-ef4540034b08"],

Cell["\<\
One can find F[4] and F[6] (at least in this case) by looking at the greatest \
common divisor (GCD) of the diagonal entries of O[4] and O[6], respectively. \
\
\>", "Text",
 CellChangeTimes->{{3.790108087497567*^9, 
  3.79010812630786*^9}},ExpressionUUID->"ea2561a0-f991-427e-b849-\
efe728360e78"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{
    RowBox[{"GTStevensOperator", "[", 
     RowBox[{"4", ",", "0", ",", "JVal"}], "]"}], "+", 
    RowBox[{"5", "*", 
     RowBox[{"GTStevensOperator", "[", 
      RowBox[{"4", ",", "4", ",", "JVal"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"temp", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "temp", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"GCD", "[", 
  RowBox[{
   RowBox[{"Abs", "[", 
    RowBox[{"temp", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
   RowBox[{"Abs", "[", 
    RowBox[{"temp", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
   RowBox[{"Abs", "[", 
    RowBox[{"temp", "[", 
     RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
   RowBox[{"Abs", "[", 
    RowBox[{"temp", "[", 
     RowBox[{"[", "4", "]"}], "]"}], "]"}], ",", 
   RowBox[{"Abs", "[", 
    RowBox[{"temp", "[", 
     RowBox[{"[", "5", "]"}], "]"}], "]"}], ",", 
   RowBox[{"Abs", "[", 
    RowBox[{"temp", "[", 
     RowBox[{"[", "6", "]"}], "]"}], "]"}], ",", 
   RowBox[{"Abs", "[", 
    RowBox[{"temp", "[", 
     RowBox[{"[", "7", "]"}], "]"}], "]"}], ",", 
   RowBox[{"Abs", "[", 
    RowBox[{"temp", "[", 
     RowBox[{"[", "8", "]"}], "]"}], "]"}], ",", 
   RowBox[{"Abs", "[", 
    RowBox[{"temp", "[", 
     RowBox[{"[", "9", "]"}], "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{
    RowBox[{"GTStevensOperator", "[", 
     RowBox[{"6", ",", "0", ",", "JVal"}], "]"}], "-", 
    RowBox[{"21", "*", 
     RowBox[{"GTStevensOperator", "[", 
      RowBox[{"6", ",", "4", ",", "JVal"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"temp", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "temp", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"GCD", "[", 
  RowBox[{
   RowBox[{"Abs", "[", 
    RowBox[{"temp", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
   RowBox[{"Abs", "[", 
    RowBox[{"temp", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
   RowBox[{"Abs", "[", 
    RowBox[{"temp", "[", 
     RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
   RowBox[{"Abs", "[", 
    RowBox[{"temp", "[", 
     RowBox[{"[", "4", "]"}], "]"}], "]"}], ",", 
   RowBox[{"Abs", "[", 
    RowBox[{"temp", "[", 
     RowBox[{"[", "5", "]"}], "]"}], "]"}], ",", 
   RowBox[{"Abs", "[", 
    RowBox[{"temp", "[", 
     RowBox[{"[", "6", "]"}], "]"}], "]"}], ",", 
   RowBox[{"Abs", "[", 
    RowBox[{"temp", "[", 
     RowBox[{"[", "7", "]"}], "]"}], "]"}], ",", 
   RowBox[{"Abs", "[", 
    RowBox[{"temp", "[", 
     RowBox[{"[", "8", "]"}], "]"}], "]"}], ",", 
   RowBox[{"Abs", "[", 
    RowBox[{"temp", "[", 
     RowBox[{"[", "9", "]"}], "]"}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7901052520595903`*^9, 3.790105297614235*^9}, {
  3.7901054024716463`*^9, 3.7901054167872143`*^9}, {3.790107932293104*^9, 
  3.790107981875945*^9}, {3.790108023029406*^9, 3.79010807970979*^9}, {
  3.790108134133342*^9, 3.7901081370526133`*^9}},
 CellLabel->
  "In[190]:=",ExpressionUUID->"83dd25c2-9136-4679-9b76-e9e8a41bd96d"],

Cell["\<\
Conclusion: we can get the crystal field Hamiltonian from first expanding the \
crystal field expression in terms of Y[l,m] using GTCrystalField[Ohgroup,6]. \
Then, we replace the Y[l,m] by the GTBSTOperators[l,m,J]. If we want to work \
with Stevens\[CloseCurlyQuote] operators instead, we can use the formula in \
Danielsen and Lindgard to relate the BST operators to the Stevens\
\[CloseCurlyQuote] operators and replace the Y[l,m] combinations by the \
Stevens\[CloseCurlyQuote] operators, i.e, as done by hand above. This \
requires the use of the KCoeff[l,m] from the table on p.56 of Danielsen and \
Lindgard. \
\>", "Text",
 CellChangeTimes->{{3.790104195532783*^9, 3.790104330212212*^9}, 
   3.7901044917823*^9, {3.7964617534394703`*^9, 
   3.796461781763026*^9}},ExpressionUUID->"2fc83329-0f64-4e71-ae90-\
91a59644c6c2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"temp", "=", "vcrSt"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{"temp", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"A", "[", 
       RowBox[{"0", ",", "0"}], "]"}], "\[Rule]", "0"}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vcrStMatrix", "=", 
   RowBox[{"temp", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"OSt", "[", 
        RowBox[{"4", ",", "0"}], "]"}], "\[Rule]", 
       RowBox[{
        RowBox[{"GTStevensOperator", "[", 
         RowBox[{"4", ",", "0", ",", "JVal"}], "]"}], "/", "60"}]}], ",", 
      RowBox[{
       RowBox[{"OSt", "[", 
        RowBox[{"4", ",", "4"}], "]"}], "->", 
       RowBox[{"5", "*", 
        RowBox[{
         RowBox[{"GTStevensOperator", "[", 
          RowBox[{"4", ",", "4", ",", "JVal"}], "]"}], "/", "60"}]}]}], ",", 
      RowBox[{
       RowBox[{"OSt", "[", 
        RowBox[{"6", ",", "0"}], "]"}], "->", 
       RowBox[{
        RowBox[{"GTStevensOperator", "[", 
         RowBox[{"6", ",", "0", ",", "JVal"}], "]"}], "/", "1260"}]}], ",", 
      RowBox[{
       RowBox[{"OSt", "[", 
        RowBox[{"6", ",", "4"}], "]"}], "->", 
       RowBox[{
        RowBox[{"GTStevensOperator", "[", 
         RowBox[{"6", ",", "4", ",", "JVal"}], "]"}], "/", "1260"}]}]}], 
     "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.796805202496027*^9, 3.796805211220599*^9}, {
  3.79683502149802*^9, 3.796835114235059*^9}, {3.796835144323694*^9, 
  3.796835173090616*^9}, {3.796835215475539*^9, 3.796835216648789*^9}, {
  3.796835250485244*^9, 3.7968352608082943`*^9}, {3.796835995489966*^9, 
  3.796836011011417*^9}},
 CellLabel->
  "In[740]:=",ExpressionUUID->"dbf2346c-eb06-4307-afd7-3e13b05b7417"]
}, Closed]],

Cell[CellGroupData[{

Cell["The case of J = 4", "Subsection",
 CellChangeTimes->{{3.7866500169480457`*^9, 3.786650025241604*^9}, {
  3.786650074758523*^9, 3.786650075429597*^9}, {3.796657762506205*^9, 
  3.796657771523488*^9}},ExpressionUUID->"3bcc91e8-5c47-4d37-a073-\
123fd4eedd5c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"JVal", "=", "4"}], ";"}]], "Input",
 CellChangeTimes->{{3.786640148438908*^9, 3.7866401487685127`*^9}, {
   3.7881950585497932`*^9, 3.788195058644024*^9}, {3.788195412637435*^9, 
   3.788195413708387*^9}, {3.788195886755945*^9, 3.78819588762637*^9}, {
   3.788196025865087*^9, 3.788196026015921*^9}, {3.796901445279166*^9, 
   3.7969014466723547`*^9}, 3.796901956860958*^9},
 CellLabel->
  "In[178]:=",ExpressionUUID->"3c71171a-6771-4655-a1f1-69b4df9d23ba"],

Cell[CellGroupData[{

Cell["\<\
First, let\[CloseCurlyQuote]s use Stevens operators and compare to Lea et al. \
\>", "Subsubsection",
 CellChangeTimes->{{3.786640459298354*^9, 3.786640471350705*^9}, {
  3.786649635465784*^9, 
  3.786649643956299*^9}},ExpressionUUID->"c61ff541-c6d2-4279-9687-\
2b592c633c46"],

Cell["Explicit formula from Lea et al.", "Text",
 CellChangeTimes->{{3.78677298410373*^9, 
  3.7867729953696404`*^9}},ExpressionUUID->"483999b9-f0fa-42cb-84c8-\
b1d66236d60b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"matcrStevens", "=", 
    RowBox[{
     RowBox[{"W", "*", "x", "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"GTStevensOperator", "[", 
          RowBox[{"4", ",", "0", ",", "JVal"}], "]"}], "+", 
         RowBox[{"5", "*", 
          RowBox[{"GTStevensOperator", "[", 
           RowBox[{"4", ",", "4", ",", "JVal"}], "]"}]}]}], ")"}], "/", 
       "60"}]}], "+", 
     RowBox[{"W", "*", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"Abs", "[", "x", "]"}]}], ")"}], "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"GTStevensOperator", "[", 
          RowBox[{"6", ",", "0", ",", "JVal"}], "]"}], "-", 
         RowBox[{"21", "*", 
          RowBox[{"GTStevensOperator", "[", 
           RowBox[{"6", ",", "4", ",", "JVal"}], "]"}]}]}], ")"}], "/", 
       "1260"}]}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"For", " ", "J"}], " ", "=", " ", 
    RowBox[{"15", "/", "2"}]}], " ", "*)"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"matcrStevens", "=", 
     RowBox[{
      RowBox[{"W", "*", "x", "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"GTStevensOperator", "[", 
           RowBox[{"4", ",", "0", ",", "JVal"}], "]"}], "+", 
          RowBox[{"5", "*", 
           RowBox[{"GTStevensOperator", "[", 
            RowBox[{"4", ",", "4", ",", "JVal"}], "]"}]}]}], ")"}], "/", 
        "60"}]}], "+", 
      RowBox[{"W", "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Abs", "[", "x", "]"}]}], ")"}], "*", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"GTStevensOperator", "[", 
           RowBox[{"6", ",", "0", ",", "JVal"}], "]"}], "-", 
          RowBox[{"21", "*", 
           RowBox[{"GTStevensOperator", "[", 
            RowBox[{"6", ",", "4", ",", "JVal"}], "]"}]}]}], ")"}], "/", 
        "13860"}]}]}]}], ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.7866404720455723`*^9, 3.786640522418222*^9}, {
  3.786640622767041*^9, 3.786640735086546*^9}, {3.786648825419053*^9, 
  3.7866488542708473`*^9}, {3.796901658597774*^9, 3.796901673043357*^9}, {
  3.7969019619486017`*^9, 3.7969019775476627`*^9}},
 CellLabel->
  "In[237]:=",ExpressionUUID->"e6f4001b-631e-455f-835e-da77c27e06d3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"esysStevens", "[", 
    RowBox[{"W_", ",", "x_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Eigensystem", "[", "matcrStevens", "]"}], "//", "Simplify"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.786647194544362*^9, 3.78664719542691*^9}, {
   3.7866488585873938`*^9, 3.786648862780579*^9}, 3.796901563085807*^9},
 CellLabel->
  "In[239]:=",ExpressionUUID->"5ec537de-fa30-414a-8d24-52a99acc3e8e"],

Cell["This agrees with the plot in the paper (as expected). ", "Text",
 CellChangeTimes->{{3.786649649839725*^9, 3.7866496577204447`*^9}, {
  3.788283111972159*^9, 
  3.788283121032646*^9}},ExpressionUUID->"0965468b-f227-4876-bc28-\
aabe7b4d12ca"],

Cell[BoxData[
 RowBox[{"plotLea", "=", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"esysStevens", "[", 
      RowBox[{"1", ",", "x"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<E\>\"", ",", "\"\<\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<x\>\"", ",", "\"\<Stevens Operators\>\""}], "}"}]}], 
      "}"}]}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Red", ",", "Dashed"}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.786640755408321*^9, 3.786640756230352*^9}, {
  3.786640862546723*^9, 3.7866409022112837`*^9}, {3.7866472092426643`*^9, 
  3.786647210366919*^9}, {3.786647423901922*^9, 3.786647445562648*^9}, {
  3.7866474929162273`*^9, 3.786647494676989*^9}, {3.786649299101058*^9, 
  3.7866493108282003`*^9}, {3.786649483347983*^9, 3.786649483952326*^9}, {
  3.796660422014801*^9, 3.796660422595109*^9}},
 CellLabel->
  "In[240]:=",ExpressionUUID->"28c76200-b54d-4dd3-aa3c-fcc0ef7db570"],

Cell[BoxData[{
 RowBox[{"Max", "[", 
  RowBox[{"N", "[", 
   RowBox[{"esysStevens", "[", 
    RowBox[{"1", ",", "0"}], "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Min", "[", 
  RowBox[{"N", "[", 
   RowBox[{"esysStevens", "[", 
    RowBox[{"1", ",", "0"}], "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"widthLea", "=", 
  RowBox[{"%%", "-", "%"}]}]}], "Input",
 CellChangeTimes->{{3.796660443096046*^9, 3.796660463987938*^9}, {
  3.7966605130051003`*^9, 3.7966605155072517`*^9}, {3.7969018457917767`*^9, 
  3.796901854859009*^9}},
 CellLabel->
  "In[241]:=",ExpressionUUID->"f44afcea-a7a9-41c4-bf2e-812848adcbd4"],

Cell["\<\
Look at eigenvectors at a given value of W and x. The eigenvectors are \
independent of W and x for J=4.  \
\>", "Text",
 CellChangeTimes->{{3.7882831259560947`*^9, 3.788283146307609*^9}, {
  3.788283259210984*^9, 
  3.788283269353887*^9}},ExpressionUUID->"a517d524-78b4-4d22-934a-\
06a871ec2b72"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"WVal", "=", "1."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xVal", "=", "0.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{"Normalize", "[", 
     RowBox[{
      RowBox[{"esysStevens", "[", 
       RowBox[{"WVal", ",", "xVal"}], "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "idx"}], "]"}], "]"}], "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"idx", ",", "1", ",", 
     RowBox[{"Length", "[", 
      RowBox[{
       RowBox[{"esysStevens", "[", 
        RowBox[{"WVal", ",", "xVal"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.788195423082165*^9, 3.78819546429239*^9}, {
  3.7881955579896173`*^9, 3.7881955984205313`*^9}, {3.78819600552975*^9, 
  3.78819601868962*^9}, {3.788283154820372*^9, 3.788283257074589*^9}},
 CellLabel->
  "In[244]:=",ExpressionUUID->"e9180422-2dd7-4e31-b120-c849635d2c3f"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.788283199453341*^9, 3.7882832033951178`*^9}},
 CellLabel->
  "In[247]:=",ExpressionUUID->"09fdfc84-b9fa-4bce-8cb4-56add991d900"],

Cell["\<\
Derive the formula using group theory. As shown below: simply replacing the \
real spherical harmonics S[l,m] with the Stevens operators O[l,m] is not \
correct. Different normalization used. Needs to be investigates further if I \
want to derive the crystal field expression in terms of Stevens operators for \
general J and point group symmetry. Since I solved this problem already using \
the BST operators below (which is physically equivalent), maybe we don\
\[CloseCurlyQuote]t need that and we just use BST operators. \
\[LineSeparator]Actually, the tutorial on the Hergert website follows exactly \
the same approach. So maybe it is correct, but I still will use the BST \
approach for now. \
\>", "Text",
 CellChangeTimes->{{3.786772998484136*^9, 3.786773008911807*^9}, {
  3.788283304282577*^9, 3.7882833715437326`*^9}, {3.7882835450117693`*^9, 
  3.7882836218563757`*^9}, {3.797112175510292*^9, 
  3.797112209532413*^9}},ExpressionUUID->"acfe5f00-43c9-401f-af7d-\
b012f7c866da"],

Cell[BoxData[
 RowBox[{"vcrReal", "=", 
  RowBox[{"GTCrystalField", "[", 
   RowBox[{"Ohgroup", ",", "6", ",", " ", 
    RowBox[{"GOHarmonics", "\[Rule]", "\"\<Real\>\""}]}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.7867730110266857`*^9, {3.7867733113048067`*^9, 3.7867733165684233`*^9}, {
   3.7867734592356052`*^9, 3.786773482391965*^9}, 3.788283274314453*^9},
 CellLabel->
  "In[248]:=",ExpressionUUID->"2af1a664-9088-4a3a-91f7-442263963528"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{"vcrReal", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"ll_", ",", "mm_"}], "]"}], "\[RuleDelayed]", 
      RowBox[{"GTStevensOperator", "[", 
       RowBox[{"ll", ",", "mm", ",", "JVal"}], "]"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{"temp", "/.", 
    RowBox[{
     RowBox[{"A", "[", 
      RowBox[{"0", ",", "0"}], "]"}], "\[Rule]", "0"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matcrA4A6", "=", 
   RowBox[{"temp", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"r", "\[Rule]", "1"}], ",", 
      RowBox[{
       RowBox[{"A", "[", 
        RowBox[{"4", ",", "4"}], "]"}], "\[Rule]", "a4"}], ",", 
      RowBox[{
       RowBox[{"A", "[", 
        RowBox[{"6", ",", "4"}], "]"}], "\[Rule]", "a6"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Coefficient", "[", 
   RowBox[{"matcrA4A6", ",", "a4"}], "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}], "/", 
  RowBox[{"%", "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "5"}], "]"}], "]"}]}], "\[IndentingNewLine]"}], "Input",\

 CellChangeTimes->{{3.786773500487219*^9, 3.7867735897763453`*^9}, {
  3.786774366032731*^9, 3.7867744263152*^9}},
 CellLabel->
  "In[249]:=",ExpressionUUID->"da0b62aa-79b3-48c5-b8b6-bc29b0de1b53"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"GTStevensOperator", "[", 
      RowBox[{"4", ",", "0", ",", "JVal"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}], "/", "5"}], "/", 
   RowBox[{
    RowBox[{"GTStevensOperator", "[", 
     RowBox[{"4", ",", "4", ",", "JVal"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "5"}], "]"}], "]"}]}], "//", "FullSimplify"}]], "Input",\

 CellChangeTimes->{{3.7867744421429033`*^9, 3.786774483878867*^9}},
 CellLabel->
  "In[256]:=",ExpressionUUID->"cba7878b-ba1e-4e70-9452-5e56f6c87994"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GTStevensOperator", "[", 
    RowBox[{"4", ",", "0", ",", "JVal"}], "]"}], "+", 
   RowBox[{"GTStevensOperator", "[", 
    RowBox[{"4", ",", "4", ",", "JVal"}], "]"}]}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.78677431140208*^9, 3.786774355613225*^9}, {
  3.786774520598693*^9, 3.7867745260045424`*^9}, {3.786774557557366*^9, 
  3.786774557709092*^9}},
 CellLabel->
  "In[257]:=",ExpressionUUID->"f90de261-ec60-4e83-abe9-fab3c95790dd"],

Cell[BoxData[
 RowBox[{"Integrate", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Sin", "[", "\[Theta]", "]"}], "*", 
    RowBox[{"GTTesseralHarmonicY", "[", 
     RowBox[{"4", ",", "4", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], "*", 
    RowBox[{"Conjugate", "[", 
     RowBox[{"GTTesseralHarmonicY", "[", 
      RowBox[{"4", ",", "4", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], "]"}]}],
    ",", 
   RowBox[{"{", 
    RowBox[{"\[Theta]", ",", "0", ",", "Pi"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Phi]", ",", "0", ",", 
     RowBox[{"2", "*", "Pi"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.788547261029958*^9, 3.788547347573496*^9}, {
  3.788547386815002*^9, 3.788547428343728*^9}, {3.7885483409886417`*^9, 
  3.7885484052208843`*^9}},
 CellLabel->
  "In[258]:=",ExpressionUUID->"39092391-3ec3-45e3-9e23-dca1961ba91b"],

Cell[BoxData[
 RowBox[{"GTTesseralHarmonicY", "[", 
  RowBox[{"4", ",", "0", ",", "\[Theta]", ",", "\[Phi]"}], "]"}]], "Input",
 CellChangeTimes->{{3.788548462864356*^9, 3.7885484631588182`*^9}},
 CellLabel->
  "In[259]:=",ExpressionUUID->"ee0d5c09-e3dc-49a6-90f0-512d3412b65d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Let\[CloseCurlyQuote]s follow the tutorial on the Hergert website", \
"Subsubsection",
 CellChangeTimes->{{3.797111531295628*^9, 
  3.797111549951507*^9}},ExpressionUUID->"fb181d3d-1003-4a7d-b1bd-\
e4a844e0bedf"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "m", "]"}], "\[IndentingNewLine]", 
 RowBox[{"vcrReal", "=", 
  RowBox[{
   RowBox[{"GTCrystalField", "[", 
    RowBox[{"Ohgroup", ",", "6", ",", 
     RowBox[{"GOHarmonics", "\[Rule]", "\"\<Real\>\""}]}], "]"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"A", "[", 
      RowBox[{"l_", ",", "m_"}], "]"}], "\[Rule]", 
     RowBox[{
      RowBox[{"B", "[", 
       RowBox[{"l", ",", "m"}], "]"}], "/", 
      RowBox[{"r", "^", "l"}]}]}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%", "//.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"l_", ",", "m_"}], "]"}], ":>", 
      RowBox[{"GTStevensOperator", "[", 
       RowBox[{"l", ",", "m", ",", "JVal"}], "]"}]}], "}"}]}], "//", 
   "Normal"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{
    RowBox[{"B", "[", 
     RowBox[{"0", ",", "0"}], "]"}], "\[Rule]", "0"}]}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.797111228531823*^9, 3.7971112368932953`*^9}, {
  3.797111284544944*^9, 3.7971114537376013`*^9}},
 CellLabel->
  "In[174]:=",ExpressionUUID->"709c17e3-fe44-4ba6-bb73-aeed8dfedfb8"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.797111523288164*^9},ExpressionUUID->"f67574d1-7b9b-4d10-9fc9-\
abeace37b21e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Now let\[CloseCurlyQuote]s use BST operators based on the ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["Y", "lm"], TraditionalForm]],ExpressionUUID->
  "0936fc1a-4314-4b60-b21d-a8fcf5dc567c"],
 " expansion. "
}], "Subsubsection",
 CellChangeTimes->{{3.786627477093186*^9, 3.7866275070194397`*^9}, {
   3.786649661432042*^9, 3.7866496836520576`*^9}, 3.786650013239037*^9, {
   3.7866500442382917`*^9, 
   3.786650044977528*^9}},ExpressionUUID->"a32fda8e-ab15-48b0-80b4-\
d37b91b2f0b8"],

Cell[TextData[{
 "Let\[CloseCurlyQuote]s build the crystal field matrix for J=4 in a ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["O", "h"], TraditionalForm]],ExpressionUUID->
  "2c7f285a-167e-473f-8659-bbbc48e6429c"],
 " crystal field.\nThe coefficient A[0,0] is just a constant (on the \
diagonal) and can thus be set to zero as it corresponds to an overall shift \
of spectrum.  "
}], "Text",
 CellChangeTimes->{{3.786650046352827*^9, 3.786650052139447*^9}, {
  3.796657942634418*^9, 
  3.796657942861779*^9}},ExpressionUUID->"fdf51dde-b84b-426c-85a8-\
e1d6b5278bd7"],

Cell[BoxData["vcr"], "Input",
 CellLabel->
  "In[179]:=",ExpressionUUID->"3a7a1e1e-e1b5-43b8-8b08-0ce6e74065c5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{
    RowBox[{"vcr", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Y", "[", 
        RowBox[{"ll_", ",", "mm_"}], "]"}], "\[RuleDelayed]", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "*", "ll"}], "+", "1"}], ")"}], "/", "4"}], "/", 
          "Pi"}], "]"}], "*", 
        RowBox[{"GTBSTOperator", "[", 
         RowBox[{"ll", ",", "mm", ",", "JVal"}], "]"}]}]}], "}"}]}], "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{"temp", "/.", 
    RowBox[{
     RowBox[{"A", "[", 
      RowBox[{"0", ",", "0"}], "]"}], "\[Rule]", "0"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matcrBST", "=", 
   RowBox[{"temp", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"r", "\[Rule]", "1"}], ",", 
      RowBox[{
       RowBox[{"A", "[", 
        RowBox[{"4", ",", "4"}], "]"}], "\[Rule]", "a4"}], ",", 
      RowBox[{
       RowBox[{"A", "[", 
        RowBox[{"6", ",", "4"}], "]"}], "\[Rule]", "a6"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.786627507720357*^9, 3.78662757792964*^9}, {
   3.7866277202481613`*^9, 3.786627735412421*^9}, {3.786627788623618*^9, 
   3.786627795672579*^9}, {3.786627923395748*^9, 3.786627953386715*^9}, {
   3.786628019298029*^9, 3.786628041536735*^9}, {3.786628426059493*^9, 
   3.786628461686534*^9}, {3.786628743577692*^9, 3.786628760372045*^9}, {
   3.7866400864895163`*^9, 3.78664015233587*^9}, {3.786640825633441*^9, 
   3.786640832701601*^9}, {3.786646996634104*^9, 3.786646999540801*^9}, {
   3.7866488342181587`*^9, 3.786648840252643*^9}, {3.7866491497723207`*^9, 
   3.786649155594781*^9}, {3.786649253814671*^9, 3.7866492654485893`*^9}, {
   3.7866494124688387`*^9, 3.786649414051375*^9}, {3.786649585012562*^9, 
   3.786649586039554*^9}, {3.78664990702824*^9, 3.786649915694008*^9}, {
   3.788195070645948*^9, 3.78819508183741*^9}, {3.7901104347783127`*^9, 
   3.7901104682891407`*^9}, {3.796657789537939*^9, 3.7966578185610228`*^9}, 
   3.7966578637771597`*^9, {3.796657927196455*^9, 3.796657936733631*^9}, {
   3.796658160029942*^9, 3.7966581781722927`*^9}},
 CellLabel->
  "In[180]:=",ExpressionUUID->"bef15d7b-dc02-4239-b32a-cb9093cc7403"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{
    RowBox[{"vcr", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Y", "[", 
        RowBox[{"ll_", ",", "mm_"}], "]"}], "\[RuleDelayed]", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "*", "ll"}], "+", "1"}], ")"}], "/", "4"}], "/", 
          "Pi"}], "]"}], "*", 
        RowBox[{"GTBSTOperator", "[", 
         RowBox[{"ll", ",", "mm", ",", "JVal"}], "]"}]}]}], "}"}]}], "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{"temp", "/.", 
    RowBox[{
     RowBox[{"A", "[", 
      RowBox[{"0", ",", "0"}], "]"}], "\[Rule]", "0"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.796838611435557*^9, 3.796838630456826*^9}, {
  3.796838684287139*^9, 3.796838690557645*^9}, {3.796838754801195*^9, 
  3.7968387700946283`*^9}, {3.796838854279707*^9, 3.796838857562723*^9}, {
  3.79689508499065*^9, 3.796895093610024*^9}, {3.7968952893579817`*^9, 
  3.7968952973118887`*^9}, {3.796899679231073*^9, 3.79689969577453*^9}},
 CellLabel->
  "In[185]:=",ExpressionUUID->"f4f8bb26-429e-4542-ad5b-3e9b5b8083e9"],

Cell[BoxData[{"$BaseDirectory", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<datasets\>\""}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GTCFDatabaseInfo", "[", "\"\<CF_Database\>\"", "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.796839084569809*^9, 3.796839085807219*^9}, {
  3.796899691334785*^9, 
  3.7968996916488037`*^9}},ExpressionUUID->"442690f6-2454-4601-9495-\
97a7aeef30b0"],

Cell["\<\
Let\[CloseCurlyQuote]s find the eigenspectrum and eigenvectors as a function \
of a4 and a6. Obviously, only their ratio should matter. For this, we find \
the common factor of the matrices multiplying a4 and a6 and pulling that out. \
Unfortunately, there is no common factor in the matrices multiplying the a4 \
and a6 coefficients respectively unfortunately. \
\>", "Text",
 CellChangeTimes->{{3.7966580581170273`*^9, 3.796658116973431*^9}, {
  3.796659666188403*^9, 
  3.7966596956039553`*^9}},ExpressionUUID->"55867764-e697-4a4d-9465-\
08dd15478763"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"matA4", "=", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"matcrBST", ",", "a4"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matA6", "=", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"matcrBST", ",", "a6"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"a4", "*", "matA4"}], "+", 
    RowBox[{"a6", "*", "matA6"}], "-", "matcrBST"}], "//", "FullSimplify"}], 
  ";"}]}], "Input",
 CellChangeTimes->{
  3.796658119511499*^9, {3.79665817602528*^9, 3.796658216521126*^9}, {
   3.796658250575593*^9, 3.7966583079603167`*^9}},
 CellLabel->
  "In[188]:=",ExpressionUUID->"8784ba65-d682-46d8-b4f1-85a9534332e4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"temp", "=", "matA4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{"Abs", "[", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"Flatten", "[", "temp", "]"}], ",", 
      RowBox[{
       RowBox[{"#", "\[NotEqual]", "0"}], "&"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Length", "[", "temp", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GCD", "[", 
    RowBox[{
     RowBox[{"temp", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "4", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "5", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "6", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "7", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "8", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "9", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "10", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "11", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "12", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "13", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "14", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "15", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "16", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "17", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "18", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "19", "]"}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
  
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"temp", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"temp", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "temp", "]"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"GCD", "[", 
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"temp", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
      RowBox[{"Abs", "[", 
       RowBox[{"temp", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
      RowBox[{"Abs", "[", 
       RowBox[{"temp", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
      RowBox[{"Abs", "[", 
       RowBox[{"temp", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "]"}], ",", 
      RowBox[{"Abs", "[", 
       RowBox[{"temp", "[", 
        RowBox[{"[", "5", "]"}], "]"}], "]"}], ",", 
      RowBox[{"Abs", "[", 
       RowBox[{"temp", "[", 
        RowBox[{"[", "6", "]"}], "]"}], "]"}], ",", 
      RowBox[{"Abs", "[", 
       RowBox[{"temp", "[", 
        RowBox[{"[", "7", "]"}], "]"}], "]"}], ",", 
      RowBox[{"Abs", "[", 
       RowBox[{"temp", "[", 
        RowBox[{"[", "8", "]"}], "]"}], "]"}], ",", 
      RowBox[{"Abs", "[", 
       RowBox[{"temp", "[", 
        RowBox[{"[", "9", "]"}], "]"}], "]"}]}], "]"}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Min", "[", "temp", "]"}], "//", "N"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Max", "[", "temp", "]"}], "//", "N"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matA4Av", "=", 
   RowBox[{
    RowBox[{"Norm", "[", 
     RowBox[{"Eigenvalues", "[", "matA4", "]"}], "]"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", "*", "JVal"}], "+", "1"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"temp", "=", 
     RowBox[{"Flatten", "[", "matA4", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"matA4Av", "=", 
     RowBox[{
      RowBox[{"Norm", "[", "temp", "]"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", "*", "JVal"}], "+", "1"}], ")"}]}]}], ";"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.7966583111783867`*^9, 3.7966583147590723`*^9}, 
   3.796658356374555*^9, {3.796658433420876*^9, 3.7966584633918657`*^9}, {
   3.796658496436825*^9, 3.796658532089654*^9}, {3.796659172254266*^9, 
   3.796659339374614*^9}, {3.796659474082996*^9, 3.7966595613539248`*^9}, {
   3.796659600789694*^9, 3.796659662278084*^9}, {3.796659906477929*^9, 
   3.796659961441085*^9}, {3.7966600937494097`*^9, 3.796660134489295*^9}, {
   3.796660720624673*^9, 3.7966607296844482`*^9}, {3.796896789760777*^9, 
   3.7968968102344*^9}, {3.7968969371331*^9, 3.796896954700213*^9}, {
   3.79689925287754*^9, 3.79689927695789*^9}},
 CellLabel->
  "In[191]:=",ExpressionUUID->"5e780ecb-51a7-4f56-87bd-96b0cefe1520"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"temp", "=", "matA6"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{"Abs", "[", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"Flatten", "[", "temp", "]"}], ",", 
      RowBox[{
       RowBox[{"#", "\[NotEqual]", "0"}], "&"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Length", "[", "temp", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GCD", "[", 
    RowBox[{
     RowBox[{"temp", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "3", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "4", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "5", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "6", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "7", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "8", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "9", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "10", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "11", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "12", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "13", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "14", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "15", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "16", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "17", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "18", "]"}], "]"}], ",", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "19", "]"}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
  
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"temp", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"temp", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "i"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "temp", "]"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"GCD", "[", 
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{"temp", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
      RowBox[{"Abs", "[", 
       RowBox[{"temp", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
      RowBox[{"Abs", "[", 
       RowBox[{"temp", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
      RowBox[{"Abs", "[", 
       RowBox[{"temp", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "]"}], ",", 
      RowBox[{"Abs", "[", 
       RowBox[{"temp", "[", 
        RowBox[{"[", "5", "]"}], "]"}], "]"}], ",", 
      RowBox[{"Abs", "[", 
       RowBox[{"temp", "[", 
        RowBox[{"[", "6", "]"}], "]"}], "]"}], ",", 
      RowBox[{"Abs", "[", 
       RowBox[{"temp", "[", 
        RowBox[{"[", "7", "]"}], "]"}], "]"}], ",", 
      RowBox[{"Abs", "[", 
       RowBox[{"temp", "[", 
        RowBox[{"[", "8", "]"}], "]"}], "]"}], ",", 
      RowBox[{"Abs", "[", 
       RowBox[{"temp", "[", 
        RowBox[{"[", "9", "]"}], "]"}], "]"}]}], "]"}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"temp", "//", "N"}], "//", "MatrixForm"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Min", "[", "temp", "]"}], "//", "N"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Max", "[", "temp", "]"}], "//", "N"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matA6Av", "=", 
   RowBox[{
    RowBox[{"Norm", "[", 
     RowBox[{"Eigenvalues", "[", "matA6", "]"}], "]"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", "*", "JVal"}], "+", "1"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"temp", "=", 
     RowBox[{"Flatten", "[", "matA6", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Norm", "[", "temp", "]"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", "*", "JVal"}], "+", "1"}], ")"}]}]}], "*)"}]}]}], "Input",\

 CellChangeTimes->{
  3.7966593897001457`*^9, 3.796659894072124*^9, {3.7966599682100487`*^9, 
   3.7966599752322206`*^9}, {3.796660070554433*^9, 3.796660117710869*^9}, {
   3.796660191094643*^9, 3.796660192674307*^9}, {3.796896963107583*^9, 
   3.796896982739888*^9}, {3.796899212353177*^9, 3.7968992441861963`*^9}, 
   3.796899725089169*^9},
 CellLabel->
  "In[198]:=",ExpressionUUID->"35513c7d-c419-414e-a241-f6949af47912"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ham", "[", "x_", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"x", "*", 
      RowBox[{"matA4", "/", "matA4Av"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Abs", "[", "x", "]"}], "-", "1"}], ")"}], "*", 
      RowBox[{"matA6", "/", "matA6Av"}]}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"energies", "[", "x_", "]"}], ":=", 
   RowBox[{"Sort", "[", 
    RowBox[{"Eigenvalues", "[", 
     RowBox[{"ham", "[", "x", "]"}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.7966583263578873`*^9, {3.796660148329115*^9, 3.796660226315435*^9}, {
   3.79666074479909*^9, 3.796660745715601*^9}, {3.796661377716734*^9, 
   3.796661382701233*^9}, {3.79666142451544*^9, 3.796661432398801*^9}, {
   3.796662295430895*^9, 3.796662300213688*^9}, {3.796751985414648*^9, 
   3.796752008164106*^9}, 3.796901486293532*^9, {3.796924391561306*^9, 
   3.7969243940726213`*^9}},
 CellLabel->
  "In[315]:=",ExpressionUUID->"86f66e92-9726-4a72-99c3-a402a13ed8a5"],

Cell[BoxData[
 RowBox[{"plot1", "=", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"energies", "[", "x", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<E/W\>\"", ",", "\"\<\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<x\>\"", ",", "\"\<\>\""}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"Directive", "[", "Blue", "]"}]}], ",", " ", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"Thickness", "[", "0.0025", "]"}], ",", 
       RowBox[{"FontSize", "\[Rule]", "14"}], ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.796660288131609*^9, 3.796660308531536*^9}, {
  3.796660375760756*^9, 3.796660383352623*^9}, {3.7967502105470667`*^9, 
  3.7967502377208014`*^9}, {3.796750381125403*^9, 3.796750426440358*^9}, {
  3.7967504619482527`*^9, 3.7967505605332336`*^9}, {3.7967506415632267`*^9, 
  3.796750642344624*^9}, {3.796901500735393*^9, 3.796901502349043*^9}, {
  3.796923661767095*^9, 3.7969236636434717`*^9}},
 CellLabel->
  "In[317]:=",ExpressionUUID->"d91792ff-d688-44c2-b21c-ea2fb13d9511"],

Cell[BoxData[{
 RowBox[{"SetDirectory", "[", 
  RowBox[{
   RowBox[{"NotebookDirectory", "[", "]"}], "~~", 
   "\"\<../Notes_Peter/Graphics\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{"\"\<Energies-J_15_2-B_0-BST.pdf\>\"", ",", "plot1"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.7967506433982887`*^9, 3.796750678166649*^9}, {
  3.796750936904496*^9, 3.7967509436905603`*^9}, {3.796897118260778*^9, 
  3.7968971231063147`*^9}, {3.79690187254598*^9, 3.796901886571361*^9}},
 CellLabel->
  "In[318]:=",ExpressionUUID->"5216f837-c289-4f89-a021-23ed05120aa1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"widthBST", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Max", "[", 
      RowBox[{"energies", "[", "0", "]"}], "]"}], "-", 
     RowBox[{"Min", "[", 
      RowBox[{"energies", "[", "0", "]"}], "]"}]}], "//", "N"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp1", "=", 
   RowBox[{
    RowBox[{"Sort", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"energies", "[", 
         RowBox[{"-", "1"}], "]"}]}], "/", "widthBST"}], "*", "widthLea"}], 
     "]"}], "//", "N"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp2", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{
     RowBox[{"N", "[", 
      RowBox[{"esysStevens", "[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"evalRatioAt1", "=", 
    RowBox[{
     RowBox[{"temp1", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "/", 
     RowBox[{"temp2", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ham2", "[", "x_", "]"}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"x", "*", 
      RowBox[{
       RowBox[{"matA4", "/", "matA4Av"}], "/", "evalRatioAt1"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"Abs", "[", "x", "]"}]}], ")"}], "*", 
      RowBox[{"matA6", "/", "matA6Av"}]}]}], "//", "FullSimplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"energies2", "[", "x_", "]"}], ":=", 
   RowBox[{"Sort", "[", 
    RowBox[{"Eigenvalues", "[", 
     RowBox[{"-", 
      RowBox[{"ham2", "[", 
       RowBox[{"-", "x"}], "]"}]}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.796660471962714*^9, 3.796660506864067*^9}, {
   3.7966606671327887`*^9, 3.7966606934542933`*^9}, {3.796660829154085*^9, 
   3.7966608315233994`*^9}, {3.796660938333695*^9, 3.796660946605171*^9}, {
   3.796660985651045*^9, 3.796661029512504*^9}, {3.796661078491111*^9, 
   3.796661102642625*^9}, {3.7966612907778997`*^9, 3.796661334239572*^9}, {
   3.796661393581348*^9, 3.79666143612462*^9}, {3.796662140142885*^9, 
   3.7966621737764072`*^9}, 3.796897010251647*^9, {3.79689718446889*^9, 
   3.796897186162202*^9}, {3.796899304529277*^9, 3.796899307152666*^9}, {
   3.7969019010087214`*^9, 3.796901905916005*^9}, {3.796923722614828*^9, 
   3.796923726956203*^9}},
 CellLabel->
  "In[269]:=",ExpressionUUID->"02b5ccab-d826-4c25-9715-799b4950e905"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"temp1", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "/", 
   RowBox[{"temp1", "[", 
    RowBox[{"[", "4", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"temp2", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "/", 
    RowBox[{"temp2", "[", 
     RowBox[{"[", "4", "]"}], "]"}]}], "//", "N"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"temp1", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "/", 
   RowBox[{"temp1", "[", 
    RowBox[{"[", "6", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"temp2", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "/", 
    RowBox[{"temp2", "[", 
     RowBox[{"[", "6", "]"}], "]"}]}], "//", "N"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"temp1", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "/", 
   RowBox[{"temp1", "[", 
    RowBox[{"[", "9", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"temp2", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "/", 
    RowBox[{"temp2", "[", 
     RowBox[{"[", "9", "]"}], "]"}]}], "//", "N"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"temp1", "[", 
    RowBox[{"[", "4", "]"}], "]"}], "/", 
   RowBox[{"temp1", "[", 
    RowBox[{"[", "6", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"temp2", "[", 
     RowBox[{"[", "4", "]"}], "]"}], "/", 
    RowBox[{"temp2", "[", 
     RowBox[{"[", "6", "]"}], "]"}]}], "//", "N"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"temp1", "[", 
    RowBox[{"[", "4", "]"}], "]"}], "/", 
   RowBox[{"temp1", "[", 
    RowBox[{"[", "9", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"temp2", "[", 
     RowBox[{"[", "4", "]"}], "]"}], "/", 
    RowBox[{"temp2", "[", 
     RowBox[{"[", "9", "]"}], "]"}]}], "//", "N"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"temp1", "[", 
    RowBox[{"[", "6", "]"}], "]"}], "/", 
   RowBox[{"temp1", "[", 
    RowBox[{"[", "9", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"temp2", "[", 
     RowBox[{"[", "6", "]"}], "]"}], "/", 
    RowBox[{"temp2", "[", 
     RowBox[{"[", "9", "]"}], "]"}]}], "//", "N"}], ";"}]}], "Input",
 CellChangeTimes->{{3.796661033882621*^9, 3.796661066723879*^9}, {
  3.796661115095394*^9, 3.796661205649329*^9}, {3.796897213520438*^9, 
  3.7968972423628902`*^9}},
 CellLabel->
  "In[218]:=",ExpressionUUID->"ddb1dedc-3ddc-4f84-b582-165c1049b110"],

Cell["\<\
We find that BST and Lea et al. spectra are identical, if we choose the same \
rescaling of A4 and A6 terms. This can be done by looking at the eigenvalues \
at x=0, where only A4 contributes, and x=1, where only A6 contributes. \
\>", "Text",
 CellChangeTimes->{{3.7966625674241447`*^9, 3.79666268137527*^9}, 
   3.796663741487897*^9, {3.796923676172271*^9, 
   3.796923676766264*^9}},ExpressionUUID->"09ca0625-0482-49ae-9f85-\
e9b4b1a99bcc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"energies1", "[", "x_", "]"}], ":=", 
   RowBox[{"Sort", "[", 
    RowBox[{"Eigenvalues", "[", 
     RowBox[{"-", 
      RowBox[{"ham", "[", 
       RowBox[{"-", "x"}], "]"}]}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{3.796752016467967*^9},
 CellLabel->
  "In[280]:=",ExpressionUUID->"0ab12f6b-1528-4eb2-84a3-2594faae88c4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"plotBSTScaled", "=", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"energies1", "[", "x", "]"}], ")"}], "/", "widthBST"}], "*", 
      "widthLea"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<E\>\"", ",", "\"\<\>\""}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<x\>\"", ",", "\"\<BST (scaled) and Lea energies\>\""}], 
         "}"}]}], "}"}]}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"Directive", "[", "Blue", "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotBSTScaled2", "=", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"energies2", "[", "x", "]"}], ")"}], "/", "widthBST"}], "*", 
      "widthLea"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<E\>\"", ",", "\"\<\>\""}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\"\<x\>\"", ",", "\"\<BST scaled\>\""}], "}"}]}], "}"}]}], 
     ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Green", ",", "DotDashed"}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"plot", "=", 
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"plotBSTScaled", ",", "plotBSTScaled2", ",", "plotLea"}], "}"}], 
    ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<E/W\>\"", ",", "\"\<\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<x\>\"", ",", "\"\<\>\""}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"Directive", "[", "Blue", "]"}]}], ",", " ", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"Thickness", "[", "0.0025", "]"}], ",", 
       RowBox[{"FontSize", "\[Rule]", "14"}], ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}]}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.7966605267764387`*^9, 3.796660600858708*^9}, {
  3.7966621779726543`*^9, 3.79666221686056*^9}, {3.796663693731529*^9, 
  3.796663726197976*^9}, {3.79675192320008*^9, 3.796751944022232*^9}, {
  3.796751990702016*^9, 3.796752048099668*^9}, {3.796752275032593*^9, 
  3.79675227526963*^9}, {3.79689719132966*^9, 3.7968971934830837`*^9}},
 CellLabel->
  "In[281]:=",ExpressionUUID->"242a30e4-11a6-4cf0-b301-75b21155017f"],

Cell[BoxData[{
 RowBox[{"SetDirectory", "[", 
  RowBox[{
   RowBox[{"NotebookDirectory", "[", "]"}], "~~", 
   "\"\<../Notes_Peter/Graphics\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
  "\"\<Energies-J_15_2-B_0-BST_Stevens_Rescaled.pdf\>\"", ",", "plot"}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.7966635919521217`*^9, {3.796752043079856*^9, 3.796752056993846*^9}, 
   3.7968972051598*^9, {3.796901945918487*^9, 3.796901948066246*^9}},
 CellLabel->
  "In[169]:=",ExpressionUUID->"a7ef5b45-b265-46b8-9b5f-0fd58b55199a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Show that BST and Stevens matrices are identical", "Subsubsection",
 CellChangeTimes->{{3.796657973115952*^9, 
  3.796657989551713*^9}},ExpressionUUID->"32864a20-a379-4b59-aaa3-\
613288c98379"],

Cell["\<\
Show that the Stevens and BST matrices are identical. Take two elements (1,1) \
and (5,1) of the two Hamiltonians H[W,x] and H[a4,a6] and solve for a4[W,x] \
and a6[W,x].\
\>", "Text",
 CellChangeTimes->{{3.7866496976255198`*^9, 3.786649715736692*^9}, {
  3.788283473503435*^9, 
  3.7882835082481833`*^9}},ExpressionUUID->"ae086a8b-b81f-40f0-a613-\
69ae6de3af84"],

Cell[BoxData[{
 RowBox[{"eqs", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"matcrA4A6", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], "==", 
     RowBox[{"matcrStevens", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
    RowBox[{
     RowBox[{"matcrA4A6", "[", 
      RowBox[{"[", 
       RowBox[{"5", ",", "1"}], "]"}], "]"}], "\[Equal]", 
     RowBox[{"matcrStevens", "[", 
      RowBox[{"[", 
       RowBox[{"5", ",", "1"}], "]"}], "]"}]}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"sol", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{"eqs", ",", 
     RowBox[{"{", 
      RowBox[{"a4", ",", "a6"}], "}"}]}], "]"}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matcr", "=", 
   RowBox[{
    RowBox[{"matcrA4A6", "/.", 
     RowBox[{"sol", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "//", "FullSimplify"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.786649718546517*^9, 3.78664977048533*^9}, {
  3.786649891775519*^9, 3.786649926315939*^9}},
 CellLabel->
  "In[255]:=",ExpressionUUID->"f903e549-e6d5-4adb-b603-16d8f5b327e5"],

Cell["\<\
Indeed, the two matrices \[OpenCurlyDoubleQuote]matcr\[CloseCurlyDoubleQuote] \
(using BST operators) and \[OpenCurlyDoubleQuote]matcrStevens\
\[CloseCurlyDoubleQuote] (using Stevens operators) are identical if we use \
the correct parametrization of W and x. \
\>", "Text",
 CellChangeTimes->{{3.786649812345018*^9, 
  3.7866498564943323`*^9}},ExpressionUUID->"f2ded8f6-52cf-4733-b25a-\
2c93f56ae18f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"matcr", "-", "matcrStevens"}], "//", "FullSimplify"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.786649866709489*^9, 3.7866498719381657`*^9}},
 CellLabel->
  "In[258]:=",ExpressionUUID->"84a6fea8-79e4-479c-a690-843c6422308c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"esys", "[", 
    RowBox[{"W_", ",", "x_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Eigensystem", "[", "matcr", "]"}], "//", "FullSimplify"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.786628099446479*^9, 3.7866281556497097`*^9}, {
  3.786628481648408*^9, 3.78662848317231*^9}, {3.786628531127221*^9, 
  3.786628531536119*^9}, {3.7866287807739077`*^9, 3.786628781174721*^9}, {
  3.78664884513208*^9, 3.786648846317134*^9}},
 CellLabel->
  "In[259]:=",ExpressionUUID->"ec512b74-b1de-4423-97e0-a8a7b8b3795f"],

Cell[BoxData[
 RowBox[{"Plot3D", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"esys", "[", 
     RowBox[{"W", ",", "x"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"W", ",", 
     RowBox[{"-", "5"}], ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.786628157120571*^9, 3.786628198427907*^9}, {
  3.786628286343534*^9, 3.786628299525857*^9}, {3.786628626235262*^9, 
  3.786628634436903*^9}, {3.786628711268499*^9, 3.786628711357843*^9}, {
  3.786628775930031*^9, 3.7866287907765493`*^9}},
 CellLabel->
  "In[260]:=",ExpressionUUID->"06db0f84-c1da-4013-849f-54ba42c0f41a"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.7964885306422567`*^9},ExpressionUUID->"eb1c0d09-4942-4a44-b04c-\
543fe8161f3e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"plot1", "=", 
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"esys", "[", 
       RowBox[{"1", ",", "x"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.786628347477253*^9, 3.786628390784327*^9}, {
   3.786628487232131*^9, 3.78662848850653*^9}, {3.786628585147829*^9, 
   3.7866285878555593`*^9}, {3.78662886341044*^9, 3.786628881306322*^9}, {
   3.7866289118636303`*^9, 3.786628912269525*^9}, {3.7866290571903353`*^9, 
   3.786629093980764*^9}, {3.78662914516424*^9, 3.786629159182889*^9}, {
   3.786629205334876*^9, 3.7866292200363092`*^9}, 3.786640187655031*^9, {
   3.7866402190156307`*^9, 3.786640221311346*^9}, {3.7866403128427877`*^9, 
   3.786640321276907*^9}, {3.786647141891985*^9, 3.786647163596879*^9}, {
   3.786647322448441*^9, 3.786647324902676*^9}, {3.7866473618363*^9, 
   3.78664736431413*^9}, {3.786647510766984*^9, 3.7866475125374947`*^9}, {
   3.7866492877685213`*^9, 3.786649289021378*^9}, 3.786649935632615*^9},
 CellLabel->
  "In[261]:=",ExpressionUUID->"ee882c64-9da0-4ca2-a7af-6ada4bc7eae2"],

Cell["\<\
The energy spectrum of the Hamiltonians (obviously) derived using BST and \
Stevens operators agree after proper rescaling of a4 and a6 coefficients, as \
they are identical. 
\
\>", "Text",
 CellChangeTimes->{{3.790110550094643*^9, 
  3.790110597585189*^9}},ExpressionUUID->"44223311-3a23-4bdf-bec0-\
45b787cb3ad4"],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"{", 
   RowBox[{"plot1", ",", "plot2"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.786649316443194*^9, 3.786649321885936*^9}, 
   3.7866494889767923`*^9, {3.7901105156099777`*^9, 3.7901105444970713`*^9}},
 CellLabel->
  "In[265]:=",ExpressionUUID->"3d724e9d-5d01-467c-9b47-4558963b8f05"],

Cell["For J=4, the eigenvectors are independent of W and x.", "Text",
 CellChangeTimes->{{3.786649939910677*^9, 
  3.7866499732943707`*^9}},ExpressionUUID->"46ad4d26-d9cd-497b-b08c-\
13229acf8029"],

Cell[BoxData[
 RowBox[{
  RowBox[{"esys", "[", 
   RowBox[{"1", ",", "0.5"}], "]"}], "[", 
  RowBox[{"[", "2", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.786649508737336*^9, 3.786649552139881*^9}},
 CellLabel->
  "In[387]:=",ExpressionUUID->"6c78a36d-489d-433a-82f3-1e4d92faf908"],

Cell["\<\
It is not so easy to take out common factors that are multiplied by a4 and a6 \
to make them both have the same range. However, one can easily find the \
minimum and the maximum entries and divide by a number in between the two (or \
by the min or max to scale the spectrum). \
\>", "Text",
 CellChangeTimes->{{3.7901046417725277`*^9, 3.7901046774448633`*^9}, {
  3.790108469310094*^9, 
  3.790108519804667*^9}},ExpressionUUID->"8d847b42-d0a4-4881-a4fe-\
46d3aa345b27"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"Coefficient", "[", 
       RowBox[{"matcrA4A6", ",", "a4"}], "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"#", "\[NotEqual]", "0"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Min", "[", 
  RowBox[{"Abs", "[", "temp", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Max", "[", 
  RowBox[{"Abs", "[", "temp", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"Coefficient", "[", 
       RowBox[{"matcrA4A6", ",", "a6"}], "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"#", "\[NotEqual]", "0"}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Min", "[", 
  RowBox[{"Abs", "[", "temp", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Max", "[", 
  RowBox[{"Abs", "[", "temp", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.790104683216284*^9, 3.7901048144051943`*^9}, {
   3.790104864829569*^9, 3.790105019805702*^9}, {3.790105107007256*^9, 
   3.7901051393099213`*^9}, {3.7901051895912933`*^9, 3.790105197269681*^9}, {
   3.79010830087741*^9, 3.790108302180215*^9}, {3.790108343669958*^9, 
   3.790108416780604*^9}, 
   3.7901086622384157`*^9},ExpressionUUID->"241418ca-1882-4cf6-a702-\
683e3d005bc3"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Training data: ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["O", "h"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "1a7bd422-f04c-463d-b473-e1e35c916a1a"],
 " symmetry"
}], "Section",
 CellChangeTimes->{{3.7969237703461857`*^9, 3.796923781980577*^9}, {
  3.7969259622094307`*^9, 
  3.796925976376203*^9}},ExpressionUUID->"86f40345-9a84-4b0c-b55a-\
eed63958a67a"],

Cell["\<\
There are two crystal field parameters {A[4,4], A[6,4]} = {W, x}, where -1 <= \
x <= 1. Here, W sets the band width of the crystal field spectrum (band width \
= approx. W/10) and x depends on the ratio of A[4,4] and A[6,4]. We thus draw \
two random numbers to set W and x. We express energies in Kelvin and thus \
draw W in the range 10 K - 300 K. This is a rough range of crystal field \
energies. \
\>", "Text",
 CellChangeTimes->{{3.796925985532331*^9, 3.796926119622555*^9}, {
  3.796926197131414*^9, 3.796926197190735*^9}, {3.796926606571512*^9, 
  3.79692660936616*^9}, {3.796932542201441*^9, 
  3.796932561977922*^9}},ExpressionUUID->"30f55759-10c3-4a8b-8e65-\
30e4b02f008c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"WMinVal", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WMaxVal", "=", "30"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"WVal", "=", 
  RowBox[{"RandomReal", "[", 
   RowBox[{"{", 
    RowBox[{"WMinVal", ",", "WMaxVal"}], "}"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"xVal", "=", 
  RowBox[{"RandomReal", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.7969265851578493`*^9, 3.796926651622409*^9}, {
  3.7969324850696917`*^9, 3.7969324856586533`*^9}, {3.796932566024177*^9, 
  3.796932574198258*^9}, {3.797410905134459*^9, 3.797410905933223*^9}},
 CellLabel->
  "In[117]:=",ExpressionUUID->"b67349fc-ade4-4baf-8b8f-762bd88f85ac"],

Cell[CellGroupData[{

Cell["Crystal field Hamiltonian ", "Subsection",
 CellChangeTimes->{{3.796923783849966*^9, 3.796923797869154*^9}, {
  3.7969239115297403`*^9, 3.7969239219126368`*^9}, {3.7969259726549997`*^9, 
  3.7969259796325693`*^9}},ExpressionUUID->"24eb721b-e39b-41e3-aab5-\
a754030f7e28"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Ohgroup", "=", 
   RowBox[{"GTInstallGroup", "[", 
    RowBox[{"Oh", ",", 
     RowBox[{"GOVerbose", "\[Rule]", "\"\<False\>\""}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.785269160622649*^9, {3.785269281480538*^9, 3.785269336414172*^9}, 
   3.786627168376821*^9, {3.796923821876587*^9, 3.796923822481081*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"2e57baf6-f970-4ad0-8f71-d868068ab8a3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"vcr", "=", 
   RowBox[{"GTCrystalField", "[", 
    RowBox[{"Ohgroup", ",", "6"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.785269341649662*^9, 3.7852693624398003`*^9}, 
   3.796923935630218*^9},
 CellLabel->"In[7]:=",ExpressionUUID->"04b14a7b-1876-442a-8a30-c3ed730bcadb"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["Pr", 
      RowBox[{"3", "+"}]], " ", "has", " ", "ground", " ", "state", " ", 
     "term", " ", 
     SuperscriptBox[
      RowBox[{"symbol", " "}], "3"], 
     SubscriptBox["H", 
      RowBox[{"4", " "}]]}], 
    SuperscriptBox["=", 
     RowBox[{" ", 
      RowBox[{
       RowBox[{"2", "S"}], "+", "1"}]}]], 
    SubscriptBox["L", "J"]}], TraditionalForm]],ExpressionUUID->
  "0e9c9984-3936-4a74-8d7c-3d8c3e9b252c"],
 " corresponding to S=1, L=5, J=4"
}], "Text",
 CellChangeTimes->{{3.797091712406839*^9, 
  3.797091763734208*^9}},ExpressionUUID->"850b6140-30c9-4406-b9bd-\
124362fdc1b1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"JVal", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LVal", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SVal", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gJLS", "[", 
    RowBox[{"J_", ",", "L_", ",", "S_"}], "]"}], "=", 
   RowBox[{"1", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"J", "*", 
        RowBox[{"(", 
         RowBox[{"J", "+", "1"}], ")"}]}], "+", 
       RowBox[{"S", "*", 
        RowBox[{"(", 
         RowBox[{"S", "+", "1"}], ")"}]}], "-", 
       RowBox[{"L", "*", 
        RowBox[{"(", 
         RowBox[{"L", "+", "1"}], ")"}]}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"2", "*", "J", "*", 
       RowBox[{"(", 
        RowBox[{"J", "+", "1"}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gVal", "=", 
   RowBox[{"gJLS", "[", 
    RowBox[{"JVal", ",", "LVal", ",", "SVal"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.786640148438908*^9, 3.7866401487685127`*^9}, {
   3.7881950585497932`*^9, 3.788195058644024*^9}, {3.788195412637435*^9, 
   3.788195413708387*^9}, {3.788195886755945*^9, 3.78819588762637*^9}, {
   3.788196025865087*^9, 3.788196026015921*^9}, {3.796901445279166*^9, 
   3.7969014466723547`*^9}, 3.796901956860958*^9, {3.797091658869198*^9, 
   3.797091662472419*^9}, {3.7970917077388477`*^9, 3.797091710309637*^9}, {
   3.797096565075316*^9, 3.79709657248085*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"47f0162e-7eac-4b39-97b7-3515ad0a5914"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{
    RowBox[{"vcr", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Y", "[", 
        RowBox[{"ll_", ",", "mm_"}], "]"}], "\[RuleDelayed]", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "*", "ll"}], "+", "1"}], ")"}], "/", "4"}], "/", 
          "Pi"}], "]"}], "*", 
        RowBox[{"GTBSTOperator", "[", 
         RowBox[{"ll", ",", "mm", ",", "JVal"}], "]"}]}]}], "}"}]}], "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{"temp", "/.", 
    RowBox[{
     RowBox[{"A", "[", 
      RowBox[{"0", ",", "0"}], "]"}], "\[Rule]", "0"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matcrBST", "=", 
   RowBox[{"temp", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"r", "\[Rule]", "1"}], ",", 
      RowBox[{
       RowBox[{"A", "[", 
        RowBox[{"4", ",", "4"}], "]"}], "\[Rule]", "a4"}], ",", 
      RowBox[{
       RowBox[{"A", "[", 
        RowBox[{"6", ",", "4"}], "]"}], "\[Rule]", "a6"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "MatrixForm"}], ";"}]}], "Input",
 CellChangeTimes->{{3.786627507720357*^9, 3.78662757792964*^9}, {
   3.7866277202481613`*^9, 3.786627735412421*^9}, {3.786627788623618*^9, 
   3.786627795672579*^9}, {3.786627923395748*^9, 3.786627953386715*^9}, {
   3.786628019298029*^9, 3.786628041536735*^9}, {3.786628426059493*^9, 
   3.786628461686534*^9}, {3.786628743577692*^9, 3.786628760372045*^9}, {
   3.7866400864895163`*^9, 3.78664015233587*^9}, {3.786640825633441*^9, 
   3.786640832701601*^9}, {3.786646996634104*^9, 3.786646999540801*^9}, {
   3.7866488342181587`*^9, 3.786648840252643*^9}, {3.7866491497723207`*^9, 
   3.786649155594781*^9}, {3.786649253814671*^9, 3.7866492654485893`*^9}, {
   3.7866494124688387`*^9, 3.786649414051375*^9}, {3.786649585012562*^9, 
   3.786649586039554*^9}, {3.78664990702824*^9, 3.786649915694008*^9}, {
   3.788195070645948*^9, 3.78819508183741*^9}, {3.7901104347783127`*^9, 
   3.7901104682891407`*^9}, {3.796657789537939*^9, 3.7966578185610228`*^9}, 
   3.7966578637771597`*^9, {3.796657927196455*^9, 3.796657936733631*^9}, {
   3.796658160029942*^9, 3.7966581781722927`*^9}, 3.796923929138701*^9},
 CellLabel->"In[13]:=",ExpressionUUID->"2eb8093b-d183-47e7-b0c3-ec0923aebcd0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"matA4", "=", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"matcrBST", ",", "a4"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matA6", "=", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"matcrBST", ",", "a6"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"a4", "*", "matA4"}], "+", 
    RowBox[{"a6", "*", "matA6"}], "-", "matcrBST"}], "//", "FullSimplify"}], 
  ";"}]}], "Input",
 CellChangeTimes->{
  3.796658119511499*^9, {3.79665817602528*^9, 3.796658216521126*^9}, {
   3.796658250575593*^9, 3.7966583079603167`*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"6d6eb012-3e61-4378-aecd-1d8475aa514e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"matA4Av", "=", 
   RowBox[{
    RowBox[{"Norm", "[", 
     RowBox[{"Eigenvalues", "[", "matA4", "]"}], "]"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", "*", "JVal"}], "+", "1"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matA6Av", "=", 
   RowBox[{
    RowBox[{"Norm", "[", 
     RowBox[{"Eigenvalues", "[", "matA6", "]"}], "]"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", "*", "JVal"}], "+", "1"}], ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7966583111783867`*^9, 3.7966583147590723`*^9}, 
   3.796658356374555*^9, {3.796658433420876*^9, 3.7966584633918657`*^9}, {
   3.796658496436825*^9, 3.796658532089654*^9}, {3.796659172254266*^9, 
   3.796659339374614*^9}, {3.796659474082996*^9, 3.7966595613539248`*^9}, {
   3.796659600789694*^9, 3.796659662278084*^9}, {3.796659906477929*^9, 
   3.796659961441085*^9}, {3.7966600937494097`*^9, 3.796660134489295*^9}, {
   3.796660720624673*^9, 3.7966607296844482`*^9}, {3.796896789760777*^9, 
   3.7968968102344*^9}, {3.7968969371331*^9, 3.796896954700213*^9}, {
   3.79689925287754*^9, 3.79689927695789*^9}, {3.796923959503933*^9, 
   3.796923978059507*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"71cc245c-35c2-43bb-87a0-16ebfe0ab91d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ham", "[", "x_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"x", "*", 
      RowBox[{"matA4", "/", "matA4Av"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"Abs", "[", "x", "]"}]}], ")"}], "*", 
      RowBox[{"matA6", "/", "matA6Av"}]}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"esys", "[", "x_", "]"}], ":=", 
   RowBox[{"Eigensystem", "[", 
    RowBox[{"ham", "[", "x", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.7966583263578873`*^9, {3.796660148329115*^9, 3.796660226315435*^9}, {
   3.79666074479909*^9, 3.796660745715601*^9}, {3.796661377716734*^9, 
   3.796661382701233*^9}, {3.79666142451544*^9, 3.796661432398801*^9}, {
   3.796662295430895*^9, 3.796662300213688*^9}, {3.796751985414648*^9, 
   3.796752008164106*^9}, 3.796901486293532*^9, {3.796924038670122*^9, 
   3.796924075190193*^9}, {3.79692411708181*^9, 3.7969241575137587`*^9}, {
   3.7970132179759903`*^9, 3.797013226320665*^9}, 3.79701326487462*^9, {
   3.797082603763859*^9, 3.797082630982724*^9}, 3.797096202274786*^9},
 CellLabel->"In[23]:=",ExpressionUUID->"4018c797-0f0e-41ed-b5b0-1e6f2c73f1c9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ham", "[", 
   RowBox[{"-", "0.32"}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.797277952738563*^9, 3.797277964885384*^9}, 
   3.79735746132434*^9},
 CellLabel->"In[27]:=",ExpressionUUID->"df212735-f391-461d-943e-26c4b2df4626"],

Cell[TextData[{
 "Define angular momentum operators ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["J", "x"], ",", 
     SubscriptBox["J", "y"], ",", 
     SubscriptBox["J", "z"]}], "}"}], TraditionalForm]],ExpressionUUID->
  "7742d779-44d8-4c37-b9c5-c29e0152b64b"]
}], "Text",
 CellChangeTimes->{{3.797063047872074*^9, 
  3.797063089681067*^9}},ExpressionUUID->"be023d4b-db9b-4cfa-8d54-\
4ce11da5f624"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"JVal", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JzOp", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "JVal"}], "+", "idx"}], ",", 
      RowBox[{"{", 
       RowBox[{"idx", ",", "0", ",", 
        RowBox[{"2", "*", "JVal"}]}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JPlusOp", "=", 
   RowBox[{
    RowBox[{"SparseArray", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i_", ",", "j_"}], "}"}], "\[Rule]", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"JVal", "-", 
             RowBox[{"(", 
              RowBox[{"j", "-", "JVal", "-", "1"}], ")"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"JVal", "+", 
             RowBox[{"(", 
              RowBox[{"j", "-", "JVal", "-", "1"}], ")"}], "+", "1"}], 
            ")"}]}], "]"}], "*", 
         RowBox[{"KroneckerDelta", "[", 
          RowBox[{"j", ",", 
           RowBox[{"i", "-", "1"}]}], "]"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"2", "*", "JVal"}], "+", "1"}], ",", 
        RowBox[{
         RowBox[{"2", "*", "JVal"}], "+", "1"}]}], "}"}]}], "]"}], "//", 
    "Normal"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JMinusOp", "=", 
   RowBox[{
    RowBox[{"SparseArray", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i_", ",", "j_"}], "}"}], "\[Rule]", 
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"JVal", "+", 
             RowBox[{"(", 
              RowBox[{"j", "-", "JVal", "-", "1"}], ")"}]}], ")"}], "*", 
           RowBox[{"(", 
            RowBox[{"JVal", "-", 
             RowBox[{"(", 
              RowBox[{"j", "-", "JVal", "-", "1"}], ")"}], "+", "1"}], 
            ")"}]}], "]"}], "*", 
         RowBox[{"KroneckerDelta", "[", 
          RowBox[{"j", ",", 
           RowBox[{"i", "+", "1"}]}], "]"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"2", "*", "JVal"}], "+", "1"}], ",", 
        RowBox[{
         RowBox[{"2", "*", "JVal"}], "+", "1"}]}], "}"}]}], "]"}], "//", 
    "Normal"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JxOp", "=", 
   RowBox[{
    RowBox[{"1", "/", "2"}], "*", 
    RowBox[{"(", 
     RowBox[{"JPlusOp", "+", "JMinusOp"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JyOp", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "I"}], "/", "2"}], "*", 
    RowBox[{"(", 
     RowBox[{"JPlusOp", "-", "JMinusOp"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "MatrixForm"}], ";"}]}], "Input",
 CellChangeTimes->{
  3.79706309060163*^9, {3.797081490499408*^9, 3.7970816121726933`*^9}, {
   3.797081644065496*^9, 3.7970817508956003`*^9}, {3.797081786592037*^9, 
   3.7970817867899933`*^9}, {3.797081837142178*^9, 3.797081906365307*^9}, {
   3.79708193846343*^9, 3.797081971038479*^9}, {3.797082009835897*^9, 
   3.797082019208625*^9}, {3.7970821041566267`*^9, 3.79708211382547*^9}, {
   3.7970821864704103`*^9, 3.797082230634911*^9}, {3.7970822804937677`*^9, 
   3.797082319503413*^9}, {3.797082350443152*^9, 3.7970823683330393`*^9}, {
   3.797083430702883*^9, 3.797083432264896*^9}, {3.7970834747621927`*^9, 
   3.7970834985768623`*^9}, {3.7970835384383097`*^9, 3.797083552233288*^9}, {
   3.797083631461594*^9, 3.797083634285095*^9}, {3.797083684548766*^9, 
   3.797083688237508*^9}, {3.797083756929514*^9, 3.7970837859396267`*^9}, {
   3.7970838493885803`*^9, 3.7970838549695253`*^9}, {3.797185571480345*^9, 
   3.797185584783328*^9}, {3.797186829423081*^9, 3.797186848397798*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"85e3d053-5979-4abf-85d6-aa5501cdf7d0"],

Cell[TextData[{
 "Check that my definition of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["J", "z"], TraditionalForm]],ExpressionUUID->
  "54780431-70ac-45e5-b1c4-97dc8d2d0f58"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["J", "+"], ",", " ", 
    SubscriptBox["J", "-"]}], TraditionalForm]],ExpressionUUID->
  "61192757-138d-41ea-b29c-5bdbb324a4ba"],
 " agrees with GTBST convention. Note that the order of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["m", "J"], TraditionalForm]],ExpressionUUID->
  "899ffbd1-1398-4f02-ac06-eee10479d061"],
 " states is {-J, -J+1, ..., J}. Some BST operators in terms of the angular \
momentum operators are defined in Table 7.1 on page 166 of Hergert (HG) book. "
}], "Text",
 CellChangeTimes->{{3.7970893060262823`*^9, 
  3.797089420911922*^9}},ExpressionUUID->"95ab0dd5-0639-439e-95bf-\
2cc13d73c305"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GTBSTOperator", "[", 
    RowBox[{"6", ",", "4", ",", "JVal"}], "]"}], "//", "MatrixForm"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{"63", "/", "512"}], "]"}], "*", 
     RowBox[{"1", "/", "2"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"11", "*", 
           RowBox[{"JzOp", ".", "JzOp"}]}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"JVal", "*", 
              RowBox[{"(", 
               RowBox[{"JVal", "+", "1"}], ")"}]}], "+", "38"}], ")"}], "*", 
           RowBox[{"IdentityMatrix", "[", 
            RowBox[{
             RowBox[{"2", "*", "JVal"}], "+", "1"}], "]"}]}]}], ")"}], ".", 
        "JPlusOp", ".", "JPlusOp", ".", "JPlusOp", ".", "JPlusOp"}], "+", 
       RowBox[{"JPlusOp", ".", "JPlusOp", ".", "JPlusOp", ".", "JPlusOp", ".", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"11", "*", 
           RowBox[{"JzOp", ".", "JzOp"}]}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"JVal", "*", 
              RowBox[{"(", 
               RowBox[{"JVal", "+", "1"}], ")"}]}], "+", "38"}], ")"}], "*", 
           RowBox[{"IdentityMatrix", "[", 
            RowBox[{
             RowBox[{"2", "*", "JVal"}], "+", "1"}], "]"}]}]}], ")"}]}]}], 
      ")"}]}], "//", "MatrixForm"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GTBSTOperator", "[", 
    RowBox[{"4", ",", "4", ",", "JVal"}], "]"}], "//", "MatrixForm"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Sqrt", "[", 
     RowBox[{"35", "/", "128"}], "]"}], "*", 
    RowBox[{"JPlusOp", ".", "JPlusOp", ".", "JPlusOp", ".", "JPlusOp"}]}], "//",
    "MatrixForm"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7970833405852623`*^9, 3.797083400984365*^9}, {
  3.797083860634185*^9, 3.797083889230492*^9}, {3.7970889334720573`*^9, 
  3.797089100726942*^9}, {3.7970892923594303`*^9, 3.797089304700452*^9}, {
  3.7970921488884277`*^9, 3.7970922240215063`*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"26ddbd90-7f55-43a3-bbd2-33a5d953db37"],

Cell["\<\
Define function that converts Mathematica expression into Python string\
\>", "Text",
 CellChangeTimes->{{3.7974109631463003`*^9, 
  3.7974109849172993`*^9}},ExpressionUUID->"09d435c6-bf67-4797-98ed-\
e5bc1d38c012"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ConvertToPyString", "[", "sstr_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"str", "=", "sstr"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"str", "=", 
      RowBox[{"Expand", "[", 
       RowBox[{"Simplify", "[", "str", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"str", "=", 
      RowBox[{"N", "[", "str", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"str", "=", 
      RowBox[{"ToString", "[", 
       RowBox[{"str", ",", "FortranForm"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"str", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"str", ",", 
        RowBox[{
         RowBox[{"Shortest", "[", 
          RowBox[{"\"\<Sqrt(\>\"", "~~", "i__", "~~", "\"\<)\>\""}], "]"}], 
         "\[Rule]", 
         RowBox[{"\"\<np.sqrt(\>\"", "~~", "i", "~~", "\"\<)\>\""}]}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"str", "=", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"str", ",", 
        RowBox[{
         RowBox[{"Shortest", "[", 
          RowBox[{"\"\<Abs(\>\"", "~~", "i__", "~~", "\"\<)\>\""}], "]"}], 
         "\[Rule]", 
         RowBox[{"\"\<np.abs(\>\"", "~~", "i", "~~", "\"\<)\>\""}]}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", "str"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.797261935202834*^9, 3.797261982709478*^9}, {
   3.797262013965489*^9, 3.797262051348982*^9}, {3.797262335959133*^9, 
   3.7972623815014544`*^9}, 3.797262427221718*^9, {3.797266888096942*^9, 
   3.797267015952709*^9}, {3.7972671843860807`*^9, 3.797267196986126*^9}, {
   3.797270231651085*^9, 3.797270236074506*^9}, {3.797270292842783*^9, 
   3.797270580170759*^9}, {3.797272912045128*^9, 3.797272917523796*^9}, {
   3.7972729920677567`*^9, 3.79727318620399*^9}, 3.797273315333137*^9, {
   3.797273475335691*^9, 3.797273524621703*^9}, {3.797273559862084*^9, 
   3.797273569452402*^9}, {3.797273681508535*^9, 3.797273702828506*^9}, 
   3.7972739801683903`*^9, {3.797275761596661*^9, 3.797275780915831*^9}, {
   3.797275844940381*^9, 3.7972758450919313`*^9}, {3.797275941580229*^9, 
   3.7972759705243587`*^9}, {3.797276010244479*^9, 3.797276038684608*^9}, {
   3.7972762116527452`*^9, 3.797276229996397*^9}, {3.797276262476548*^9, 
   3.797276273428364*^9}, {3.797276486085189*^9, 3.797276495173934*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"e50cca83-c1b7-4285-a08f-55a87b80e864"],

Cell["\<\
Write python module file that sets up expression of crystal field matrix\
\>", "Text",
 CellChangeTimes->{{3.797410989418001*^9, 
  3.797411025541195*^9}},ExpressionUUID->"f23043ab-4569-4b66-a489-\
c56d42c53d3b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"outdir", "=", 
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
    "\"\<Input_ham_cr/\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"strm", "=", 
    RowBox[{"OpenWrite", "[", 
     RowBox[{"outdir", "<>", "\"\<ham_cr.py\>\""}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"strm", ",", 
    RowBox[{"FormatType", "\[Rule]", "OutputForm"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetOptions", "[", 
    RowBox[{"strm", ",", 
     RowBox[{"PageWidth", "\[Rule]", "Infinity"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pointGroup", "=", "\"\<Oh\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"varsString", "=", 
    RowBox[{"{", 
     RowBox[{"\"\<x0\>\"", ",", "\"\<x1\>\""}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Write", "[", 
  RowBox[{
  "strm", ",", 
   "\"\<# Module creates crystal field Hamiltonian matrix for point group \
(PG) Oh and J=4.\\n# Number of crystal field variables is 2: {x0, x1}.\>\""}],
   "]"}], "\[IndentingNewLine]", 
 RowBox[{"Write", "[", 
  RowBox[{"strm", ",", "\"\<import numpy as np\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Write", "[", 
  RowBox[{"strm", ",", " ", 
   RowBox[{
   "\"\<def ham_cr_PG_\>\"", "<>", "pointGroup", "<>", "\"\<_J_\>\"", "<>", 
    RowBox[{"ToString", "[", "JVal", "]"}], "<>", "\"\<(\>\"", "<>", 
    RowBox[{"varsString", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "<>", "\"\<, \>\"", "<>", 
    RowBox[{"varsString", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "<>", "\"\<):\>\""}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Write", "[", 
   RowBox[{"strm", ",", 
    RowBox[{"\"\<\\t\>\"", "<>", "\"\<J = 4\>\""}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Write", "[", 
   RowBox[{"strm", ",", 
    RowBox[{"\"\<\\t\>\"", "<>", "\"\<dim=2*J+1\>\""}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Write", "[", 
   RowBox[{"strm", ",", 
    RowBox[{
    "\"\<\\t\>\"", "<>", 
     "\"\<ham = np.arange(dim*dim, dtype=np.float)\>\""}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Write", "[", 
   RowBox[{"strm", ",", 
    RowBox[{"\"\<\\t\>\"", "<>", "\"\<ham = ham.reshape(dim,dim)\>\""}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"idx", "=", "0"}], ",", 
   RowBox[{"idx", "<", 
    RowBox[{"Length", "[", 
     RowBox[{"ham", "[", "x", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"jdx", "=", "0"}], ",", 
      RowBox[{"jdx", "<", 
       RowBox[{"Length", "[", 
        RowBox[{"ham", "[", "x", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tmp", "=", 
        RowBox[{"ConvertToPyString", "[", 
         RowBox[{"x0", "*", 
          RowBox[{
           RowBox[{"ham", "[", "x1", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"idx", "+", "1"}], ",", 
             RowBox[{"jdx", "+", "1"}]}], "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Write", "[", 
        RowBox[{"strm", ",", 
         RowBox[{"\"\<\\t\>\"", "<>", "\"\<ham[\>\"", "<>", 
          RowBox[{"ToString", "[", "idx", "]"}], "<>", "\"\<][\>\"", "<>", 
          RowBox[{"ToString", "[", "jdx", "]"}], "<>", "\"\<] = \>\"", "<>", 
          "tmp"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"jdx", "++"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"idx", "++"}], ";"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Write", "[", 
    RowBox[{"strm", ",", 
     RowBox[{"\"\<\\t\>\"", "<>", "\"\<return ham\>\""}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"For", " ", "[", 
     RowBox[{
      RowBox[{"index", "=", "1"}], ",", 
      RowBox[{"index", "\[LessEqual]", 
       RowBox[{"Length", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{"ham", "[", "x", "]"}], "]"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"label", " ", "=", " ", 
        RowBox[{"\"\<# Element \>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{"index", " ", "-", " ", "1"}], "]"}], " ", "<>", 
         "\"\<\\n\>\""}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"tmp", "=", 
        RowBox[{
         RowBox[{"ConvertToPyString", "[", 
          RowBox[{"W", "*", 
           RowBox[{"ham", "[", "x", "]"}]}], "]"}], "\"\<\\n\>\""}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Write", "[", 
        RowBox[{"strm", ",", " ", "label"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Write", "[", 
        RowBox[{"strm", ",", " ", "tmp"}], "]"}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"index", "++"}]}]}], "\[IndentingNewLine]", "]"}], ";"}], 
   "\[IndentingNewLine]", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Close", "[", "strm", "]"}]}], "Input",
 CellChangeTimes->{{3.797261935202834*^9, 3.797261982709478*^9}, {
   3.797262013965489*^9, 3.797262051348982*^9}, {3.797262335959133*^9, 
   3.7972623815014544`*^9}, 3.797262427221718*^9, {3.797266888096942*^9, 
   3.797267015952709*^9}, {3.7972671843860807`*^9, 3.797267196986126*^9}, {
   3.797270231651085*^9, 3.797270236074506*^9}, {3.797270292842783*^9, 
   3.797270580170759*^9}, {3.797272912045128*^9, 3.797272917523796*^9}, {
   3.7972729920677567`*^9, 3.79727318620399*^9}, 3.797273315333137*^9, {
   3.797273475335691*^9, 3.797273524621703*^9}, {3.797273559862084*^9, 
   3.797273569452402*^9}, {3.797273681508535*^9, 3.797273702828506*^9}, 
   3.7972739801683903`*^9, 3.7972740463108187`*^9, {3.797274082205628*^9, 
   3.797274124732308*^9}, {3.7972741647722883`*^9, 3.797274203885873*^9}, {
   3.797274283221828*^9, 3.7972743047964287`*^9}, {3.7972743678766317`*^9, 
   3.79727437209227*^9}, {3.797274502044259*^9, 3.797274765276348*^9}, {
   3.7972749534688063`*^9, 3.7972749750917997`*^9}, {3.7972751965084352`*^9, 
   3.797275262893379*^9}, {3.7972753702688007`*^9, 3.797275380468472*^9}, 
   3.797275755293952*^9, {3.797276355982937*^9, 3.797276396637413*^9}, {
   3.797276542686059*^9, 3.797276572213047*^9}, {3.797276979701881*^9, 
   3.797277077452806*^9}, {3.797277425470429*^9, 3.797277427708932*^9}, {
   3.797277531934023*^9, 3.797277577164948*^9}, {3.797277659094515*^9, 
   3.797277681141062*^9}, {3.79727781107787*^9, 3.7972778907410107`*^9}, {
   3.797278024198574*^9, 3.797278031765902*^9}, {3.797278091061487*^9, 
   3.7972780914453983`*^9}, {3.7974464682023087`*^9, 
   3.7974465001163473`*^9}, {3.797446545036593*^9, 
   3.797446545924204*^9}},ExpressionUUID->"83516c46-f2b5-4d93-b875-\
6628579d1543"],

Cell["\<\
Energy spectrum as a function of crystal field parameter x (setting W = 1).\
\>", "Text",
 CellChangeTimes->{{3.7974110323239393`*^9, 
  3.797411051605345*^9}},ExpressionUUID->"24a0df4a-bb3f-436a-adf8-\
fb315d303b15"],

Cell[BoxData[
 RowBox[{"plot1", "=", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"Sort", "[", 
     RowBox[{
      RowBox[{"esys", "[", "x", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<E/W\>\"", ",", "\"\<\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<x\>\"", ",", "\"\<\>\""}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"Directive", "[", "Blue", "]"}]}], ",", " ", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"Thickness", "[", "0.0025", "]"}], ",", 
       RowBox[{"FontSize", "\[Rule]", "14"}], ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.796660288131609*^9, 3.796660308531536*^9}, {
  3.796660375760756*^9, 3.796660383352623*^9}, {3.7967502105470667`*^9, 
  3.7967502377208014`*^9}, {3.796750381125403*^9, 3.796750426440358*^9}, {
  3.7967504619482527`*^9, 3.7967505605332336`*^9}, {3.7967506415632267`*^9, 
  3.796750642344624*^9}, {3.796901500735393*^9, 3.796901502349043*^9}, {
  3.796923661767095*^9, 3.7969236636434717`*^9}, {3.796924078244068*^9, 
  3.796924092974341*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"dd3efdaf-7d7c-4cdd-b8a7-b7321f6e44eb"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{
    "\"\<../Notes_Peter/Graphics/Energies-J_4-B_0-BST.pdf\>\"", ",", " ", 
     "plot1"}], "]"}]}], "\[IndentingNewLine]", "*)"}]], "Input",
 CellChangeTimes->{{3.797169660485691*^9, 
  3.797169733261634*^9}},ExpressionUUID->"1efeba03-4185-4ba0-9516-\
da3f6acc4ce5"],

Cell["\<\
For a random choice of W and x we find the level spectrum and associated \
partition function (at B=0). Find numerical eigenvalues (with lowest one set \
to zero) and eigenstates for that W and x: called energies and evecs.\
\>", "Text",
 CellChangeTimes->{{3.7970827426845922`*^9, 3.797082783840917*^9}, {
  3.797082978577118*^9, 
  3.797083019581115*^9}},ExpressionUUID->"29d8fce6-b9ea-44d7-b2ee-\
ad28ced3e224"],

Cell[BoxData[{
 RowBox[{"WVal", "=", "4.25"}], "\[IndentingNewLine]", 
 RowBox[{"xVal", "=", 
  RowBox[{"-", "0.32"}]}]}], "Input",
 CellChangeTimes->{{3.797357491852181*^9, 3.7973574991633577`*^9}, {
  3.797357578731799*^9, 3.797357586611557*^9}, {3.797411058838107*^9, 
  3.797411061429859*^9}, {3.797439002077861*^9, 3.797439007365304*^9}},
 CellLabel->
  "In[157]:=",ExpressionUUID->"63ec70f2-7af0-4d8c-9f6e-b5f2d6a04fc6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{"WVal", "*", 
    RowBox[{
     RowBox[{"esys", "[", "xVal", "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"energies", "=", 
   RowBox[{"temp", "-", 
    RowBox[{"Min", "[", "temp", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"evecs", "=", 
   RowBox[{
    RowBox[{"esys", "[", "xVal", "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Zcr", "[", "Temp_", "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"energies", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "/", "Temp"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "energies", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.797082819112352*^9, 3.79708281928535*^9}, {
   3.797082934987808*^9, 3.797082967965996*^9}, {3.797083051134324*^9, 
   3.797083055826861*^9}, 3.7970960250450373`*^9, {3.797096110974231*^9, 
   3.797096112653965*^9}},
 CellLabel->
  "In[159]:=",ExpressionUUID->"6122f8b9-408b-4a3f-a98c-5e140ad66e76"],

Cell[BoxData[
 RowBox[{"plot1", "=", 
  RowBox[{"ListPlot", "[", 
   RowBox[{
    RowBox[{"Sort", "[", "energies", "]"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "10"}], "}"}], ",", "Automatic"}], "}"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.796932106125465*^9, 3.7969321211145697`*^9}, {
  3.7969323689530487`*^9, 3.79693246184328*^9}, {3.797082708844481*^9, 
  3.797082715042218*^9}, {3.797169922681107*^9, 3.7971699233440723`*^9}},
 CellLabel->
  "In[150]:=",ExpressionUUID->"7f5a2018-3955-40e9-af99-57d14b491eae"],

Cell["Magnetic Jz expectation values of the different levels", "Text",
 CellChangeTimes->{{3.797096529184803*^9, 
  3.797096544645657*^9}},ExpressionUUID->"36cb6760-da0b-4efe-b90b-\
82fec91ad3e2"],

Cell[BoxData[{
 RowBox[{"WVal", "*", 
  RowBox[{
   RowBox[{"esys", "[", "xVal", "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Conjugate", "[", 
      RowBox[{
       RowBox[{"esys", "[", "xVal", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "i"}], "]"}], "]"}], "]"}], ".", "JzOp", ".", 
     RowBox[{
      RowBox[{"esys", "[", "xVal", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "i"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{
       RowBox[{"2", "*", "JVal"}], "+", "1"}]}], "}"}]}], "]"}], "//", 
  "Chop"}]}], "Input",
 CellChangeTimes->{{3.797093190611351*^9, 3.7970932180792503`*^9}, {
  3.797093253296327*^9, 3.797093316758301*^9}, {3.797096524906625*^9, 
  3.797096525653751*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"de0ea3f8-2690-44f3-9a4b-461cc2e35c40"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Specific heat", "Subsection",
 CellChangeTimes->{
  3.7969240324035873`*^9, {3.796924410869841*^9, 3.7969244150530243`*^9}, {
   3.796925959211782*^9, 
   3.796925960854185*^9}},ExpressionUUID->"101b3432-38c6-4cf5-81ab-\
5fc6ddb28077"],

Cell["\<\
Specific heat cV/kB. Enter energies and Temperature (Temp) in Kelvin. \
\>", "Text",
 CellChangeTimes->{{3.7969311498218527`*^9, 
  3.796931198623749*^9}},ExpressionUUID->"b583c3fd-698c-42ac-996a-\
6190aae6004f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"cVOverkB", "[", "Temp_", "]"}], ":=", 
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"Temp", "^", "2"}]}], "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"1", "/", 
        RowBox[{"Zcr", "[", "Temp", "]"}]}], "*", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"energies", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "^", "2"}], "*", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"energies", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "/", "Temp"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "energies", "]"}]}], "}"}]}], "]"}]}], "-", 
      
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"1", "/", 
          RowBox[{"Zcr", "[", "Temp", "]"}]}], "*", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"energies", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "*", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"energies", "[", 
                RowBox[{"[", "i", "]"}], "]"}]}], "/", "Temp"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "energies", "]"}]}], "}"}]}], "]"}]}], 
        ")"}], "^", "2"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.796926979792131*^9, 3.7969271048098993`*^9}, 
   3.796931147117601*^9, {3.7969311823582697`*^9, 3.7969311824794207`*^9}, {
   3.7969312126058826`*^9, 3.7969312172307367`*^9}, {3.796931258023196*^9, 
   3.7969313150286703`*^9}, {3.7969329721765747`*^9, 3.79693298676687*^9}, {
   3.797026627954834*^9, 3.7970266291532927`*^9}, {3.797082599131392*^9, 
   3.7970826000070353`*^9}, {3.7970828249944696`*^9, 3.7970828303844757`*^9}, 
   3.797096038077091*^9},
 CellLabel->
  "In[130]:=",ExpressionUUID->"3018019f-471c-432b-b260-97364df61dbb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Quiet", "[", 
   RowBox[{"maxy", "=", 
    RowBox[{
     RowBox[{"FindMaxValue", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"cVOverkB", "[", "Temp", "]"}], ",", 
         RowBox[{
          RowBox[{"Temp", ">", "0"}], "&&", 
          RowBox[{"Temp", "<", "300"}]}]}], "}"}], ",", 
       RowBox[{"{", "Temp", "}"}]}], "]"}], "*", "1.1"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GapAboveGSVal", "=", 
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Sort", "[", "energies", "]"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "-", 
         RowBox[{
          RowBox[{"Sort", "[", "energies", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{
           RowBox[{"Length", "[", "energies", "]"}], "-", "1"}]}], "}"}]}], 
       "]"}], ",", 
      RowBox[{
       RowBox[{"#", ">", "0"}], "&"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lineGapAboveGS", "=", 
   RowBox[{"Line", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"GapAboveGSVal", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"GapAboveGSVal", ",", "maxy"}], "}"}]}], "}"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.79706244662847*^9, 3.7970625220042973`*^9}, {
   3.797062558115399*^9, 3.7970625824583797`*^9}, 3.797062798717841*^9, {
   3.797062834719076*^9, 3.797062942118616*^9}, 3.797082837003025*^9},
 CellLabel->
  "In[131]:=",ExpressionUUID->"23e1b422-6204-452e-bf35-5e0cbc225054"],

Cell[BoxData[
 RowBox[{"plot1", "=", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"cVOverkB", "[", "Temp", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"Temp", ",", "1", ",", "300"}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(c\), \(V\)]\)/\!\(\*SubscriptBox[\(k\), \(B\
\)]\) (dimensionless)\>\"", ",", "\"\<\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<T (Kelvin)\>\"", ",", "\"\<\>\""}], "}"}]}], "}"}]}], 
    ",", 
    RowBox[{"Epilog", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{"Dashed", ",", " ", "Red"}], "]"}], ",", "lineGapAboveGS"}], 
      "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"Thickness", "[", "0.0025", "]"}], ",", 
       RowBox[{"FontSize", "\[Rule]", "14"}], ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.796931219243614*^9, 3.796931228437479*^9}, {
  3.796931770546015*^9, 3.796931802507873*^9}, {3.7969330051706953`*^9, 
  3.796933009185679*^9}, {3.797026633860376*^9, 3.797026664080826*^9}, {
  3.79702670858775*^9, 3.797026717364566*^9}, {3.797062588394966*^9, 
  3.797062659604664*^9}, {3.797062945438847*^9, 3.797062956104608*^9}, {
  3.797062986583458*^9, 3.797062994271462*^9}, {3.797169876368163*^9, 
  3.797169876806964*^9}, {3.7971747331118717`*^9, 3.79717473876569*^9}, {
  3.797174773160492*^9, 3.797174773989563*^9}, {3.79717499330341*^9, 
  3.797175038902234*^9}, {3.797175308007824*^9, 3.79717531383041*^9}},
 CellLabel->
  "In[151]:=",ExpressionUUID->"0d576976-de2e-4fe5-8326-551add2d64b0"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"\"\<../Notes_Peter/Graphics/cV-J_4-W_\>\"", "~~", 
      RowBox[{"ToString", "[", "WVal", "]"}], "~~", "\"\<-x_\>\"", "~~", 
      RowBox[{"ToString", "[", "xVal", "]"}], "~~", "\"\<.pdf\>\""}], ",", 
     " ", "plot1"}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.7971697910121307`*^9, 3.797169844877747*^9}, 
   3.7971698870628843`*^9, {3.797357639316393*^9, 
   3.797357641047388*^9}},ExpressionUUID->"d1d6f116-d5ab-4ed6-80d9-\
585ba0d14d48"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Magnetization in finite magnetic field and magnetic susceptibility\
\>", "Subsection",
 CellChangeTimes->{{3.79709104619378*^9, 3.797091063478002*^9}, {
  3.797102375276865*^9, 
  3.797102396139666*^9}},ExpressionUUID->"bde64d0f-869b-4c7c-b40d-\
eb16a1d992b7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Entity", "[", 
    RowBox[{"\"\<PhysicalConstant\>\"", ",", "\"\<BoltzmannConstant\>\""}], 
    "]"}], "[", "\"\<Value\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Entity", "[", 
    RowBox[{"\"\<PhysicalConstant\>\"", ",", "\"\<BohrMagneton\>\""}], "]"}], 
   "[", "\"\<Value\>\"", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/", "%%"}], ";"}]}], "Input",
 CellChangeTimes->{
  3.797091130674865*^9, {3.79709150239548*^9, 3.797091584189026*^9}, {
   3.79709181325438*^9, 3.797091817539772*^9}, {3.797092026755538*^9, 
   3.797092032995563*^9}, {3.797169753667864*^9, 3.7971697573468933`*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"e1f86394-44e1-492d-bc06-8f88ba4eaef8"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"263", "/", "6.51"}]}]], "Input",
 CellChangeTimes->{{3.797101918185444*^9, 3.7971019417999773`*^9}, 
   3.7971020149791813`*^9},
 CellLabel->
  "In[141]:=",ExpressionUUID->"9276c180-8308-48c9-8330-ac940e6aa914"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"kBVal", "=", 
     FractionBox["1380649", "100000000000000000000000000000"]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
    "\[Mu]BVal", "=", 
     "9.2740100783000004424165405042207403`9.219079536512577*^-24"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"\[Mu]BVal", "/", "kBVal"}]}]}]], "Input",
 CellChangeTimes->{{3.797092038757635*^9, 3.7970920615092897`*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"4368b146-7dd0-411d-a617-49f229e812b7"],

Cell[CellGroupData[{

Cell["Magnetic field along z", "Subsubsection",
 CellChangeTimes->{{3.797091867319274*^9, 
  3.797091881074354*^9}},ExpressionUUID->"314ab424-b2f6-4ffe-80c1-\
cd11939d9bbe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"hamB", "[", 
    RowBox[{"Bfield_", ",", "W_", ",", "x_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"W", "*", 
      RowBox[{"ham", "[", "x", "]"}]}], "-", 
     RowBox[{
      RowBox[{"gJLS", "[", 
       RowBox[{"JVal", ",", "LVal", ",", "SVal"}], "]"}], "*", 
      RowBox[{"\[Mu]BVal", "/", "kBVal"}], "*", "JzOp", "*", "Bfield"}]}], "//",
     "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "MatrixForm"}], ";"}]}], "Input",
 CellChangeTimes->{{3.797091064331895*^9, 3.797091128686928*^9}, {
   3.797091779730118*^9, 3.7970917978472*^9}, {3.797091844726115*^9, 
   3.797091903384541*^9}, {3.797092070896071*^9, 3.797092117997636*^9}, 
   3.797092233665975*^9, 3.797092273944283*^9, 3.797092316377521*^9, {
   3.7970925655526667`*^9, 3.797092576402527*^9}, 3.7970960542870407`*^9},
 CellLabel->
  "In[135]:=",ExpressionUUID->"0b23a4e9-30c1-42a1-9dbf-65f1a8472b9e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"esysB", "[", 
     RowBox[{"Bfield_", ",", "W_", ",", "x_"}], "]"}], ":=", 
    RowBox[{"Eigensystem", "[", 
     RowBox[{"hamB", "[", 
      RowBox[{"Bfield", ",", "W", ",", "x"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ZB", "[", 
    RowBox[{"Bfield_", ",", "Temp_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"esysB", "[", 
            RowBox[{"Bfield", ",", "WVal", ",", "xVal"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "i"}], "]"}], "]"}], "-", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{"esysB", "[", 
             RowBox[{"Bfield", ",", "WVal", ",", "xVal"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ")"}]}], "/", "Temp"}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{
        RowBox[{"2", "*", "JVal"}], "+", "1"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.797092303909333*^9, 3.7970924393080797`*^9}, {
   3.797092510287903*^9, 3.797092643733098*^9}, {3.797092711299571*^9, 
   3.797092721618252*^9}, {3.797093510139996*^9, 3.797093511284247*^9}, {
   3.7970955196946783`*^9, 3.7970955204649343`*^9}, 3.797096060624319*^9},
 CellLabel->
  "In[163]:=",ExpressionUUID->"f940bede-a450-47ad-9493-fe20a168ea1b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"gJLS", "[", 
     RowBox[{"JVal", ",", "LVal", ",", "SVal"}], "]"}], "*", 
    RowBox[{"\[Mu]BVal", "/", "kBVal"}], "*", "JzOp", "*", "1"}], "//", 
   "MatrixForm"}], ";"}]], "Input",
 CellChangeTimes->{{3.797093677185074*^9, 3.797093697849971*^9}, 
   3.797096074448151*^9},
 CellLabel->
  "In[165]:=",ExpressionUUID->"49ef8df6-970a-4d8e-aa55-9452873cfc71"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"esysB", "[", 
   RowBox[{"1", ",", "1", ",", 
    RowBox[{"-", "0.32"}]}], "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Sort", "[", 
  RowBox[{"%", "-", 
   RowBox[{"Min", "[", "%", "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.797358213520982*^9, 3.797358242883663*^9}, {
  3.7973583081013737`*^9, 3.797358330355772*^9}},
 CellLabel->
  "In[166]:=",ExpressionUUID->"ee85ae95-a2c5-43c9-9d3c-7631c756c257"],

Cell[BoxData[
 RowBox[{"plot1", "=", 
  RowBox[{"ListPlot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Sort", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"esysB", "[", 
          RowBox[{"0", ",", "WVal", ",", "xVal"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"esysB", "[", 
           RowBox[{"0", ",", "WVal", ",", "xVal"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"Sort", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"esysB", "[", 
          RowBox[{"2", ",", "WVal", ",", "xVal"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"esysB", "[", 
           RowBox[{"2", ",", "WVal", ",", "xVal"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"Sort", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"esysB", "[", 
          RowBox[{"10", ",", "WVal", ",", "xVal"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"esysB", "[", 
           RowBox[{"10", ",", "WVal", ",", "xVal"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(E\), \(i\)]\)(B)-\!\(\*SubscriptBox[\(E\), \
\(GS\)]\)(B)  (K)\>\"", ",", "\"\<\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<Eigenstate index i\>\"", ",", "\"\<\>\""}], "}"}]}], 
      "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"Thickness", "[", "0.0025", "]"}], ",", 
       RowBox[{"FontSize", "\[Rule]", "14"}], ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "10"}], "}"}], ",", "Automatic"}], "}"}]}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"Placed", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<B=0\>\"", ",", " ", "\"\<B=2T\>\"", ",", " ", "\"\<B=10T\>\""}], 
        "}"}], ",", "Above"}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.796932106125465*^9, 3.7969321211145697`*^9}, {
  3.7969323689530487`*^9, 3.79693246184328*^9}, {3.797082708844481*^9, 
  3.797082715042218*^9}, {3.797093396870356*^9, 3.797093485958498*^9}, {
  3.7970935339539137`*^9, 3.7970935359882793`*^9}, {3.797093579643457*^9, 
  3.7970936548623457`*^9}, {3.797169953529686*^9, 3.797169955241962*^9}, {
  3.797174143877552*^9, 3.797174266324847*^9}, {3.797174337222294*^9, 
  3.797174408549038*^9}, {3.7971747544643507`*^9, 3.797174755661996*^9}, {
  3.797174889948656*^9, 3.7971749084621964`*^9}, {3.7971752315373096`*^9, 
  3.797175271894486*^9}},
 CellLabel->
  "In[168]:=",ExpressionUUID->"cdb329fe-cc1d-4977-82e8-3ae58d7a12ad"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"\"\<../Notes_Peter/Graphics/Spectrum_Vs_B-J_4-W_\>\"", "~~", 
      RowBox[{"ToString", "[", "WVal", "]"}], "~~", "\"\<-x_\>\"", "~~", 
      RowBox[{"ToString", "[", "xVal", "]"}], "~~", "\"\<.pdf\>\""}], ",", 
     " ", "plot1"}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.797174417004724*^9, 3.797174418884845*^9}, {
  3.797358205004739*^9, 
  3.797358210637102*^9}},ExpressionUUID->"6bddb1e8-fccc-4cba-b47a-\
d22d28446824"],

Cell[BoxData[{
 RowBox[{"WVal", "*", 
  RowBox[{
   RowBox[{"esys", "[", "xVal", "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Conjugate", "[", 
      RowBox[{
       RowBox[{"esys", "[", "xVal", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "i"}], "]"}], "]"}], "]"}], ".", "JzOp", ".", 
     RowBox[{
      RowBox[{"esys", "[", "xVal", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "i"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{
       RowBox[{"2", "*", "JVal"}], "+", "1"}]}], "}"}]}], "]"}], "//", 
  "Chop"}]}], "Input",
 CellChangeTimes->{{3.797093190611351*^9, 3.7970932180792503`*^9}, {
  3.797093253296327*^9, 3.797093316758301*^9}, {3.7970935596895037`*^9, 
  3.7970935609004803`*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"d2c83489-d14f-4d11-932d-9464d3b5c8dc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"esys", "[", "xVal", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "i"}], "]"}], "]"}], ".", "JzOp", ".", 
     RowBox[{
      RowBox[{"esys", "[", "xVal", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{
       RowBox[{"2", "*", "JVal"}], "+", "1"}]}], "}"}]}], "]"}], "//", 
  "Chop"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sqrt", "[", 
   RowBox[{"20", "/", "3"}], "]"}], "//", "N"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"energies", "[", 
   RowBox[{"[", "5", "]"}], "]"}], "-", 
  RowBox[{"energies", "[", 
   RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"40", "/", "3"}], "/", "%"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.797095088111053*^9, 3.797095183295354*^9}, {
  3.797095282764439*^9, 3.7970953628113117`*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"5aed7b5f-4619-48fe-9280-c02971ef71fe"],

Cell["Magnetization in finite field", "Text",
 CellChangeTimes->{{3.79709245886586*^9, 3.7970924678399563`*^9}, {
  3.797097004106513*^9, 3.797097006350685*^9}, {3.797102404987516*^9, 
  3.79710240569556*^9}},
 Background->GrayLevel[
  0.85],ExpressionUUID->"5a6c9c81-7b43-41cc-a21c-36023417a57d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"magZ", "[", 
    RowBox[{"Bfield_", ",", "Temp_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"ZB", "[", 
      RowBox[{"Bfield", ",", "Temp"}], "]"}]}], "*", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Conjugate", "[", 
         RowBox[{
          RowBox[{"esysB", "[", 
           RowBox[{"Bfield", ",", "WVal", ",", "xVal"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "i"}], "]"}], "]"}], "]"}], ".", "JzOp", ".", 
        RowBox[{
         RowBox[{"esysB", "[", 
          RowBox[{"Bfield", ",", "WVal", ",", "xVal"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "i"}], "]"}], "]"}]}], " ", "*", 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"esysB", "[", 
              RowBox[{"Bfield", ",", "WVal", ",", "xVal"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "i"}], "]"}], "]"}], "-", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"esysB", "[", 
               RowBox[{"Bfield", ",", "WVal", ",", "xVal"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ")"}]}], "/", "Temp"}],
         "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{
         RowBox[{"2", "*", "JVal"}], "+", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.797092468495714*^9, 3.79709250035081*^9}, {
   3.797092651331514*^9, 3.7970927961129827`*^9}, {3.797095445201747*^9, 
   3.797095449037384*^9}, {3.7970958842573023`*^9, 3.797095891615671*^9}, 
   3.797095978403713*^9, 3.7970972689182568`*^9},
 CellLabel->
  "In[185]:=",ExpressionUUID->"337c198a-6e33-4377-907f-f5d72d5413ee"],

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Conjugate", "[", 
       RowBox[{
        RowBox[{"esysB", "[", 
         RowBox[{"1", ",", "WVal", ",", "xVal"}], "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "i"}], "]"}], "]"}], "]"}], ".", "JzOp", ".", 
      RowBox[{
       RowBox[{"esysB", "[", 
        RowBox[{"1", ",", "WVal", ",", "xVal"}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "i"}], "]"}], "]"}]}], "*", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"esysB", "[", 
            RowBox[{"1", ",", "WVal", ",", "xVal"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "i"}], "]"}], "]"}], "-", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{"esysB", "[", 
             RowBox[{"1", ",", "WVal", ",", "xVal"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ")"}]}], " ", "/", "1"}],
       "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{
       RowBox[{"2", "*", "JVal"}], "+", "1"}]}], "}"}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.79735838047291*^9, 3.797358401845393*^9}, {
   3.797358477214653*^9, 3.797358481676236*^9}, {3.797359168126816*^9, 
   3.797359253676956*^9}, 3.797439164550324*^9},
 CellLabel->
  "In[170]:=",ExpressionUUID->"723bab12-a5c3-4bdb-a3a2-7d01ed45ac35"],

Cell[BoxData[
 RowBox[{"plot1", "=", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"magZ", "[", 
       RowBox[{"B", ",", "1"}], "]"}], ",", 
      RowBox[{"magZ", "[", 
       RowBox[{"B", ",", "6.69"}], "]"}], ",", 
      RowBox[{"magZ", "[", 
       RowBox[{"B", ",", "44.8"}], "]"}], ",", 
      RowBox[{"magZ", "[", 
       RowBox[{"B", ",", "300"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"B", ",", "0", ",", "10"}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(M\), \
\(z\)]\)/(\!\(\*SubscriptBox[\(\[Mu]\), \(B\)]\)\!\(\*SubscriptBox[\(g\), \(J\
\)]\))\>\"", ",", "\"\<\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<B (T)\>\"", ",", "\"\<\>\""}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"Placed", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<T=1K\>\"", ",", "\"\<T=50K\>\"", ",", "\"\<T=100K\>\"", ",", 
         "\"\<T=300K\>\""}], "}"}], ",", "Above"}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.79709279725414*^9, 3.79709283037326*^9}, {
   3.797092895029755*^9, 3.797092895446526*^9}, 3.7970937485300703`*^9, {
   3.797097011149433*^9, 3.797097025966505*^9}, {3.797097104784625*^9, 
   3.797097120523793*^9}, {3.797097153877613*^9, 3.797097162955976*^9}, {
   3.797097216753148*^9, 3.7970972202747927`*^9}, {3.797097279270802*^9, 
   3.797097283677964*^9}, {3.797097540282523*^9, 3.797097575449111*^9}, {
   3.797175376143649*^9, 3.797175425518318*^9}, {3.797175473535611*^9, 
   3.797175476043096*^9}, {3.797361538734376*^9, 3.797361546877021*^9}},
 CellLabel->
  "In[171]:=",ExpressionUUID->"8051bd3d-bdd4-4a96-bbdf-b1938f000fd9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"SetDirectory", "[", 
     RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{"\"\<../Notes_Peter/Graphics/MagnetizationZ_Vs_B-J_4-W_\>\"", "~~", 
       RowBox[{"ToString", "[", "WVal", "]"}], "~~", "\"\<-x_\>\"", "~~", 
       RowBox[{"ToString", "[", "xVal", "]"}], "~~", "\"\<.pdf\>\""}], ",", 
      " ", "plot1"}], "]"}]}], "*)"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.797175431938917*^9, 3.797175447492741*^9}, 
   3.79717568021587*^9, {3.797439168565961*^9, 
   3.797439170637067*^9}},ExpressionUUID->"0a19fa64-25b0-4252-9eb1-\
2bacd63fdbfe"],

Cell[BoxData[
 RowBox[{"plot1", "=", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"magZ", "[", 
      RowBox[{"B", ",", "1"}], "]"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"B", ",", "0", ",", "50"}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(M\), \(z\)]\)/\!\(\*SubscriptBox[\(\[Mu]\), \
\(B\)]\)\!\(\*SubscriptBox[\(g\), \(J\)]\)\>\"", ",", "\"\<\>\""}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"\"\<B (T)\>\"", ",", "\"\<\>\""}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", "\"\<Expressions\>\""}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.797102240765374*^9, 3.7971022487091293`*^9}, {
  3.797102326203043*^9, 3.797102327118113*^9}, {3.7971756571273203`*^9, 
  3.797175657766761*^9}, {3.79717606172987*^9, 3.79717606178377*^9}},
 CellLabel->
  "In[142]:=",ExpressionUUID->"17025b33-13d6-470e-952b-6ae0f1dfbfd0"],

Cell[BoxData[{
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{
   "\"\<../Notes_Peter/Graphics/MagnetizationZ_Vs_B-Larger_B-J_4-W_\>\"", "~~", 
    RowBox[{"ToString", "[", "WVal", "]"}], "~~", "\"\<-x_\>\"", "~~", 
    RowBox[{"ToString", "[", "xVal", "]"}], "~~", "\"\<.pdf\>\""}], ",", " ", 
   "plot1"}], "]"}]}], "Input",
 CellChangeTimes->{{3.797176072064929*^9, 3.797176080263286*^9}},
 CellLabel->
  "In[143]:=",ExpressionUUID->"2de6bd23-8707-400d-81ad-3e9257ec89d5"],

Cell["Susceptibility", "Text",
 CellChangeTimes->{{3.7971023556973143`*^9, 3.797102363156039*^9}},
 Background->GrayLevel[
  0.85],ExpressionUUID->"a8f800f6-75a4-40f9-adae-92994f5f0da2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BfieldVal", "=", "0.001"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"chiZ", "[", "Temp_", "]"}], ":=", 
   RowBox[{"gVal", "*", "\[Mu]BVal", "*", 
    RowBox[{
     RowBox[{"magZ", "[", 
      RowBox[{"BfieldVal", ",", "Temp"}], "]"}], "/", "BfieldVal"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.797097222219215*^9, 3.7970972662744427`*^9}, 
   3.7970973201114397`*^9, {3.7970975959393806`*^9, 3.79709765000082*^9}, {
   3.797100860125086*^9, 3.797100864221684*^9}},
 CellLabel->
  "In[176]:=",ExpressionUUID->"2fab7b7d-d09f-4bfc-b151-ba29ecdbab06"],

Cell[BoxData[
 RowBox[{"plot2", "=", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"chiZ", "[", "Temp", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"Temp", ",", "1", ",", "300"}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(\[Chi]\), \(z\)]\) for single ion (dimless)\
\>\"", ",", "\"\<\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<T (K)\>\"", ",", "\"\<\>\""}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.797097324961033*^9, 3.7970973499365063`*^9}, {
  3.7970977000898647`*^9, 3.797097720238015*^9}, {3.797102200890143*^9, 
  3.7971022180246077`*^9}, {3.797175717647236*^9, 3.797175746798649*^9}, {
  3.797175780248435*^9, 3.797175805534971*^9}},
 CellLabel->
  "In[178]:=",ExpressionUUID->"edc405fa-1d89-4769-863e-2187c8f2b13a"],

Cell[BoxData[
 RowBox[{"plot2", "=", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"chiZ", "[", "Temp", "]"}], "/", "gVal"}], "/", "\[Mu]BVal"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"Temp", ",", "1", ",", "300"}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(\[Chi]\), \(z\)]\)/(\!\(\*SubscriptBox[\(\
\[Mu]\), \(B\)]\)*\!\(\*SubscriptBox[\(g\), \(JLS\)]\)) for single ion \
(dimless)\>\"", ",", "\"\<\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<T (K)\>\"", ",", "\"\<\>\""}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7974395800298443`*^9, 3.797439600717285*^9}},
 CellLabel->
  "In[189]:=",ExpressionUUID->"a07c0519-6b82-424a-b5fd-f35f62a1a079"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"chiZ", "[", "15", "]"}], "/", "gVal"}], "/", 
  "\[Mu]BVal"}]], "Input",
 CellChangeTimes->{{3.797439044169868*^9, 3.797439050957301*^9}, 
   3.797439177797879*^9, {3.7974395592225723`*^9, 3.797439565965206*^9}},
 CellLabel->
  "In[182]:=",ExpressionUUID->"531d8889-781f-489e-9837-5833951a31e3"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"SetDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{"\"\<../Notes_Peter/Graphics/SusceptibilityZ_Vs_T-J_4-W_\>\"", "~~", 
      RowBox[{"ToString", "[", "WVal", "]"}], "~~", "\"\<-x_\>\"", "~~", 
      RowBox[{"ToString", "[", "xVal", "]"}], "~~", "\"\<.pdf\>\""}], ",", 
     " ", "plot2"}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.797175668046732*^9, 3.797175675846446*^9}, {
  3.797175740806499*^9, 3.797175740870315*^9}, {3.797175795871879*^9, 
  3.7971758018805428`*^9}, {3.7974390396532516`*^9, 
  3.7974390420978317`*^9}},ExpressionUUID->"4e6b3ca3-7307-4d3c-8bf9-\
373db779e589"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Mu]BVal", "^", "2"}], "*", 
  RowBox[{
   RowBox[{"gVal", "^", "2"}], "/", "kBVal"}], "*", "JVal", "*", 
  RowBox[{"(", 
   RowBox[{"JVal", "+", "1"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.797101238532258*^9, 3.797101276417392*^9}},
 CellLabel->
  "In[136]:=",ExpressionUUID->"92c99646-2fc7-41be-a66d-ac56a83fdb34"],

Cell[BoxData[
 RowBox[{"6", "*", 
  RowBox[{"10", "^", "23"}], "*", "40", "*", "5", "*", 
  RowBox[{"10", "^", 
   RowBox[{"(", 
    RowBox[{"-", "25"}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.797102178150481*^9, 3.7971021915664873`*^9}, 
   3.797102345961636*^9},ExpressionUUID->"95569e5b-4ab1-4bcc-ba84-\
13b25922780f"],

Cell["\<\
Check that I am getting the correct van-Vleck susceptibility in the low \
temperature limit. Important: this requires that the GS be the singlet and I \
need to use the energy splitting to the triplet with dipole moment 1/2. This \
depends on the choice of W and x and since these are randomly drawn, the two \
cells below may not work if the ground state is different or the triplet is \
not the first excited state (this occurs for x=-0.380623, for which I have \
checked my calculation). \
\>", "Text",
 CellChangeTimes->{{3.7970968647143*^9, 
  3.7970969933233213`*^9}},ExpressionUUID->"9014e7ef-24c2-4a7c-9156-\
b797b7b5ef0d"],

Cell[BoxData["xVal"], "Input",
 CellChangeTimes->{{3.79709697446278*^9, 
  3.797096998594058*^9}},ExpressionUUID->"88d63097-8e84-41c6-82ed-\
98b78e630779"],

Cell[BoxData[
 RowBox[{
  RowBox[{"kBVal", "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"gJLS", "[", 
      RowBox[{"JVal", ",", "LVal", ",", "SVal"}], "]"}], "*", "\[Mu]BVal"}], 
    ")"}]}], "*", 
  RowBox[{
   RowBox[{"magZ", "[", 
    RowBox[{"0.01", ",", "1"}], "]"}], "/", "0.01"}]}]], "Input",
 CellChangeTimes->{{3.797094020834476*^9, 3.797094048870845*^9}, {
   3.797094322261258*^9, 3.797094330128172*^9}, {3.797095454047832*^9, 
   3.797095460074473*^9}, {3.797095814642474*^9, 3.79709582333989*^9}, {
   3.7970960994682703`*^9, 3.797096101943779*^9}, {3.797096670767456*^9, 
   3.79709667394707*^9}, {3.7970967728621683`*^9, 3.797096783757464*^9}, {
   3.7970968329987707`*^9, 3.7970968382661257`*^9}, 3.7970974055264177`*^9},
 CellLabel->
  "In[123]:=",ExpressionUUID->"f223bc5a-653c-4ec4-858d-3745fbfd248f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"40", "/", "3"}], "/", 
  RowBox[{
   RowBox[{"Sort", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"esysB", "[", 
       RowBox[{"0", ",", "WVal", ",", "xVal"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "-", 
     RowBox[{"Min", "[", 
      RowBox[{
       RowBox[{"esysB", "[", 
        RowBox[{"0", ",", "WVal", ",", "xVal"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], "[", 
   RowBox[{"[", "2", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7970939979411287`*^9, 3.797094012980019*^9}, {
  3.797094075908804*^9, 3.7970940981513977`*^9}, {3.797095057281535*^9, 
  3.797095068934136*^9}, {3.797096117629939*^9, 3.797096142761301*^9}, {
  3.797096651072448*^9, 3.797096653110276*^9}},
 CellLabel->
  "In[107]:=",ExpressionUUID->"5c960c4d-edd7-447b-b3ea-a1e3a445cd47"],

Cell[BoxData[{
 RowBox[{"kBVal", "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"gJLS", "[", 
     RowBox[{"JVal", ",", "LVal", ",", "SVal"}], "]"}], "*", "\[Mu]BVal"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gJLS", "[", 
   RowBox[{"JVal", ",", "LVal", ",", "SVal"}], "]"}], "*", 
  "\[Mu]BVal"}]}], "Input",
 CellChangeTimes->{{3.797097448334342*^9, 3.7970974485314617`*^9}},
 CellLabel->
  "In[125]:=",ExpressionUUID->"e03ac346-7c29-4410-b608-a3ddc7099ada"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Magnetic field along x", "Subsubsection",
 CellChangeTimes->{{3.797091867319274*^9, 3.797091881074354*^9}, {
  3.797185074070167*^9, 
  3.797185074144825*^9}},ExpressionUUID->"4e39fea5-6c85-44dc-abdb-\
0e3ba1fa5598"],

Cell[BoxData[{"WVal", "\[IndentingNewLine]", "xVal"}], "Input",
 CellChangeTimes->{{3.7971866120877447`*^9, 3.7971866150453167`*^9}},
 CellLabel->
  "In[248]:=",ExpressionUUID->"4fef8d79-6593-47bf-9413-c2cdcd9ef909"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"hamBX", "[", 
    RowBox[{"Bfield_", ",", "W_", ",", "x_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"W", "*", 
      RowBox[{"ham", "[", "x", "]"}]}], "-", 
     RowBox[{
      RowBox[{"gJLS", "[", 
       RowBox[{"JVal", ",", "LVal", ",", "SVal"}], "]"}], "*", 
      RowBox[{"\[Mu]BVal", "/", "kBVal"}], "*", "JxOp", "*", "Bfield"}]}], "//",
     "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "//", "MatrixForm"}], ";"}]}], "Input",
 CellChangeTimes->{{3.797091064331895*^9, 3.797091128686928*^9}, {
   3.797091779730118*^9, 3.7970917978472*^9}, {3.797091844726115*^9, 
   3.797091903384541*^9}, {3.797092070896071*^9, 3.797092117997636*^9}, 
   3.797092233665975*^9, 3.797092273944283*^9, 3.797092316377521*^9, {
   3.7970925655526667`*^9, 3.797092576402527*^9}, 3.7970960542870407`*^9, {
   3.797185082118867*^9, 3.79718508495817*^9}, {3.79718662375134*^9, 
   3.797186648269558*^9}, {3.797186686390986*^9, 3.797186690149913*^9}},
 CellLabel->
  "In[250]:=",ExpressionUUID->"3a502131-a3e5-4106-8e85-82eb8507ce48"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"esysB", "[", 
     RowBox[{"Bfield_", ",", "W_", ",", "x_"}], "]"}], ":=", 
    RowBox[{"Eigensystem", "[", 
     RowBox[{"hamBX", "[", 
      RowBox[{"Bfield", ",", "W", ",", "x"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ZB", "[", 
    RowBox[{"Bfield_", ",", "Temp_"}], "]"}], ":=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"esysB", "[", 
            RowBox[{"Bfield", ",", "WVal", ",", "xVal"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "i"}], "]"}], "]"}], "-", 
          RowBox[{"Min", "[", 
           RowBox[{
            RowBox[{"esysB", "[", 
             RowBox[{"Bfield", ",", "WVal", ",", "xVal"}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ")"}]}], "/", "Temp"}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{
        RowBox[{"2", "*", "JVal"}], "+", "1"}]}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.797092303909333*^9, 3.7970924393080797`*^9}, {
   3.797092510287903*^9, 3.797092643733098*^9}, {3.797092711299571*^9, 
   3.797092721618252*^9}, {3.797093510139996*^9, 3.797093511284247*^9}, {
   3.7970955196946783`*^9, 3.7970955204649343`*^9}, 3.797096060624319*^9, 
   3.79718509215942*^9},
 CellLabel->
  "In[252]:=",ExpressionUUID->"1b82662d-05b5-47bb-96b6-d2dafd279e40"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"gJLS", "[", 
     RowBox[{"JVal", ",", "LVal", ",", "SVal"}], "]"}], "*", 
    RowBox[{"\[Mu]BVal", "/", "kBVal"}], "*", "JzOp", "*", "1"}], "//", 
   "MatrixForm"}], ";"}]], "Input",
 CellChangeTimes->{{3.797093677185074*^9, 3.797093697849971*^9}, 
   3.797096074448151*^9},
 CellLabel->
  "In[254]:=",ExpressionUUID->"c2fb3aec-e425-4441-8d42-287f683c43ac"],

Cell[BoxData[
 RowBox[{"plot2", "=", 
  RowBox[{"ListPlot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Sort", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"esysB", "[", 
          RowBox[{"0", ",", "WVal", ",", "xVal"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"esysB", "[", 
           RowBox[{"0", ",", "WVal", ",", "xVal"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"Sort", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"esysB", "[", 
          RowBox[{"2", ",", "WVal", ",", "xVal"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"esysB", "[", 
           RowBox[{"2", ",", "WVal", ",", "xVal"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"Sort", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"esysB", "[", 
          RowBox[{"10", ",", "WVal", ",", "xVal"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"esysB", "[", 
           RowBox[{"10", ",", "WVal", ",", "xVal"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(E\), \(i\)]\)(B)-\!\(\*SubscriptBox[\(E\), \
\(GS\)]\)(B)  (K)\>\"", ",", "\"\<\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<Eigenstate index i\>\"", ",", "\"\<\>\""}], "}"}]}], 
      "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{
       RowBox[{"Thickness", "[", "0.0025", "]"}], ",", 
       RowBox[{"FontSize", "\[Rule]", "14"}], ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "10"}], "}"}], ",", "Automatic"}], "}"}]}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"Placed", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<B=0\>\"", ",", " ", "\"\<B=2T\>\"", ",", " ", "\"\<B=10T\>\""}], 
        "}"}], ",", "Above"}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.796932106125465*^9, 3.7969321211145697`*^9}, {
  3.7969323689530487`*^9, 3.79693246184328*^9}, {3.797082708844481*^9, 
  3.797082715042218*^9}, {3.797093396870356*^9, 3.797093485958498*^9}, {
  3.7970935339539137`*^9, 3.7970935359882793`*^9}, {3.797093579643457*^9, 
  3.7970936548623457`*^9}, {3.797169953529686*^9, 3.797169955241962*^9}, {
  3.797174143877552*^9, 3.797174266324847*^9}, {3.797174337222294*^9, 
  3.797174408549038*^9}, {3.7971747544643507`*^9, 3.797174755661996*^9}, {
  3.797174889948656*^9, 3.7971749084621964`*^9}, {3.7971752315373096`*^9, 
  3.797175271894486*^9}, {3.7971867368688593`*^9, 3.797186736926545*^9}},
 CellLabel->
  "In[255]:=",ExpressionUUID->"6d1fba2a-136b-4968-a034-10e0ab57621a"],

Cell[BoxData[{
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"\"\<../Notes_Peter/Graphics/Spectrum_Vs_BX-J_4-W_\>\"", "~~", 
    RowBox[{"ToString", "[", "WVal", "]"}], "~~", "\"\<-x_\>\"", "~~", 
    RowBox[{"ToString", "[", "xVal", "]"}], "~~", "\"\<.pdf\>\""}], ",", " ", 
   "plot1"}], "]"}]}], "Input",
 CellChangeTimes->{{3.797174417004724*^9, 3.797174418884845*^9}, 
   3.797185135503376*^9},
 CellLabel->
  "In[151]:=",ExpressionUUID->"b980efd1-41ca-4fa9-871b-908de7981c76"],

Cell[BoxData[{
 RowBox[{"WVal", "*", 
  RowBox[{
   RowBox[{"esys", "[", "xVal", "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Conjugate", "[", 
      RowBox[{
       RowBox[{"esys", "[", "xVal", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "i"}], "]"}], "]"}], "]"}], ".", "JzOp", ".", 
     RowBox[{
      RowBox[{"esys", "[", "xVal", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "i"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{
       RowBox[{"2", "*", "JVal"}], "+", "1"}]}], "}"}]}], "]"}], "//", 
  "Chop"}]}], "Input",
 CellChangeTimes->{{3.797093190611351*^9, 3.7970932180792503`*^9}, {
  3.797093253296327*^9, 3.797093316758301*^9}, {3.7970935596895037`*^9, 
  3.7970935609004803`*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"7a9168cb-5f66-4936-b7d2-4e01a3ddfe98"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"esys", "[", "xVal", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "i"}], "]"}], "]"}], ".", "JzOp", ".", 
     RowBox[{
      RowBox[{"esys", "[", "xVal", "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{
       RowBox[{"2", "*", "JVal"}], "+", "1"}]}], "}"}]}], "]"}], "//", 
  "Chop"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sqrt", "[", 
   RowBox[{"20", "/", "3"}], "]"}], "//", "N"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"energies", "[", 
   RowBox[{"[", "5", "]"}], "]"}], "-", 
  RowBox[{"energies", "[", 
   RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"40", "/", "3"}], "/", "%"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.797095088111053*^9, 3.797095183295354*^9}, {
  3.797095282764439*^9, 3.7970953628113117`*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"4f89cfce-3337-46a5-b4e5-ec537ae6f9ca"],

Cell["Magnetization in finite field", "Text",
 CellChangeTimes->{{3.79709245886586*^9, 3.7970924678399563`*^9}, {
  3.797097004106513*^9, 3.797097006350685*^9}, {3.797102404987516*^9, 
  3.79710240569556*^9}},
 Background->GrayLevel[
  0.85],ExpressionUUID->"74aba51d-9146-4fdd-9baf-cdd5161044f5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"magX", "[", 
    RowBox[{"Bfield_", ",", "Temp_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"ZB", "[", 
      RowBox[{"Bfield", ",", "Temp"}], "]"}]}], "*", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Conjugate", "[", 
         RowBox[{
          RowBox[{"esysB", "[", 
           RowBox[{"Bfield", ",", "WVal", ",", "xVal"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "i"}], "]"}], "]"}], "]"}], ".", "JxOp", ".", 
        RowBox[{
         RowBox[{"esysB", "[", 
          RowBox[{"Bfield", ",", "WVal", ",", "xVal"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "i"}], "]"}], "]"}]}], " ", "*", 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"esysB", "[", 
              RowBox[{"Bfield", ",", "WVal", ",", "xVal"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "i"}], "]"}], "]"}], "-", 
            RowBox[{"Min", "[", 
             RowBox[{
              RowBox[{"esysB", "[", 
               RowBox[{"Bfield", ",", "WVal", ",", "xVal"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ")"}]}], "/", "Temp"}],
         "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{
         RowBox[{"2", "*", "JVal"}], "+", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.797092468495714*^9, 3.79709250035081*^9}, {
   3.797092651331514*^9, 3.7970927961129827`*^9}, {3.797095445201747*^9, 
   3.797095449037384*^9}, {3.7970958842573023`*^9, 3.797095891615671*^9}, 
   3.797095978403713*^9, 3.7970972689182568`*^9, {3.797185147207944*^9, 
   3.79718514739859*^9}, {3.7971852408480387`*^9, 3.797185241006818*^9}},
 CellLabel->
  "In[257]:=",ExpressionUUID->"1e105a6a-f581-4f70-bdd7-0064e6ed05ff"],

Cell[BoxData[
 RowBox[{"plot1", "=", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"magX", "[", 
       RowBox[{"B", ",", "1"}], "]"}], ",", 
      RowBox[{"magX", "[", 
       RowBox[{"B", ",", "50"}], "]"}], ",", 
      RowBox[{"magX", "[", 
       RowBox[{"B", ",", "100"}], "]"}], ",", 
      RowBox[{"magX", "[", 
       RowBox[{"B", ",", "300"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"B", ",", "0", ",", "10"}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(M\), \
\(x\)]\)/(\!\(\*SubscriptBox[\(\[Mu]\), \(B\)]\)\!\(\*SubscriptBox[\(g\), \(J\
\)]\))\>\"", ",", "\"\<\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<B (T)\>\"", ",", "\"\<\>\""}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"Placed", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<T=1K\>\"", ",", "\"\<T=50K\>\"", ",", "\"\<T=100K\>\"", ",", 
         "\"\<T=300K\>\""}], "}"}], ",", "Above"}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.79709279725414*^9, 3.79709283037326*^9}, {
   3.797092895029755*^9, 3.797092895446526*^9}, 3.7970937485300703`*^9, {
   3.797097011149433*^9, 3.797097025966505*^9}, {3.797097104784625*^9, 
   3.797097120523793*^9}, {3.797097153877613*^9, 3.797097162955976*^9}, {
   3.797097216753148*^9, 3.7970972202747927`*^9}, {3.797097279270802*^9, 
   3.797097283677964*^9}, {3.797097540282523*^9, 3.797097575449111*^9}, {
   3.797175376143649*^9, 3.797175425518318*^9}, {3.797175473535611*^9, 
   3.797175476043096*^9}, {3.797185149688875*^9, 3.797185155846217*^9}, {
   3.7971852332791233`*^9, 3.797185237918827*^9}},
 CellLabel->
  "In[258]:=",ExpressionUUID->"07874b93-2c9b-4f12-8e2b-ef4209e5e507"],

Cell[BoxData[{
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"\"\<../Notes_Peter/Graphics/MagnetizationX_Vs_B-J_4-W_\>\"", "~~", 
    RowBox[{"ToString", "[", "WVal", "]"}], "~~", "\"\<-x_\>\"", "~~", 
    RowBox[{"ToString", "[", "xVal", "]"}], "~~", "\"\<.pdf\>\""}], ",", " ", 
   "plot1"}], "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.797175431938917*^9, 3.797175447492741*^9}, 
   3.79717568021587*^9, {3.7971852547672586`*^9, 
   3.7971852549743967`*^9}},ExpressionUUID->"3ad3e312-dd34-4654-ba20-\
6f378b9c7aec"],

Cell[BoxData[
 RowBox[{"plot1", "=", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"magX", "[", 
      RowBox[{"B", ",", "1"}], "]"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"B", ",", "0", ",", "50"}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(M\), \(x\)]\)/\!\(\*SubscriptBox[\(\[Mu]\), \
\(B\)]\)\!\(\*SubscriptBox[\(g\), \(J\)]\)\>\"", ",", "\"\<\>\""}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"\"\<B (T)\>\"", ",", "\"\<\>\""}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotLegends", "\[Rule]", "\"\<Expressions\>\""}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.797102240765374*^9, 3.7971022487091293`*^9}, {
  3.797102326203043*^9, 3.797102327118113*^9}, {3.7971756571273203`*^9, 
  3.797175657766761*^9}, {3.79717606172987*^9, 3.79717606178377*^9}, {
  3.7971852616157084`*^9, 
  3.797185264606319*^9}},ExpressionUUID->"d959e63f-2707-4004-baf0-\
b249bc1d6e2a"],

Cell[BoxData[{
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{
   "\"\<../Notes_Peter/Graphics/MagnetizationX_Vs_B-Larger_B-J_4-W_\>\"", "~~", 
    RowBox[{"ToString", "[", "WVal", "]"}], "~~", "\"\<-x_\>\"", "~~", 
    RowBox[{"ToString", "[", "xVal", "]"}], "~~", "\"\<.pdf\>\""}], ",", " ", 
   "plot1"}], "]"}]}], "Input",
 CellChangeTimes->{{3.797176072064929*^9, 3.797176080263286*^9}, 
   3.797185269319586*^9},ExpressionUUID->"f0257d01-0fb2-4288-96dd-\
a1cfb0b76d19"],

Cell["Susceptibility", "Text",
 CellChangeTimes->{{3.7971023556973143`*^9, 3.797102363156039*^9}},
 Background->GrayLevel[
  0.85],ExpressionUUID->"3ae9dfda-8b74-4de3-8829-7c484b1458b1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BfieldVal", "=", "0.001"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"chiX", "[", "Temp_", "]"}], ":=", 
   RowBox[{"gVal", "*", "\[Mu]BVal", "*", 
    RowBox[{
     RowBox[{"magX", "[", 
      RowBox[{"BfieldVal", ",", "Temp"}], "]"}], "/", "BfieldVal"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.797097222219215*^9, 3.7970972662744427`*^9}, 
   3.7970973201114397`*^9, {3.7970975959393806`*^9, 3.79709765000082*^9}, {
   3.797100860125086*^9, 3.797100864221684*^9}, {3.797185275007655*^9, 
   3.797185277334392*^9}},ExpressionUUID->"9a8a9628-9b30-4676-8f6f-\
afd5c5e72d49"],

Cell[BoxData[
 RowBox[{"plot2", "=", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{"chiX", "[", "Temp", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"Temp", ",", "1", ",", "300"}], "}"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<\!\(\*SubscriptBox[\(\[Chi]\), \(x\)]\) for single ion (dimless)\
\>\"", ",", "\"\<\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<T (K)\>\"", ",", "\"\<\>\""}], "}"}]}], "}"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.797097324961033*^9, 3.7970973499365063`*^9}, {
  3.7970977000898647`*^9, 3.797097720238015*^9}, {3.797102200890143*^9, 
  3.7971022180246077`*^9}, {3.797175717647236*^9, 3.797175746798649*^9}, {
  3.797175780248435*^9, 3.797175805534971*^9}, {3.797185279358679*^9, 
  3.797185283190592*^9}},ExpressionUUID->"a9b4b730-436a-413a-91cd-\
abc3fa0ecf62"],

Cell[BoxData[{
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"\"\<../Notes_Peter/Graphics/SusceptibilityX_Vs_T-J_4-W_\>\"", "~~", 
    RowBox[{"ToString", "[", "WVal", "]"}], "~~", "\"\<-x_\>\"", "~~", 
    RowBox[{"ToString", "[", "xVal", "]"}], "~~", "\"\<.pdf\>\""}], ",", " ", 
   "plot2"}], "]"}]}], "Input",
 CellChangeTimes->{{3.797175668046732*^9, 3.797175675846446*^9}, {
  3.797175740806499*^9, 3.797175740870315*^9}, {3.797175795871879*^9, 
  3.7971758018805428`*^9}, {3.79718528729462*^9, 
  3.797185287462672*^9}},ExpressionUUID->"b5081da6-f3b6-4414-9e47-\
88a94173a17f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Mu]BVal", "^", "2"}], "*", 
  RowBox[{
   RowBox[{"gVal", "^", "2"}], "/", "kBVal"}], "*", "JVal", "*", 
  RowBox[{"(", 
   RowBox[{"JVal", "+", "1"}], ")"}]}]], "Input",
 CellChangeTimes->{{3.797101238532258*^9, 3.797101276417392*^9}},
 CellLabel->
  "In[136]:=",ExpressionUUID->"77083307-a522-45cf-b6f1-99b3cb243294"],

Cell[BoxData[
 RowBox[{"6", "*", 
  RowBox[{"10", "^", "23"}], "*", "40", "*", "5", "*", 
  RowBox[{"10", "^", 
   RowBox[{"(", 
    RowBox[{"-", "25"}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.797102178150481*^9, 3.7971021915664873`*^9}, 
   3.797102345961636*^9},ExpressionUUID->"4f41b6f3-2649-4c28-baf0-\
13b376647f93"],

Cell["\<\
Check that I am getting the correct van-Vleck susceptibility in the low \
temperature limit. Important: this requires that the GS be the singlet and I \
need to use the energy splitting to the triplet with dipole moment 1/2. This \
depends on the choice of W and x and since these are randomly drawn, the two \
cells below may not work if the ground state is different or the triplet is \
not the first excited state (this occurs for x=-0.380623, for which I have \
checked my calculation). \
\>", "Text",
 CellChangeTimes->{{3.7970968647143*^9, 
  3.7970969933233213`*^9}},ExpressionUUID->"fc3dc837-9c39-4a67-985d-\
92e6b9b0a764"],

Cell[BoxData["xVal"], "Input",
 CellChangeTimes->{{3.79709697446278*^9, 
  3.797096998594058*^9}},ExpressionUUID->"8846210a-18d7-4b7e-92ab-\
40e259e68319"],

Cell[BoxData[
 RowBox[{
  RowBox[{"kBVal", "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"gJLS", "[", 
      RowBox[{"JVal", ",", "LVal", ",", "SVal"}], "]"}], "*", "\[Mu]BVal"}], 
    ")"}]}], "*", 
  RowBox[{
   RowBox[{"magZ", "[", 
    RowBox[{"0.01", ",", "1"}], "]"}], "/", "0.01"}]}]], "Input",
 CellChangeTimes->{{3.797094020834476*^9, 3.797094048870845*^9}, {
   3.797094322261258*^9, 3.797094330128172*^9}, {3.797095454047832*^9, 
   3.797095460074473*^9}, {3.797095814642474*^9, 3.79709582333989*^9}, {
   3.7970960994682703`*^9, 3.797096101943779*^9}, {3.797096670767456*^9, 
   3.79709667394707*^9}, {3.7970967728621683`*^9, 3.797096783757464*^9}, {
   3.7970968329987707`*^9, 3.7970968382661257`*^9}, 3.7970974055264177`*^9},
 CellLabel->
  "In[123]:=",ExpressionUUID->"428e06d1-7b52-4928-ace8-8e7de2c7545f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"40", "/", "3"}], "/", 
  RowBox[{
   RowBox[{"Sort", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"esysB", "[", 
       RowBox[{"0", ",", "WVal", ",", "xVal"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "-", 
     RowBox[{"Min", "[", 
      RowBox[{
       RowBox[{"esysB", "[", 
        RowBox[{"0", ",", "WVal", ",", "xVal"}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], "[", 
   RowBox[{"[", "2", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7970939979411287`*^9, 3.797094012980019*^9}, {
  3.797094075908804*^9, 3.7970940981513977`*^9}, {3.797095057281535*^9, 
  3.797095068934136*^9}, {3.797096117629939*^9, 3.797096142761301*^9}, {
  3.797096651072448*^9, 3.797096653110276*^9}},
 CellLabel->
  "In[107]:=",ExpressionUUID->"c8ed82f0-f205-485c-b869-3795a5f80565"],

Cell[BoxData[{
 RowBox[{"kBVal", "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"gJLS", "[", 
     RowBox[{"JVal", ",", "LVal", ",", "SVal"}], "]"}], "*", "\[Mu]BVal"}], 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gJLS", "[", 
   RowBox[{"JVal", ",", "LVal", ",", "SVal"}], "]"}], "*", 
  "\[Mu]BVal"}]}], "Input",
 CellChangeTimes->{{3.797097448334342*^9, 3.7970974485314617`*^9}},
 CellLabel->
  "In[125]:=",ExpressionUUID->"2c4a00c3-ad3c-4501-b962-b8c5a6dde77b"]
}, Closed]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1263, 1314},
WindowMargins->{{Automatic, 51}, {Automatic, 0}},
Magnification:>1.25 Inherited,
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 247, 4, 37, "Input",ExpressionUUID->"b6889cbf-092d-4631-b0b0-83a81301ce86"],
Cell[CellGroupData[{
Cell[830, 28, 404, 11, 85, "Section",ExpressionUUID->"a9bf1534-f8b6-4fd8-961f-1ae775dca244"],
Cell[1237, 41, 391, 10, 37, "Input",ExpressionUUID->"2470a8b0-ea07-49ea-8b21-5dd21cc2a654"],
Cell[1631, 53, 268, 5, 37, "Input",ExpressionUUID->"396db1b6-ec94-486b-a29f-b3144caca921"],
Cell[CellGroupData[{
Cell[1924, 62, 205, 3, 67, "Subsection",ExpressionUUID->"78f1aeb3-4212-42f4-9f21-c29dbe185c99"],
Cell[2132, 67, 668, 17, 105, "Text",ExpressionUUID->"eca34ae6-895b-4e8e-ae54-e257409d1a43"],
Cell[2803, 86, 483, 10, 90, "Input",ExpressionUUID->"2f78e5f5-c5a5-4096-b88d-9f5604609452"],
Cell[3289, 98, 604, 10, 37, "Input",ExpressionUUID->"12083657-6ffa-4efc-a749-b212db2ef916"],
Cell[3896, 110, 536, 14, 37, "Input",ExpressionUUID->"18a60e99-f3ee-40fb-b8e3-34047c0c6a99"],
Cell[4435, 126, 702, 20, 37, "Input",ExpressionUUID->"383d0bba-95b6-4743-8145-f4376bc054b4"],
Cell[5140, 148, 613, 14, 142, "Input",ExpressionUUID->"faa33a26-6d45-4bca-9019-bbba1ac77858"],
Cell[5756, 164, 375, 7, 58, "Input",ExpressionUUID->"abf59614-5503-48b4-9a3a-00726c900e47"]
}, Closed]],
Cell[CellGroupData[{
Cell[6168, 176, 273, 6, 46, "Subsection",ExpressionUUID->"e39a8fd0-b244-4e32-b758-b7c5bd66e8b9"],
Cell[6444, 184, 331, 7, 93, "Text",ExpressionUUID->"1db26ad8-394b-445e-b180-af76e4a63258"],
Cell[6778, 193, 511, 11, 90, "Input",ExpressionUUID->"4851e210-e511-40e2-85bf-6c93821ac2b4"],
Cell[7292, 206, 1775, 54, 168, "Input",ExpressionUUID->"c721a359-c6e6-4c3d-95fc-086410efe36d"],
Cell[9070, 262, 383, 8, 73, "Text",ExpressionUUID->"85ec11e7-a484-4688-81fe-0810ec4d12e3"],
Cell[9456, 272, 1775, 47, 142, "Input",ExpressionUUID->"df6a1337-8777-4083-af04-a43c1c3f9621"],
Cell[11234, 321, 347, 7, 37, "Input",ExpressionUUID->"fd74fb8c-a046-4640-8808-c34dbf028d2f"],
Cell[11584, 330, 339, 7, 44, "Text",ExpressionUUID->"45e7827b-9760-4f7f-8a0d-e47b74838b75"],
Cell[11926, 339, 551, 13, 64, "Input",ExpressionUUID->"55c58caf-8e15-4b78-9d5b-e957ada6a72b"],
Cell[12480, 354, 715, 12, 102, "Text",ExpressionUUID->"cfd8cee3-1c14-4ca9-840f-6067ddb0b019"],
Cell[13198, 368, 1054, 30, 90, "Input",ExpressionUUID->"837c2359-fd69-4b0e-a80b-a5fc29e1799d"],
Cell[14255, 400, 847, 15, 131, "Text",ExpressionUUID->"590f09c2-238d-4b7e-875b-5eb04d45ed0f"],
Cell[15105, 417, 219, 5, 37, "Input",ExpressionUUID->"c61dff08-a760-41c2-b529-f7002dec7a3c"],
Cell[15327, 424, 1959, 58, 130, "Text",ExpressionUUID->"3073a13e-b68b-49ea-8733-dc7cb6706652"],
Cell[17289, 484, 3394, 99, 220, "Input",ExpressionUUID->"a40fcd0c-cadc-476c-bb48-84905773cac6"],
Cell[20686, 585, 380, 10, 37, "Input",ExpressionUUID->"a8110a6b-b666-429f-b2b5-f31f73e9ce9b"],
Cell[21069, 597, 430, 10, 116, "Input",ExpressionUUID->"a100a6a7-a295-427f-a971-7069b3cf8260"],
Cell[21502, 609, 1340, 34, 116, "Input",ExpressionUUID->"55e8b138-4db9-4593-8e6d-0b979711a784"],
Cell[22845, 645, 596, 10, 73, "Text",ExpressionUUID->"7fde4379-68e9-460d-a95a-266c400787eb"],
Cell[23444, 657, 666, 16, 90, "Input",ExpressionUUID->"42ed261e-dcc6-4563-8bb0-529dadeff9db"],
Cell[24113, 675, 655, 17, 116, "Input",ExpressionUUID->"76f27a93-c841-4aa2-af7e-ef4540034b08"],
Cell[24771, 694, 308, 7, 73, "Text",ExpressionUUID->"ea2561a0-f991-427e-b849-efe728360e78"],
Cell[25082, 703, 3511, 104, 220, "Input",ExpressionUUID->"83dd25c2-9136-4679-9b76-e9e8a41bd96d"],
Cell[28596, 809, 840, 14, 159, "Text",ExpressionUUID->"2fc83329-0f64-4e71-ae90-91a59644c6c2"],
Cell[29439, 825, 1826, 49, 194, "Input",ExpressionUUID->"dbf2346c-eb06-4307-afd7-3e13b05b7417"]
}, Closed]],
Cell[CellGroupData[{
Cell[31302, 879, 262, 4, 46, "Subsection",ExpressionUUID->"3bcc91e8-5c47-4d37-a073-123fd4eedd5c"],
Cell[31567, 885, 492, 9, 37, "Input",ExpressionUUID->"3c71171a-6771-4655-a1f1-69b4df9d23ba"],
Cell[CellGroupData[{
Cell[32084, 898, 286, 6, 56, "Subsubsection",ExpressionUUID->"c61ff541-c6d2-4279-9687-2b592c633c46"],
Cell[32373, 906, 175, 3, 44, "Text",ExpressionUUID->"483999b9-f0fa-42cb-84c8-b1d66236d60b"],
Cell[32551, 911, 2401, 65, 168, "Input",ExpressionUUID->"e6f4001b-631e-455f-835e-da77c27e06d3"],
Cell[34955, 978, 441, 11, 37, "Input",ExpressionUUID->"5ec537de-fa30-414a-8d24-52a99acc3e8e"],
Cell[35399, 991, 247, 4, 44, "Text",ExpressionUUID->"0965468b-f227-4876-bc28-aabe7b4d12ca"],
Cell[35649, 997, 1252, 30, 64, "Input",ExpressionUUID->"28c76200-b54d-4dd3-aa3c-fcc0ef7db570"],
Cell[36904, 1029, 633, 15, 90, "Input",ExpressionUUID->"f44afcea-a7a9-41c4-bf2e-812848adcbd4"],
Cell[37540, 1046, 307, 7, 44, "Text",ExpressionUUID->"a517d524-78b4-4d22-934a-06a871ec2b72"],
Cell[37850, 1055, 999, 25, 116, "Input",ExpressionUUID->"e9180422-2dd7-4e31-b120-c849635d2c3f"],
Cell[38852, 1082, 177, 3, 37, "Input",ExpressionUUID->"09fdfc84-b9fa-4bce-8cb4-56add991d900"],
Cell[39032, 1087, 999, 16, 217, "Text",ExpressionUUID->"acfe5f00-43c9-401f-af7d-b012f7c866da"],
Cell[40034, 1105, 447, 9, 37, "Input",ExpressionUUID->"2af1a664-9088-4a3a-91f7-442263963528"],
Cell[40484, 1116, 1626, 50, 220, "Input",ExpressionUUID->"da0b62aa-79b3-48c5-b8b6-bc29b0de1b53"],
Cell[42113, 1168, 596, 17, 64, "Input",ExpressionUUID->"cba7878b-ba1e-4e70-9452-5e56f6c87994"],
Cell[42712, 1187, 499, 12, 37, "Input",ExpressionUUID->"f90de261-ec60-4e83-abe9-fab3c95790dd"],
Cell[43214, 1201, 833, 20, 64, "Input",ExpressionUUID->"39092391-3ec3-45e3-9e23-dca1961ba91b"],
Cell[44050, 1223, 278, 5, 37, "Input",ExpressionUUID->"ee0d5c09-e3dc-49a6-90f0-512d3412b65d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44365, 1233, 218, 4, 56, "Subsubsection",ExpressionUUID->"fb181d3d-1003-4a7d-b1bd-e4a844e0bedf"],
Cell[44586, 1239, 1209, 34, 142, "Input",ExpressionUUID->"709c17e3-fe44-4ba6-bb73-aeed8dfedfb8"],
Cell[45798, 1275, 147, 3, 64, "Input",ExpressionUUID->"f67574d1-7b9b-4d10-9fc9-abeace37b21e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45982, 1283, 502, 12, 57, "Subsubsection",ExpressionUUID->"a32fda8e-ab15-48b0-80b4-d37b91b2f0b8"],
Cell[46487, 1297, 570, 13, 102, "Text",ExpressionUUID->"fdf51dde-b84b-426c-85a8-e1d6b5278bd7"],
Cell[47060, 1312, 112, 2, 37, "Input",ExpressionUUID->"3a7a1e1e-e1b5-43b8-8b08-0ce6e74065c5"],
Cell[47175, 1316, 2488, 59, 142, "Input",ExpressionUUID->"bef15d7b-dc02-4239-b32a-cb9093cc7403"],
Cell[49666, 1377, 1309, 34, 90, "Input",ExpressionUUID->"f4f8bb26-429e-4542-ad5b-3e9b5b8083e9"],
Cell[50978, 1413, 497, 12, 90, "Input",ExpressionUUID->"442690f6-2454-4601-9495-97a7aeef30b0"],
Cell[51478, 1427, 565, 10, 102, "Text",ExpressionUUID->"55867764-e697-4a4d-9465-08dd15478763"],
Cell[52046, 1439, 698, 19, 90, "Input",ExpressionUUID->"8784ba65-d682-46d8-b4f1-85a9534332e4"],
Cell[52747, 1460, 4867, 138, 376, "Input",ExpressionUUID->"5e780ecb-51a7-4f56-87bd-96b0cefe1520"],
Cell[57617, 1600, 4649, 138, 402, "Input",ExpressionUUID->"35513c7d-c419-414e-a241-f6949af47912"],
Cell[62269, 1740, 1083, 28, 64, "Input",ExpressionUUID->"86f66e92-9726-4a72-99c3-a402a13ed8a5"],
Cell[63355, 1770, 1396, 32, 90, "Input",ExpressionUUID->"d91792ff-d688-44c2-b21c-ea2fb13d9511"],
Cell[64754, 1804, 587, 12, 64, "Input",ExpressionUUID->"5216f837-c289-4f89-a021-23ed05120aa1"],
Cell[65344, 1818, 2542, 70, 194, "Input",ExpressionUUID->"02b5ccab-d826-4c25-9715-799b4950e905"],
Cell[67889, 1890, 2647, 88, 324, "Input",ExpressionUUID->"ddb1dedc-3ddc-4f84-b582-165c1049b110"],
Cell[70539, 1980, 453, 8, 73, "Text",ExpressionUUID->"09ca0625-0482-49ae-9f85-e9b4b1a99bcc"],
Cell[70995, 1990, 381, 11, 37, "Input",ExpressionUUID->"0ab12f6b-1528-4eb2-84a3-2594faae88c4"],
Cell[71379, 2003, 2933, 79, 194, "Input",ExpressionUUID->"242a30e4-11a6-4cf0-b301-75b21155017f"],
Cell[74315, 2084, 577, 13, 90, "Input",ExpressionUUID->"a7ef5b45-b265-46b8-9b5f-0fd58b55199a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[74929, 2102, 199, 3, 56, "Subsubsection",ExpressionUUID->"32864a20-a379-4b59-aaa3-613288c98379"],
Cell[75131, 2107, 373, 8, 73, "Text",ExpressionUUID->"ae086a8b-b81f-40f0-a613-69ae6de3af84"],
Cell[75507, 2117, 1152, 36, 90, "Input",ExpressionUUID->"f903e549-e6d5-4adb-b603-16d8f5b327e5"],
Cell[76662, 2155, 412, 8, 67, "Text",ExpressionUUID->"f2ded8f6-52cf-4733-b25a-2c93f56ae18f"],
Cell[77077, 2165, 287, 7, 37, "Input",ExpressionUUID->"84a6fea8-79e4-479c-a690-843c6422308c"],
Cell[77367, 2174, 553, 13, 31, "Input",ExpressionUUID->"ec512b74-b1de-4423-97e0-a8a7b8b3795f"],
Cell[77923, 2189, 735, 19, 37, "Input",ExpressionUUID->"06db0f84-c1da-4013-849f-54ba42c0f41a"],
Cell[78661, 2210, 149, 3, 64, "Input",ExpressionUUID->"eb1c0d09-4942-4a44-b04c-543fe8161f3e"],
Cell[78813, 2215, 1271, 25, 37, "Input",ExpressionUUID->"ee882c64-9da0-4ca2-a7af-6ada4bc7eae2"],
Cell[80087, 2242, 326, 8, 102, "Text",ExpressionUUID->"44223311-3a23-4bdf-bec0-45b787cb3ad4"],
Cell[80416, 2252, 339, 7, 37, "Input",ExpressionUUID->"3d724e9d-5d01-467c-9b47-4558963b8f05"],
Cell[80758, 2261, 197, 3, 44, "Text",ExpressionUUID->"46ad4d26-d9cd-497b-b08c-13229acf8029"],
Cell[80958, 2266, 283, 7, 37, "Input",ExpressionUUID->"6c78a36d-489d-433a-82f3-1e4d92faf908"],
Cell[81244, 2275, 479, 9, 102, "Text",ExpressionUUID->"8d847b42-d0a4-4881-a4fe-46d3aa345b27"],
Cell[81726, 2286, 1377, 35, 168, "Input",ExpressionUUID->"241418ca-1882-4cf6-a702-683e3d005bc3"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[83164, 2328, 406, 12, 85, "Section",ExpressionUUID->"86f40345-9a84-4b0c-b55a-eed63958a67a"],
Cell[83573, 2342, 694, 12, 102, "Text",ExpressionUUID->"30f55759-10c3-4a8b-8e65-30e4b02f008c"],
Cell[84270, 2356, 764, 19, 116, "Input",ExpressionUUID->"b67349fc-ade4-4baf-8b8f-762bd88f85ac"],
Cell[CellGroupData[{
Cell[85059, 2379, 277, 4, 67, "Subsection",ExpressionUUID->"24eb721b-e39b-41e3-aab5-a754030f7e28"],
Cell[85339, 2385, 437, 10, 37, "Input",ExpressionUUID->"2e57baf6-f970-4ad0-8f71-d868068ab8a3"],
Cell[85779, 2397, 314, 7, 37, "Input",ExpressionUUID->"04b14a7b-1876-442a-8a30-c3ed730bcadb"],
Cell[86096, 2406, 682, 22, 44, "Text",ExpressionUUID->"850b6140-30c9-4406-b9bd-124362fdc1b1"],
Cell[86781, 2430, 1559, 40, 142, "Input",ExpressionUUID->"47f0162e-7eac-4b39-97b7-3515ad0a5914"],
Cell[88343, 2472, 2524, 59, 142, "Input",ExpressionUUID->"2eb8093b-d183-47e7-b0c3-ec0923aebcd0"],
Cell[90870, 2533, 694, 18, 90, "Input",ExpressionUUID->"6d6eb012-3e61-4378-aecd-1d8475aa514e"],
Cell[91567, 2553, 1279, 28, 64, "Input",ExpressionUUID->"71cc245c-35c2-43bb-87a0-16ebfe0ab91d"],
Cell[92849, 2583, 1334, 31, 90, "Input",ExpressionUUID->"4018c797-0f0e-41ed-b5b0-1e6f2c73f1c9"],
Cell[94186, 2616, 281, 6, 37, "Input",ExpressionUUID->"df212735-f391-461d-943e-26c4b2df4626"],
Cell[94470, 2624, 433, 13, 47, "Text",ExpressionUUID->"be023d4b-db9b-4cfa-8d54-4ce11da5f624"],
Cell[94906, 2639, 4273, 115, 350, "Input",ExpressionUUID->"85e3d053-5979-4abf-85d6-aa5501cdf7d0"],
Cell[99182, 2756, 859, 23, 73, "Text",ExpressionUUID->"95ab0dd5-0639-439e-95bf-2cc13d73c305"],
Cell[100044, 2781, 2296, 62, 220, "Input",ExpressionUUID->"26ddbd90-7f55-43a3-bbd2-33a5d953db37"],
Cell[102343, 2845, 225, 5, 44, "Text",ExpressionUUID->"09d435c6-bf67-4797-98ed-e5bc1d38c012"],
Cell[102571, 2852, 2487, 51, 220, "Input",ExpressionUUID->"e50cca83-c1b7-4285-a08f-55a87b80e864"],
Cell[105061, 2905, 222, 5, 44, "Text",ExpressionUUID->"f23043ab-4569-4b66-a489-c56d42c53d3b"],
Cell[105286, 2912, 6962, 167, 1000, "Input",ExpressionUUID->"83516c46-f2b5-4d93-b875-6628579d1543"],
Cell[112251, 3081, 227, 5, 44, "Text",ExpressionUUID->"24a0df4a-bb3f-436a-adf8-fb315d303b15"],
Cell[112481, 3088, 1530, 35, 64, "Input",ExpressionUUID->"dd3efdaf-7d7c-4cdd-b8a7-b7321f6e44eb"],
Cell[114014, 3125, 456, 11, 90, "Input",ExpressionUUID->"1efeba03-4185-4ba0-9516-da3f6acc4ce5"],
Cell[114473, 3138, 424, 8, 73, "Text",ExpressionUUID->"29d8fce6-b9ea-44d7-b2ee-ad28ced3e224"],
Cell[114900, 3148, 426, 8, 64, "Input",ExpressionUUID->"63ec70f2-7af0-4d8c-9f6e-b5f2d6a04fc6"],
Cell[115329, 3158, 1241, 35, 116, "Input",ExpressionUUID->"6122f8b9-408b-4a3f-a98c-5e140ad66e76"],
Cell[116573, 3195, 660, 16, 37, "Input",ExpressionUUID->"7f5a2018-3955-40e9-af99-57d14b491eae"],
Cell[117236, 3213, 196, 3, 44, "Text",ExpressionUUID->"36cb6760-da0b-4efe-b90b-82fec91ad3e2"],
Cell[117435, 3218, 947, 26, 64, "Input",ExpressionUUID->"de0ea3f8-2690-44f3-9a4b-461cc2e35c40"]
}, Open  ]],
Cell[CellGroupData[{
Cell[118419, 3249, 241, 5, 67, "Subsection",ExpressionUUID->"101b3432-38c6-4cf5-81ab-5fc6ddb28077"],
Cell[118663, 3256, 222, 5, 44, "Text",ExpressionUUID->"b583c3fd-698c-42ac-996a-6190aae6004f"],
Cell[118888, 3263, 2063, 54, 90, "Input",ExpressionUUID->"3018019f-471c-432b-b260-97364df61dbb"],
Cell[120954, 3319, 1757, 51, 90, "Input",ExpressionUUID->"23e1b422-6204-452e-bf35-5e0cbc225054"],
Cell[122714, 3372, 1872, 42, 116, "Input",ExpressionUUID->"0d576976-de2e-4fe5-8326-551add2d64b0"],
Cell[124589, 3416, 655, 14, 64, "Input",ExpressionUUID->"d1d6f116-d5ab-4ed6-80d9-585ba0d14d48"]
}, Open  ]],
Cell[CellGroupData[{
Cell[125281, 3435, 270, 6, 67, "Subsection",ExpressionUUID->"bde64d0f-869b-4c7c-b40d-eb16a1d992b7"],
Cell[125554, 3443, 772, 17, 90, "Input",ExpressionUUID->"e1f86394-44e1-492d-bc06-8f88ba4eaef8"],
Cell[126329, 3462, 269, 6, 64, "Input",ExpressionUUID->"9276c180-8308-48c9-8330-ac940e6aa914"],
Cell[126601, 3470, 550, 14, 139, "Input",ExpressionUUID->"4368b146-7dd0-411d-a617-49f229e812b7"],
Cell[CellGroupData[{
Cell[127176, 3488, 173, 3, 56, "Subsubsection",ExpressionUUID->"314ab424-b2f6-4ffe-80c1-cd11939d9bbe"],
Cell[127352, 3493, 959, 22, 64, "Input",ExpressionUUID->"0b23a4e9-30c1-42a1-9dbf-65f1a8472b9e"],
Cell[128314, 3517, 1546, 42, 116, "Input",ExpressionUUID->"f940bede-a450-47ad-9493-fe20a168ea1b"],
Cell[129863, 3561, 418, 11, 37, "Input",ExpressionUUID->"49ef8df6-970a-4d8e-aa55-9452873cfc71"],
Cell[130284, 3574, 480, 12, 64, "Input",ExpressionUUID->"ee85ae95-a2c5-43c9-9d3c-7631c756c257"],
Cell[130767, 3588, 3165, 78, 168, "Input",ExpressionUUID->"cdb329fe-cc1d-4977-82e8-3ae58d7a12ad"],
Cell[133935, 3668, 638, 14, 64, "Input",ExpressionUUID->"6bddb1e8-fccc-4cba-b47a-d22d28446824"],
Cell[134576, 3684, 951, 26, 64, "Input",ExpressionUUID->"d2c83489-d14f-4d11-932d-9464d3b5c8dc"],
Cell[135530, 3712, 1087, 30, 142, "Input",ExpressionUUID->"5aed7b5f-4619-48fe-9280-c02971ef71fe"],
Cell[136620, 3744, 297, 5, 64, "Text",ExpressionUUID->"5a6c9c81-7b43-41cc-a21c-36023417a57d"],
Cell[136920, 3751, 1864, 50, 116, "Input",ExpressionUUID->"337c198a-6e33-4377-907f-f5d72d5413ee"],
Cell[138787, 3803, 1502, 42, 64, "Input",ExpressionUUID->"723bab12-a5c3-4bdb-a3a2-7d01ed45ac35"],
Cell[140292, 3847, 1849, 44, 90, "Input",ExpressionUUID->"8051bd3d-bdd4-4a96-bbdf-b1938f000fd9"],
Cell[142144, 3893, 712, 15, 116, "Input",ExpressionUUID->"0a19fa64-25b0-4252-9eb1-2bacd63fdbfe"],
Cell[142859, 3910, 1048, 26, 64, "Input",ExpressionUUID->"17025b33-13d6-470e-952b-6ae0f1dfbfd0"],
Cell[143910, 3938, 580, 12, 90, "Input",ExpressionUUID->"2de6bd23-8707-400d-81ad-3e9257ec89d5"],
Cell[144493, 3952, 186, 3, 64, "Text",ExpressionUUID->"a8f800f6-75a4-40f9-adae-92994f5f0da2"],
Cell[144682, 3957, 615, 15, 64, "Input",ExpressionUUID->"2fab7b7d-d09f-4bfc-b151-ba29ecdbab06"],
Cell[145300, 3974, 982, 23, 64, "Input",ExpressionUUID->"edc405fa-1d89-4769-863e-2187c8f2b13a"],
Cell[146285, 3999, 934, 24, 64, "Input",ExpressionUUID->"a07c0519-6b82-424a-b5fd-f35f62a1a079"],
Cell[147222, 4025, 342, 8, 37, "Input",ExpressionUUID->"531d8889-781f-489e-9837-5833951a31e3"],
Cell[147567, 4035, 746, 15, 90, "Input",ExpressionUUID->"4e6b3ca3-7307-4d3c-8bf9-373db779e589"],
Cell[148316, 4052, 356, 9, 37, "Input",ExpressionUUID->"92c99646-2fc7-41be-a66d-ac56a83fdb34"],
Cell[148675, 4063, 325, 8, 37, "Input",ExpressionUUID->"95569e5b-4ab1-4bcc-ba84-13b25922780f"],
Cell[149003, 4073, 641, 11, 131, "Text",ExpressionUUID->"9014e7ef-24c2-4a7c-9156-b797b7b5ef0d"],
Cell[149647, 4086, 155, 3, 37, "Input",ExpressionUUID->"88d63097-8e84-41c6-82ed-98b78e630779"],
Cell[149805, 4091, 825, 18, 37, "Input",ExpressionUUID->"f223bc5a-653c-4ec4-858d-3745fbfd248f"],
Cell[150633, 4111, 841, 21, 37, "Input",ExpressionUUID->"5c960c4d-edd7-447b-b3ea-a1e3a445cd47"],
Cell[151477, 4134, 478, 13, 64, "Input",ExpressionUUID->"e03ac346-7c29-4410-b608-a3ddc7099ada"]
}, Open  ]],
Cell[CellGroupData[{
Cell[151992, 4152, 222, 4, 56, "Subsubsection",ExpressionUUID->"4e39fea5-6c85-44dc-abdb-0e3ba1fa5598"],
Cell[152217, 4158, 216, 3, 64, "Input",ExpressionUUID->"4fef8d79-6593-47bf-9413-c2cdcd9ef909"],
Cell[152436, 4163, 1104, 24, 64, "Input",ExpressionUUID->"3a502131-a3e5-4106-8e85-82eb8507ce48"],
Cell[153543, 4189, 1572, 43, 116, "Input",ExpressionUUID->"1b82662d-05b5-47bb-96b6-d2dafd279e40"],
Cell[155118, 4234, 418, 11, 37, "Input",ExpressionUUID->"c2fb3aec-e425-4441-8d42-287f683c43ac"],
Cell[155539, 4247, 3213, 78, 168, "Input",ExpressionUUID->"6d1fba2a-136b-4968-a034-10e0ab57621a"],
Cell[158755, 4327, 588, 12, 90, "Input",ExpressionUUID->"b980efd1-41ca-4fa9-871b-908de7981c76"],
Cell[159346, 4341, 951, 26, 64, "Input",ExpressionUUID->"7a9168cb-5f66-4936-b7d2-4e01a3ddfe98"],
Cell[160300, 4369, 1087, 30, 142, "Input",ExpressionUUID->"4f89cfce-3337-46a5-b4e5-ec537ae6f9ca"],
Cell[161390, 4401, 297, 5, 64, "Text",ExpressionUUID->"74aba51d-9146-4fdd-9baf-cdd5161044f5"],
Cell[161690, 4408, 1961, 51, 116, "Input",ExpressionUUID->"1e105a6a-f581-4f70-bdd7-0064e6ed05ff"],
Cell[163654, 4461, 1898, 45, 90, "Input",ExpressionUUID->"07874b93-2c9b-4f12-8e2b-ef4209e5e507"],
Cell[165555, 4508, 643, 12, 116, "Input",ExpressionUUID->"3ad3e312-dd34-4654-ba20-6f378b9c7aec"],
Cell[166201, 4522, 1076, 27, 64, "Input",ExpressionUUID->"d959e63f-2707-4004-baf0-b249bc1d6e2a"],
Cell[167280, 4551, 580, 12, 90, "Input",ExpressionUUID->"f0257d01-0fb2-4288-96dd-a1cfb0b76d19"],
Cell[167863, 4565, 186, 3, 64, "Text",ExpressionUUID->"3ae9dfda-8b74-4de3-8829-7c484b1458b1"],
Cell[168052, 4570, 639, 15, 64, "Input",ExpressionUUID->"9a8a9628-9b30-4676-8f6f-afd5c5e72d49"],
Cell[168694, 4587, 1005, 23, 64, "Input",ExpressionUUID->"a9b4b730-436a-413a-91cd-abc3fa0ecf62"],
Cell[169702, 4612, 690, 13, 90, "Input",ExpressionUUID->"b5081da6-f3b6-4414-9e47-88a94173a17f"],
Cell[170395, 4627, 356, 9, 37, "Input",ExpressionUUID->"77083307-a522-45cf-b6f1-99b3cb243294"],
Cell[170754, 4638, 325, 8, 37, "Input",ExpressionUUID->"4f41b6f3-2649-4c28-baf0-13b376647f93"],
Cell[171082, 4648, 641, 11, 131, "Text",ExpressionUUID->"fc3dc837-9c39-4a67-985d-92e6b9b0a764"],
Cell[171726, 4661, 155, 3, 37, "Input",ExpressionUUID->"8846210a-18d7-4b7e-92ab-40e259e68319"],
Cell[171884, 4666, 825, 18, 37, "Input",ExpressionUUID->"428e06d1-7b52-4928-ace8-8e7de2c7545f"],
Cell[172712, 4686, 841, 21, 37, "Input",ExpressionUUID->"c8ed82f0-f205-485c-b869-3795a5f80565"],
Cell[173556, 4709, 478, 13, 64, "Input",ExpressionUUID->"2c4a00c3-ad3c-4501-b962-b8c5a6dde77b"]
}, Closed]]
}, Open  ]]
}, Open  ]]
}
]
*)

